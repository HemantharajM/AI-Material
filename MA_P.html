<!DOCTYPE html>
<html>
<head><meta charset="utf-8" />
<title>MA_P</title><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.1.10/require.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>

<style type="text/css">
    /*!
*
* Twitter Bootstrap
*
*/
/*!
 * Bootstrap v3.3.7 (http://getbootstrap.com)
 * Copyright 2011-2016 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 */
/*! normalize.css v3.0.3 | MIT License | github.com/necolas/normalize.css */
html {
  font-family: sans-serif;
  -ms-text-size-adjust: 100%;
  -webkit-text-size-adjust: 100%;
}
body {
  margin: 0;
}
article,
aside,
details,
figcaption,
figure,
footer,
header,
hgroup,
main,
menu,
nav,
section,
summary {
  display: block;
}
audio,
canvas,
progress,
video {
  display: inline-block;
  vertical-align: baseline;
}
audio:not([controls]) {
  display: none;
  height: 0;
}
[hidden],
template {
  display: none;
}
a {
  background-color: transparent;
}
a:active,
a:hover {
  outline: 0;
}
abbr[title] {
  border-bottom: 1px dotted;
}
b,
strong {
  font-weight: bold;
}
dfn {
  font-style: italic;
}
h1 {
  font-size: 2em;
  margin: 0.67em 0;
}
mark {
  background: #ff0;
  color: #000;
}
small {
  font-size: 80%;
}
sub,
sup {
  font-size: 75%;
  line-height: 0;
  position: relative;
  vertical-align: baseline;
}
sup {
  top: -0.5em;
}
sub {
  bottom: -0.25em;
}
img {
  border: 0;
}
svg:not(:root) {
  overflow: hidden;
}
figure {
  margin: 1em 40px;
}
hr {
  box-sizing: content-box;
  height: 0;
}
pre {
  overflow: auto;
}
code,
kbd,
pre,
samp {
  font-family: monospace, monospace;
  font-size: 1em;
}
button,
input,
optgroup,
select,
textarea {
  color: inherit;
  font: inherit;
  margin: 0;
}
button {
  overflow: visible;
}
button,
select {
  text-transform: none;
}
button,
html input[type="button"],
input[type="reset"],
input[type="submit"] {
  -webkit-appearance: button;
  cursor: pointer;
}
button[disabled],
html input[disabled] {
  cursor: default;
}
button::-moz-focus-inner,
input::-moz-focus-inner {
  border: 0;
  padding: 0;
}
input {
  line-height: normal;
}
input[type="checkbox"],
input[type="radio"] {
  box-sizing: border-box;
  padding: 0;
}
input[type="number"]::-webkit-inner-spin-button,
input[type="number"]::-webkit-outer-spin-button {
  height: auto;
}
input[type="search"] {
  -webkit-appearance: textfield;
  box-sizing: content-box;
}
input[type="search"]::-webkit-search-cancel-button,
input[type="search"]::-webkit-search-decoration {
  -webkit-appearance: none;
}
fieldset {
  border: 1px solid #c0c0c0;
  margin: 0 2px;
  padding: 0.35em 0.625em 0.75em;
}
legend {
  border: 0;
  padding: 0;
}
textarea {
  overflow: auto;
}
optgroup {
  font-weight: bold;
}
table {
  border-collapse: collapse;
  border-spacing: 0;
}
td,
th {
  padding: 0;
}
/*! Source: https://github.com/h5bp/html5-boilerplate/blob/master/src/css/main.css */
@media print {
  *,
  *:before,
  *:after {
    background: transparent !important;
    color: #000 !important;
    box-shadow: none !important;
    text-shadow: none !important;
  }
  a,
  a:visited {
    text-decoration: underline;
  }
  a[href]:after {
    content: " (" attr(href) ")";
  }
  abbr[title]:after {
    content: " (" attr(title) ")";
  }
  a[href^="#"]:after,
  a[href^="javascript:"]:after {
    content: "";
  }
  pre,
  blockquote {
    border: 1px solid #999;
    page-break-inside: avoid;
  }
  thead {
    display: table-header-group;
  }
  tr,
  img {
    page-break-inside: avoid;
  }
  img {
    max-width: 100% !important;
  }
  p,
  h2,
  h3 {
    orphans: 3;
    widows: 3;
  }
  h2,
  h3 {
    page-break-after: avoid;
  }
  .navbar {
    display: none;
  }
  .btn > .caret,
  .dropup > .btn > .caret {
    border-top-color: #000 !important;
  }
  .label {
    border: 1px solid #000;
  }
  .table {
    border-collapse: collapse !important;
  }
  .table td,
  .table th {
    background-color: #fff !important;
  }
  .table-bordered th,
  .table-bordered td {
    border: 1px solid #ddd !important;
  }
}
@font-face {
  font-family: 'Glyphicons Halflings';
  src: url('../components/bootstrap/fonts/glyphicons-halflings-regular.eot');
  src: url('../components/bootstrap/fonts/glyphicons-halflings-regular.eot?#iefix') format('embedded-opentype'), url('../components/bootstrap/fonts/glyphicons-halflings-regular.woff2') format('woff2'), url('../components/bootstrap/fonts/glyphicons-halflings-regular.woff') format('woff'), url('../components/bootstrap/fonts/glyphicons-halflings-regular.ttf') format('truetype'), url('../components/bootstrap/fonts/glyphicons-halflings-regular.svg#glyphicons_halflingsregular') format('svg');
}
.glyphicon {
  position: relative;
  top: 1px;
  display: inline-block;
  font-family: 'Glyphicons Halflings';
  font-style: normal;
  font-weight: normal;
  line-height: 1;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}
.glyphicon-asterisk:before {
  content: "\002a";
}
.glyphicon-plus:before {
  content: "\002b";
}
.glyphicon-euro:before,
.glyphicon-eur:before {
  content: "\20ac";
}
.glyphicon-minus:before {
  content: "\2212";
}
.glyphicon-cloud:before {
  content: "\2601";
}
.glyphicon-envelope:before {
  content: "\2709";
}
.glyphicon-pencil:before {
  content: "\270f";
}
.glyphicon-glass:before {
  content: "\e001";
}
.glyphicon-music:before {
  content: "\e002";
}
.glyphicon-search:before {
  content: "\e003";
}
.glyphicon-heart:before {
  content: "\e005";
}
.glyphicon-star:before {
  content: "\e006";
}
.glyphicon-star-empty:before {
  content: "\e007";
}
.glyphicon-user:before {
  content: "\e008";
}
.glyphicon-film:before {
  content: "\e009";
}
.glyphicon-th-large:before {
  content: "\e010";
}
.glyphicon-th:before {
  content: "\e011";
}
.glyphicon-th-list:before {
  content: "\e012";
}
.glyphicon-ok:before {
  content: "\e013";
}
.glyphicon-remove:before {
  content: "\e014";
}
.glyphicon-zoom-in:before {
  content: "\e015";
}
.glyphicon-zoom-out:before {
  content: "\e016";
}
.glyphicon-off:before {
  content: "\e017";
}
.glyphicon-signal:before {
  content: "\e018";
}
.glyphicon-cog:before {
  content: "\e019";
}
.glyphicon-trash:before {
  content: "\e020";
}
.glyphicon-home:before {
  content: "\e021";
}
.glyphicon-file:before {
  content: "\e022";
}
.glyphicon-time:before {
  content: "\e023";
}
.glyphicon-road:before {
  content: "\e024";
}
.glyphicon-download-alt:before {
  content: "\e025";
}
.glyphicon-download:before {
  content: "\e026";
}
.glyphicon-upload:before {
  content: "\e027";
}
.glyphicon-inbox:before {
  content: "\e028";
}
.glyphicon-play-circle:before {
  content: "\e029";
}
.glyphicon-repeat:before {
  content: "\e030";
}
.glyphicon-refresh:before {
  content: "\e031";
}
.glyphicon-list-alt:before {
  content: "\e032";
}
.glyphicon-lock:before {
  content: "\e033";
}
.glyphicon-flag:before {
  content: "\e034";
}
.glyphicon-headphones:before {
  content: "\e035";
}
.glyphicon-volume-off:before {
  content: "\e036";
}
.glyphicon-volume-down:before {
  content: "\e037";
}
.glyphicon-volume-up:before {
  content: "\e038";
}
.glyphicon-qrcode:before {
  content: "\e039";
}
.glyphicon-barcode:before {
  content: "\e040";
}
.glyphicon-tag:before {
  content: "\e041";
}
.glyphicon-tags:before {
  content: "\e042";
}
.glyphicon-book:before {
  content: "\e043";
}
.glyphicon-bookmark:before {
  content: "\e044";
}
.glyphicon-print:before {
  content: "\e045";
}
.glyphicon-camera:before {
  content: "\e046";
}
.glyphicon-font:before {
  content: "\e047";
}
.glyphicon-bold:before {
  content: "\e048";
}
.glyphicon-italic:before {
  content: "\e049";
}
.glyphicon-text-height:before {
  content: "\e050";
}
.glyphicon-text-width:before {
  content: "\e051";
}
.glyphicon-align-left:before {
  content: "\e052";
}
.glyphicon-align-center:before {
  content: "\e053";
}
.glyphicon-align-right:before {
  content: "\e054";
}
.glyphicon-align-justify:before {
  content: "\e055";
}
.glyphicon-list:before {
  content: "\e056";
}
.glyphicon-indent-left:before {
  content: "\e057";
}
.glyphicon-indent-right:before {
  content: "\e058";
}
.glyphicon-facetime-video:before {
  content: "\e059";
}
.glyphicon-picture:before {
  content: "\e060";
}
.glyphicon-map-marker:before {
  content: "\e062";
}
.glyphicon-adjust:before {
  content: "\e063";
}
.glyphicon-tint:before {
  content: "\e064";
}
.glyphicon-edit:before {
  content: "\e065";
}
.glyphicon-share:before {
  content: "\e066";
}
.glyphicon-check:before {
  content: "\e067";
}
.glyphicon-move:before {
  content: "\e068";
}
.glyphicon-step-backward:before {
  content: "\e069";
}
.glyphicon-fast-backward:before {
  content: "\e070";
}
.glyphicon-backward:before {
  content: "\e071";
}
.glyphicon-play:before {
  content: "\e072";
}
.glyphicon-pause:before {
  content: "\e073";
}
.glyphicon-stop:before {
  content: "\e074";
}
.glyphicon-forward:before {
  content: "\e075";
}
.glyphicon-fast-forward:before {
  content: "\e076";
}
.glyphicon-step-forward:before {
  content: "\e077";
}
.glyphicon-eject:before {
  content: "\e078";
}
.glyphicon-chevron-left:before {
  content: "\e079";
}
.glyphicon-chevron-right:before {
  content: "\e080";
}
.glyphicon-plus-sign:before {
  content: "\e081";
}
.glyphicon-minus-sign:before {
  content: "\e082";
}
.glyphicon-remove-sign:before {
  content: "\e083";
}
.glyphicon-ok-sign:before {
  content: "\e084";
}
.glyphicon-question-sign:before {
  content: "\e085";
}
.glyphicon-info-sign:before {
  content: "\e086";
}
.glyphicon-screenshot:before {
  content: "\e087";
}
.glyphicon-remove-circle:before {
  content: "\e088";
}
.glyphicon-ok-circle:before {
  content: "\e089";
}
.glyphicon-ban-circle:before {
  content: "\e090";
}
.glyphicon-arrow-left:before {
  content: "\e091";
}
.glyphicon-arrow-right:before {
  content: "\e092";
}
.glyphicon-arrow-up:before {
  content: "\e093";
}
.glyphicon-arrow-down:before {
  content: "\e094";
}
.glyphicon-share-alt:before {
  content: "\e095";
}
.glyphicon-resize-full:before {
  content: "\e096";
}
.glyphicon-resize-small:before {
  content: "\e097";
}
.glyphicon-exclamation-sign:before {
  content: "\e101";
}
.glyphicon-gift:before {
  content: "\e102";
}
.glyphicon-leaf:before {
  content: "\e103";
}
.glyphicon-fire:before {
  content: "\e104";
}
.glyphicon-eye-open:before {
  content: "\e105";
}
.glyphicon-eye-close:before {
  content: "\e106";
}
.glyphicon-warning-sign:before {
  content: "\e107";
}
.glyphicon-plane:before {
  content: "\e108";
}
.glyphicon-calendar:before {
  content: "\e109";
}
.glyphicon-random:before {
  content: "\e110";
}
.glyphicon-comment:before {
  content: "\e111";
}
.glyphicon-magnet:before {
  content: "\e112";
}
.glyphicon-chevron-up:before {
  content: "\e113";
}
.glyphicon-chevron-down:before {
  content: "\e114";
}
.glyphicon-retweet:before {
  content: "\e115";
}
.glyphicon-shopping-cart:before {
  content: "\e116";
}
.glyphicon-folder-close:before {
  content: "\e117";
}
.glyphicon-folder-open:before {
  content: "\e118";
}
.glyphicon-resize-vertical:before {
  content: "\e119";
}
.glyphicon-resize-horizontal:before {
  content: "\e120";
}
.glyphicon-hdd:before {
  content: "\e121";
}
.glyphicon-bullhorn:before {
  content: "\e122";
}
.glyphicon-bell:before {
  content: "\e123";
}
.glyphicon-certificate:before {
  content: "\e124";
}
.glyphicon-thumbs-up:before {
  content: "\e125";
}
.glyphicon-thumbs-down:before {
  content: "\e126";
}
.glyphicon-hand-right:before {
  content: "\e127";
}
.glyphicon-hand-left:before {
  content: "\e128";
}
.glyphicon-hand-up:before {
  content: "\e129";
}
.glyphicon-hand-down:before {
  content: "\e130";
}
.glyphicon-circle-arrow-right:before {
  content: "\e131";
}
.glyphicon-circle-arrow-left:before {
  content: "\e132";
}
.glyphicon-circle-arrow-up:before {
  content: "\e133";
}
.glyphicon-circle-arrow-down:before {
  content: "\e134";
}
.glyphicon-globe:before {
  content: "\e135";
}
.glyphicon-wrench:before {
  content: "\e136";
}
.glyphicon-tasks:before {
  content: "\e137";
}
.glyphicon-filter:before {
  content: "\e138";
}
.glyphicon-briefcase:before {
  content: "\e139";
}
.glyphicon-fullscreen:before {
  content: "\e140";
}
.glyphicon-dashboard:before {
  content: "\e141";
}
.glyphicon-paperclip:before {
  content: "\e142";
}
.glyphicon-heart-empty:before {
  content: "\e143";
}
.glyphicon-link:before {
  content: "\e144";
}
.glyphicon-phone:before {
  content: "\e145";
}
.glyphicon-pushpin:before {
  content: "\e146";
}
.glyphicon-usd:before {
  content: "\e148";
}
.glyphicon-gbp:before {
  content: "\e149";
}
.glyphicon-sort:before {
  content: "\e150";
}
.glyphicon-sort-by-alphabet:before {
  content: "\e151";
}
.glyphicon-sort-by-alphabet-alt:before {
  content: "\e152";
}
.glyphicon-sort-by-order:before {
  content: "\e153";
}
.glyphicon-sort-by-order-alt:before {
  content: "\e154";
}
.glyphicon-sort-by-attributes:before {
  content: "\e155";
}
.glyphicon-sort-by-attributes-alt:before {
  content: "\e156";
}
.glyphicon-unchecked:before {
  content: "\e157";
}
.glyphicon-expand:before {
  content: "\e158";
}
.glyphicon-collapse-down:before {
  content: "\e159";
}
.glyphicon-collapse-up:before {
  content: "\e160";
}
.glyphicon-log-in:before {
  content: "\e161";
}
.glyphicon-flash:before {
  content: "\e162";
}
.glyphicon-log-out:before {
  content: "\e163";
}
.glyphicon-new-window:before {
  content: "\e164";
}
.glyphicon-record:before {
  content: "\e165";
}
.glyphicon-save:before {
  content: "\e166";
}
.glyphicon-open:before {
  content: "\e167";
}
.glyphicon-saved:before {
  content: "\e168";
}
.glyphicon-import:before {
  content: "\e169";
}
.glyphicon-export:before {
  content: "\e170";
}
.glyphicon-send:before {
  content: "\e171";
}
.glyphicon-floppy-disk:before {
  content: "\e172";
}
.glyphicon-floppy-saved:before {
  content: "\e173";
}
.glyphicon-floppy-remove:before {
  content: "\e174";
}
.glyphicon-floppy-save:before {
  content: "\e175";
}
.glyphicon-floppy-open:before {
  content: "\e176";
}
.glyphicon-credit-card:before {
  content: "\e177";
}
.glyphicon-transfer:before {
  content: "\e178";
}
.glyphicon-cutlery:before {
  content: "\e179";
}
.glyphicon-header:before {
  content: "\e180";
}
.glyphicon-compressed:before {
  content: "\e181";
}
.glyphicon-earphone:before {
  content: "\e182";
}
.glyphicon-phone-alt:before {
  content: "\e183";
}
.glyphicon-tower:before {
  content: "\e184";
}
.glyphicon-stats:before {
  content: "\e185";
}
.glyphicon-sd-video:before {
  content: "\e186";
}
.glyphicon-hd-video:before {
  content: "\e187";
}
.glyphicon-subtitles:before {
  content: "\e188";
}
.glyphicon-sound-stereo:before {
  content: "\e189";
}
.glyphicon-sound-dolby:before {
  content: "\e190";
}
.glyphicon-sound-5-1:before {
  content: "\e191";
}
.glyphicon-sound-6-1:before {
  content: "\e192";
}
.glyphicon-sound-7-1:before {
  content: "\e193";
}
.glyphicon-copyright-mark:before {
  content: "\e194";
}
.glyphicon-registration-mark:before {
  content: "\e195";
}
.glyphicon-cloud-download:before {
  content: "\e197";
}
.glyphicon-cloud-upload:before {
  content: "\e198";
}
.glyphicon-tree-conifer:before {
  content: "\e199";
}
.glyphicon-tree-deciduous:before {
  content: "\e200";
}
.glyphicon-cd:before {
  content: "\e201";
}
.glyphicon-save-file:before {
  content: "\e202";
}
.glyphicon-open-file:before {
  content: "\e203";
}
.glyphicon-level-up:before {
  content: "\e204";
}
.glyphicon-copy:before {
  content: "\e205";
}
.glyphicon-paste:before {
  content: "\e206";
}
.glyphicon-alert:before {
  content: "\e209";
}
.glyphicon-equalizer:before {
  content: "\e210";
}
.glyphicon-king:before {
  content: "\e211";
}
.glyphicon-queen:before {
  content: "\e212";
}
.glyphicon-pawn:before {
  content: "\e213";
}
.glyphicon-bishop:before {
  content: "\e214";
}
.glyphicon-knight:before {
  content: "\e215";
}
.glyphicon-baby-formula:before {
  content: "\e216";
}
.glyphicon-tent:before {
  content: "\26fa";
}
.glyphicon-blackboard:before {
  content: "\e218";
}
.glyphicon-bed:before {
  content: "\e219";
}
.glyphicon-apple:before {
  content: "\f8ff";
}
.glyphicon-erase:before {
  content: "\e221";
}
.glyphicon-hourglass:before {
  content: "\231b";
}
.glyphicon-lamp:before {
  content: "\e223";
}
.glyphicon-duplicate:before {
  content: "\e224";
}
.glyphicon-piggy-bank:before {
  content: "\e225";
}
.glyphicon-scissors:before {
  content: "\e226";
}
.glyphicon-bitcoin:before {
  content: "\e227";
}
.glyphicon-btc:before {
  content: "\e227";
}
.glyphicon-xbt:before {
  content: "\e227";
}
.glyphicon-yen:before {
  content: "\00a5";
}
.glyphicon-jpy:before {
  content: "\00a5";
}
.glyphicon-ruble:before {
  content: "\20bd";
}
.glyphicon-rub:before {
  content: "\20bd";
}
.glyphicon-scale:before {
  content: "\e230";
}
.glyphicon-ice-lolly:before {
  content: "\e231";
}
.glyphicon-ice-lolly-tasted:before {
  content: "\e232";
}
.glyphicon-education:before {
  content: "\e233";
}
.glyphicon-option-horizontal:before {
  content: "\e234";
}
.glyphicon-option-vertical:before {
  content: "\e235";
}
.glyphicon-menu-hamburger:before {
  content: "\e236";
}
.glyphicon-modal-window:before {
  content: "\e237";
}
.glyphicon-oil:before {
  content: "\e238";
}
.glyphicon-grain:before {
  content: "\e239";
}
.glyphicon-sunglasses:before {
  content: "\e240";
}
.glyphicon-text-size:before {
  content: "\e241";
}
.glyphicon-text-color:before {
  content: "\e242";
}
.glyphicon-text-background:before {
  content: "\e243";
}
.glyphicon-object-align-top:before {
  content: "\e244";
}
.glyphicon-object-align-bottom:before {
  content: "\e245";
}
.glyphicon-object-align-horizontal:before {
  content: "\e246";
}
.glyphicon-object-align-left:before {
  content: "\e247";
}
.glyphicon-object-align-vertical:before {
  content: "\e248";
}
.glyphicon-object-align-right:before {
  content: "\e249";
}
.glyphicon-triangle-right:before {
  content: "\e250";
}
.glyphicon-triangle-left:before {
  content: "\e251";
}
.glyphicon-triangle-bottom:before {
  content: "\e252";
}
.glyphicon-triangle-top:before {
  content: "\e253";
}
.glyphicon-console:before {
  content: "\e254";
}
.glyphicon-superscript:before {
  content: "\e255";
}
.glyphicon-subscript:before {
  content: "\e256";
}
.glyphicon-menu-left:before {
  content: "\e257";
}
.glyphicon-menu-right:before {
  content: "\e258";
}
.glyphicon-menu-down:before {
  content: "\e259";
}
.glyphicon-menu-up:before {
  content: "\e260";
}
* {
  -webkit-box-sizing: border-box;
  -moz-box-sizing: border-box;
  box-sizing: border-box;
}
*:before,
*:after {
  -webkit-box-sizing: border-box;
  -moz-box-sizing: border-box;
  box-sizing: border-box;
}
html {
  font-size: 10px;
  -webkit-tap-highlight-color: rgba(0, 0, 0, 0);
}
body {
  font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
  font-size: 13px;
  line-height: 1.42857143;
  color: #000;
  background-color: #fff;
}
input,
button,
select,
textarea {
  font-family: inherit;
  font-size: inherit;
  line-height: inherit;
}
a {
  color: #337ab7;
  text-decoration: none;
}
a:hover,
a:focus {
  color: #23527c;
  text-decoration: underline;
}
a:focus {
  outline: 5px auto -webkit-focus-ring-color;
  outline-offset: -2px;
}
figure {
  margin: 0;
}
img {
  vertical-align: middle;
}
.img-responsive,
.thumbnail > img,
.thumbnail a > img,
.carousel-inner > .item > img,
.carousel-inner > .item > a > img {
  display: block;
  max-width: 100%;
  height: auto;
}
.img-rounded {
  border-radius: 3px;
}
.img-thumbnail {
  padding: 4px;
  line-height: 1.42857143;
  background-color: #fff;
  border: 1px solid #ddd;
  border-radius: 2px;
  -webkit-transition: all 0.2s ease-in-out;
  -o-transition: all 0.2s ease-in-out;
  transition: all 0.2s ease-in-out;
  display: inline-block;
  max-width: 100%;
  height: auto;
}
.img-circle {
  border-radius: 50%;
}
hr {
  margin-top: 18px;
  margin-bottom: 18px;
  border: 0;
  border-top: 1px solid #eeeeee;
}
.sr-only {
  position: absolute;
  width: 1px;
  height: 1px;
  margin: -1px;
  padding: 0;
  overflow: hidden;
  clip: rect(0, 0, 0, 0);
  border: 0;
}
.sr-only-focusable:active,
.sr-only-focusable:focus {
  position: static;
  width: auto;
  height: auto;
  margin: 0;
  overflow: visible;
  clip: auto;
}
[role="button"] {
  cursor: pointer;
}
h1,
h2,
h3,
h4,
h5,
h6,
.h1,
.h2,
.h3,
.h4,
.h5,
.h6 {
  font-family: inherit;
  font-weight: 500;
  line-height: 1.1;
  color: inherit;
}
h1 small,
h2 small,
h3 small,
h4 small,
h5 small,
h6 small,
.h1 small,
.h2 small,
.h3 small,
.h4 small,
.h5 small,
.h6 small,
h1 .small,
h2 .small,
h3 .small,
h4 .small,
h5 .small,
h6 .small,
.h1 .small,
.h2 .small,
.h3 .small,
.h4 .small,
.h5 .small,
.h6 .small {
  font-weight: normal;
  line-height: 1;
  color: #777777;
}
h1,
.h1,
h2,
.h2,
h3,
.h3 {
  margin-top: 18px;
  margin-bottom: 9px;
}
h1 small,
.h1 small,
h2 small,
.h2 small,
h3 small,
.h3 small,
h1 .small,
.h1 .small,
h2 .small,
.h2 .small,
h3 .small,
.h3 .small {
  font-size: 65%;
}
h4,
.h4,
h5,
.h5,
h6,
.h6 {
  margin-top: 9px;
  margin-bottom: 9px;
}
h4 small,
.h4 small,
h5 small,
.h5 small,
h6 small,
.h6 small,
h4 .small,
.h4 .small,
h5 .small,
.h5 .small,
h6 .small,
.h6 .small {
  font-size: 75%;
}
h1,
.h1 {
  font-size: 33px;
}
h2,
.h2 {
  font-size: 27px;
}
h3,
.h3 {
  font-size: 23px;
}
h4,
.h4 {
  font-size: 17px;
}
h5,
.h5 {
  font-size: 13px;
}
h6,
.h6 {
  font-size: 12px;
}
p {
  margin: 0 0 9px;
}
.lead {
  margin-bottom: 18px;
  font-size: 14px;
  font-weight: 300;
  line-height: 1.4;
}
@media (min-width: 768px) {
  .lead {
    font-size: 19.5px;
  }
}
small,
.small {
  font-size: 92%;
}
mark,
.mark {
  background-color: #fcf8e3;
  padding: .2em;
}
.text-left {
  text-align: left;
}
.text-right {
  text-align: right;
}
.text-center {
  text-align: center;
}
.text-justify {
  text-align: justify;
}
.text-nowrap {
  white-space: nowrap;
}
.text-lowercase {
  text-transform: lowercase;
}
.text-uppercase {
  text-transform: uppercase;
}
.text-capitalize {
  text-transform: capitalize;
}
.text-muted {
  color: #777777;
}
.text-primary {
  color: #337ab7;
}
a.text-primary:hover,
a.text-primary:focus {
  color: #286090;
}
.text-success {
  color: #3c763d;
}
a.text-success:hover,
a.text-success:focus {
  color: #2b542c;
}
.text-info {
  color: #31708f;
}
a.text-info:hover,
a.text-info:focus {
  color: #245269;
}
.text-warning {
  color: #8a6d3b;
}
a.text-warning:hover,
a.text-warning:focus {
  color: #66512c;
}
.text-danger {
  color: #a94442;
}
a.text-danger:hover,
a.text-danger:focus {
  color: #843534;
}
.bg-primary {
  color: #fff;
  background-color: #337ab7;
}
a.bg-primary:hover,
a.bg-primary:focus {
  background-color: #286090;
}
.bg-success {
  background-color: #dff0d8;
}
a.bg-success:hover,
a.bg-success:focus {
  background-color: #c1e2b3;
}
.bg-info {
  background-color: #d9edf7;
}
a.bg-info:hover,
a.bg-info:focus {
  background-color: #afd9ee;
}
.bg-warning {
  background-color: #fcf8e3;
}
a.bg-warning:hover,
a.bg-warning:focus {
  background-color: #f7ecb5;
}
.bg-danger {
  background-color: #f2dede;
}
a.bg-danger:hover,
a.bg-danger:focus {
  background-color: #e4b9b9;
}
.page-header {
  padding-bottom: 8px;
  margin: 36px 0 18px;
  border-bottom: 1px solid #eeeeee;
}
ul,
ol {
  margin-top: 0;
  margin-bottom: 9px;
}
ul ul,
ol ul,
ul ol,
ol ol {
  margin-bottom: 0;
}
.list-unstyled {
  padding-left: 0;
  list-style: none;
}
.list-inline {
  padding-left: 0;
  list-style: none;
  margin-left: -5px;
}
.list-inline > li {
  display: inline-block;
  padding-left: 5px;
  padding-right: 5px;
}
dl {
  margin-top: 0;
  margin-bottom: 18px;
}
dt,
dd {
  line-height: 1.42857143;
}
dt {
  font-weight: bold;
}
dd {
  margin-left: 0;
}
@media (min-width: 541px) {
  .dl-horizontal dt {
    float: left;
    width: 160px;
    clear: left;
    text-align: right;
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
  }
  .dl-horizontal dd {
    margin-left: 180px;
  }
}
abbr[title],
abbr[data-original-title] {
  cursor: help;
  border-bottom: 1px dotted #777777;
}
.initialism {
  font-size: 90%;
  text-transform: uppercase;
}
blockquote {
  padding: 9px 18px;
  margin: 0 0 18px;
  font-size: inherit;
  border-left: 5px solid #eeeeee;
}
blockquote p:last-child,
blockquote ul:last-child,
blockquote ol:last-child {
  margin-bottom: 0;
}
blockquote footer,
blockquote small,
blockquote .small {
  display: block;
  font-size: 80%;
  line-height: 1.42857143;
  color: #777777;
}
blockquote footer:before,
blockquote small:before,
blockquote .small:before {
  content: '\2014 \00A0';
}
.blockquote-reverse,
blockquote.pull-right {
  padding-right: 15px;
  padding-left: 0;
  border-right: 5px solid #eeeeee;
  border-left: 0;
  text-align: right;
}
.blockquote-reverse footer:before,
blockquote.pull-right footer:before,
.blockquote-reverse small:before,
blockquote.pull-right small:before,
.blockquote-reverse .small:before,
blockquote.pull-right .small:before {
  content: '';
}
.blockquote-reverse footer:after,
blockquote.pull-right footer:after,
.blockquote-reverse small:after,
blockquote.pull-right small:after,
.blockquote-reverse .small:after,
blockquote.pull-right .small:after {
  content: '\00A0 \2014';
}
address {
  margin-bottom: 18px;
  font-style: normal;
  line-height: 1.42857143;
}
code,
kbd,
pre,
samp {
  font-family: monospace;
}
code {
  padding: 2px 4px;
  font-size: 90%;
  color: #c7254e;
  background-color: #f9f2f4;
  border-radius: 2px;
}
kbd {
  padding: 2px 4px;
  font-size: 90%;
  color: #888;
  background-color: transparent;
  border-radius: 1px;
  box-shadow: inset 0 -1px 0 rgba(0, 0, 0, 0.25);
}
kbd kbd {
  padding: 0;
  font-size: 100%;
  font-weight: bold;
  box-shadow: none;
}
pre {
  display: block;
  padding: 8.5px;
  margin: 0 0 9px;
  font-size: 12px;
  line-height: 1.42857143;
  word-break: break-all;
  word-wrap: break-word;
  color: #333333;
  background-color: #f5f5f5;
  border: 1px solid #ccc;
  border-radius: 2px;
}
pre code {
  padding: 0;
  font-size: inherit;
  color: inherit;
  white-space: pre-wrap;
  background-color: transparent;
  border-radius: 0;
}
.pre-scrollable {
  max-height: 340px;
  overflow-y: scroll;
}
.container {
  margin-right: auto;
  margin-left: auto;
  padding-left: 0px;
  padding-right: 0px;
}
@media (min-width: 768px) {
  .container {
    width: 768px;
  }
}
@media (min-width: 992px) {
  .container {
    width: 940px;
  }
}
@media (min-width: 1200px) {
  .container {
    width: 1140px;
  }
}
.container-fluid {
  margin-right: auto;
  margin-left: auto;
  padding-left: 0px;
  padding-right: 0px;
}
.row {
  margin-left: 0px;
  margin-right: 0px;
}
.col-xs-1, .col-sm-1, .col-md-1, .col-lg-1, .col-xs-2, .col-sm-2, .col-md-2, .col-lg-2, .col-xs-3, .col-sm-3, .col-md-3, .col-lg-3, .col-xs-4, .col-sm-4, .col-md-4, .col-lg-4, .col-xs-5, .col-sm-5, .col-md-5, .col-lg-5, .col-xs-6, .col-sm-6, .col-md-6, .col-lg-6, .col-xs-7, .col-sm-7, .col-md-7, .col-lg-7, .col-xs-8, .col-sm-8, .col-md-8, .col-lg-8, .col-xs-9, .col-sm-9, .col-md-9, .col-lg-9, .col-xs-10, .col-sm-10, .col-md-10, .col-lg-10, .col-xs-11, .col-sm-11, .col-md-11, .col-lg-11, .col-xs-12, .col-sm-12, .col-md-12, .col-lg-12 {
  position: relative;
  min-height: 1px;
  padding-left: 0px;
  padding-right: 0px;
}
.col-xs-1, .col-xs-2, .col-xs-3, .col-xs-4, .col-xs-5, .col-xs-6, .col-xs-7, .col-xs-8, .col-xs-9, .col-xs-10, .col-xs-11, .col-xs-12 {
  float: left;
}
.col-xs-12 {
  width: 100%;
}
.col-xs-11 {
  width: 91.66666667%;
}
.col-xs-10 {
  width: 83.33333333%;
}
.col-xs-9 {
  width: 75%;
}
.col-xs-8 {
  width: 66.66666667%;
}
.col-xs-7 {
  width: 58.33333333%;
}
.col-xs-6 {
  width: 50%;
}
.col-xs-5 {
  width: 41.66666667%;
}
.col-xs-4 {
  width: 33.33333333%;
}
.col-xs-3 {
  width: 25%;
}
.col-xs-2 {
  width: 16.66666667%;
}
.col-xs-1 {
  width: 8.33333333%;
}
.col-xs-pull-12 {
  right: 100%;
}
.col-xs-pull-11 {
  right: 91.66666667%;
}
.col-xs-pull-10 {
  right: 83.33333333%;
}
.col-xs-pull-9 {
  right: 75%;
}
.col-xs-pull-8 {
  right: 66.66666667%;
}
.col-xs-pull-7 {
  right: 58.33333333%;
}
.col-xs-pull-6 {
  right: 50%;
}
.col-xs-pull-5 {
  right: 41.66666667%;
}
.col-xs-pull-4 {
  right: 33.33333333%;
}
.col-xs-pull-3 {
  right: 25%;
}
.col-xs-pull-2 {
  right: 16.66666667%;
}
.col-xs-pull-1 {
  right: 8.33333333%;
}
.col-xs-pull-0 {
  right: auto;
}
.col-xs-push-12 {
  left: 100%;
}
.col-xs-push-11 {
  left: 91.66666667%;
}
.col-xs-push-10 {
  left: 83.33333333%;
}
.col-xs-push-9 {
  left: 75%;
}
.col-xs-push-8 {
  left: 66.66666667%;
}
.col-xs-push-7 {
  left: 58.33333333%;
}
.col-xs-push-6 {
  left: 50%;
}
.col-xs-push-5 {
  left: 41.66666667%;
}
.col-xs-push-4 {
  left: 33.33333333%;
}
.col-xs-push-3 {
  left: 25%;
}
.col-xs-push-2 {
  left: 16.66666667%;
}
.col-xs-push-1 {
  left: 8.33333333%;
}
.col-xs-push-0 {
  left: auto;
}
.col-xs-offset-12 {
  margin-left: 100%;
}
.col-xs-offset-11 {
  margin-left: 91.66666667%;
}
.col-xs-offset-10 {
  margin-left: 83.33333333%;
}
.col-xs-offset-9 {
  margin-left: 75%;
}
.col-xs-offset-8 {
  margin-left: 66.66666667%;
}
.col-xs-offset-7 {
  margin-left: 58.33333333%;
}
.col-xs-offset-6 {
  margin-left: 50%;
}
.col-xs-offset-5 {
  margin-left: 41.66666667%;
}
.col-xs-offset-4 {
  margin-left: 33.33333333%;
}
.col-xs-offset-3 {
  margin-left: 25%;
}
.col-xs-offset-2 {
  margin-left: 16.66666667%;
}
.col-xs-offset-1 {
  margin-left: 8.33333333%;
}
.col-xs-offset-0 {
  margin-left: 0%;
}
@media (min-width: 768px) {
  .col-sm-1, .col-sm-2, .col-sm-3, .col-sm-4, .col-sm-5, .col-sm-6, .col-sm-7, .col-sm-8, .col-sm-9, .col-sm-10, .col-sm-11, .col-sm-12 {
    float: left;
  }
  .col-sm-12 {
    width: 100%;
  }
  .col-sm-11 {
    width: 91.66666667%;
  }
  .col-sm-10 {
    width: 83.33333333%;
  }
  .col-sm-9 {
    width: 75%;
  }
  .col-sm-8 {
    width: 66.66666667%;
  }
  .col-sm-7 {
    width: 58.33333333%;
  }
  .col-sm-6 {
    width: 50%;
  }
  .col-sm-5 {
    width: 41.66666667%;
  }
  .col-sm-4 {
    width: 33.33333333%;
  }
  .col-sm-3 {
    width: 25%;
  }
  .col-sm-2 {
    width: 16.66666667%;
  }
  .col-sm-1 {
    width: 8.33333333%;
  }
  .col-sm-pull-12 {
    right: 100%;
  }
  .col-sm-pull-11 {
    right: 91.66666667%;
  }
  .col-sm-pull-10 {
    right: 83.33333333%;
  }
  .col-sm-pull-9 {
    right: 75%;
  }
  .col-sm-pull-8 {
    right: 66.66666667%;
  }
  .col-sm-pull-7 {
    right: 58.33333333%;
  }
  .col-sm-pull-6 {
    right: 50%;
  }
  .col-sm-pull-5 {
    right: 41.66666667%;
  }
  .col-sm-pull-4 {
    right: 33.33333333%;
  }
  .col-sm-pull-3 {
    right: 25%;
  }
  .col-sm-pull-2 {
    right: 16.66666667%;
  }
  .col-sm-pull-1 {
    right: 8.33333333%;
  }
  .col-sm-pull-0 {
    right: auto;
  }
  .col-sm-push-12 {
    left: 100%;
  }
  .col-sm-push-11 {
    left: 91.66666667%;
  }
  .col-sm-push-10 {
    left: 83.33333333%;
  }
  .col-sm-push-9 {
    left: 75%;
  }
  .col-sm-push-8 {
    left: 66.66666667%;
  }
  .col-sm-push-7 {
    left: 58.33333333%;
  }
  .col-sm-push-6 {
    left: 50%;
  }
  .col-sm-push-5 {
    left: 41.66666667%;
  }
  .col-sm-push-4 {
    left: 33.33333333%;
  }
  .col-sm-push-3 {
    left: 25%;
  }
  .col-sm-push-2 {
    left: 16.66666667%;
  }
  .col-sm-push-1 {
    left: 8.33333333%;
  }
  .col-sm-push-0 {
    left: auto;
  }
  .col-sm-offset-12 {
    margin-left: 100%;
  }
  .col-sm-offset-11 {
    margin-left: 91.66666667%;
  }
  .col-sm-offset-10 {
    margin-left: 83.33333333%;
  }
  .col-sm-offset-9 {
    margin-left: 75%;
  }
  .col-sm-offset-8 {
    margin-left: 66.66666667%;
  }
  .col-sm-offset-7 {
    margin-left: 58.33333333%;
  }
  .col-sm-offset-6 {
    margin-left: 50%;
  }
  .col-sm-offset-5 {
    margin-left: 41.66666667%;
  }
  .col-sm-offset-4 {
    margin-left: 33.33333333%;
  }
  .col-sm-offset-3 {
    margin-left: 25%;
  }
  .col-sm-offset-2 {
    margin-left: 16.66666667%;
  }
  .col-sm-offset-1 {
    margin-left: 8.33333333%;
  }
  .col-sm-offset-0 {
    margin-left: 0%;
  }
}
@media (min-width: 992px) {
  .col-md-1, .col-md-2, .col-md-3, .col-md-4, .col-md-5, .col-md-6, .col-md-7, .col-md-8, .col-md-9, .col-md-10, .col-md-11, .col-md-12 {
    float: left;
  }
  .col-md-12 {
    width: 100%;
  }
  .col-md-11 {
    width: 91.66666667%;
  }
  .col-md-10 {
    width: 83.33333333%;
  }
  .col-md-9 {
    width: 75%;
  }
  .col-md-8 {
    width: 66.66666667%;
  }
  .col-md-7 {
    width: 58.33333333%;
  }
  .col-md-6 {
    width: 50%;
  }
  .col-md-5 {
    width: 41.66666667%;
  }
  .col-md-4 {
    width: 33.33333333%;
  }
  .col-md-3 {
    width: 25%;
  }
  .col-md-2 {
    width: 16.66666667%;
  }
  .col-md-1 {
    width: 8.33333333%;
  }
  .col-md-pull-12 {
    right: 100%;
  }
  .col-md-pull-11 {
    right: 91.66666667%;
  }
  .col-md-pull-10 {
    right: 83.33333333%;
  }
  .col-md-pull-9 {
    right: 75%;
  }
  .col-md-pull-8 {
    right: 66.66666667%;
  }
  .col-md-pull-7 {
    right: 58.33333333%;
  }
  .col-md-pull-6 {
    right: 50%;
  }
  .col-md-pull-5 {
    right: 41.66666667%;
  }
  .col-md-pull-4 {
    right: 33.33333333%;
  }
  .col-md-pull-3 {
    right: 25%;
  }
  .col-md-pull-2 {
    right: 16.66666667%;
  }
  .col-md-pull-1 {
    right: 8.33333333%;
  }
  .col-md-pull-0 {
    right: auto;
  }
  .col-md-push-12 {
    left: 100%;
  }
  .col-md-push-11 {
    left: 91.66666667%;
  }
  .col-md-push-10 {
    left: 83.33333333%;
  }
  .col-md-push-9 {
    left: 75%;
  }
  .col-md-push-8 {
    left: 66.66666667%;
  }
  .col-md-push-7 {
    left: 58.33333333%;
  }
  .col-md-push-6 {
    left: 50%;
  }
  .col-md-push-5 {
    left: 41.66666667%;
  }
  .col-md-push-4 {
    left: 33.33333333%;
  }
  .col-md-push-3 {
    left: 25%;
  }
  .col-md-push-2 {
    left: 16.66666667%;
  }
  .col-md-push-1 {
    left: 8.33333333%;
  }
  .col-md-push-0 {
    left: auto;
  }
  .col-md-offset-12 {
    margin-left: 100%;
  }
  .col-md-offset-11 {
    margin-left: 91.66666667%;
  }
  .col-md-offset-10 {
    margin-left: 83.33333333%;
  }
  .col-md-offset-9 {
    margin-left: 75%;
  }
  .col-md-offset-8 {
    margin-left: 66.66666667%;
  }
  .col-md-offset-7 {
    margin-left: 58.33333333%;
  }
  .col-md-offset-6 {
    margin-left: 50%;
  }
  .col-md-offset-5 {
    margin-left: 41.66666667%;
  }
  .col-md-offset-4 {
    margin-left: 33.33333333%;
  }
  .col-md-offset-3 {
    margin-left: 25%;
  }
  .col-md-offset-2 {
    margin-left: 16.66666667%;
  }
  .col-md-offset-1 {
    margin-left: 8.33333333%;
  }
  .col-md-offset-0 {
    margin-left: 0%;
  }
}
@media (min-width: 1200px) {
  .col-lg-1, .col-lg-2, .col-lg-3, .col-lg-4, .col-lg-5, .col-lg-6, .col-lg-7, .col-lg-8, .col-lg-9, .col-lg-10, .col-lg-11, .col-lg-12 {
    float: left;
  }
  .col-lg-12 {
    width: 100%;
  }
  .col-lg-11 {
    width: 91.66666667%;
  }
  .col-lg-10 {
    width: 83.33333333%;
  }
  .col-lg-9 {
    width: 75%;
  }
  .col-lg-8 {
    width: 66.66666667%;
  }
  .col-lg-7 {
    width: 58.33333333%;
  }
  .col-lg-6 {
    width: 50%;
  }
  .col-lg-5 {
    width: 41.66666667%;
  }
  .col-lg-4 {
    width: 33.33333333%;
  }
  .col-lg-3 {
    width: 25%;
  }
  .col-lg-2 {
    width: 16.66666667%;
  }
  .col-lg-1 {
    width: 8.33333333%;
  }
  .col-lg-pull-12 {
    right: 100%;
  }
  .col-lg-pull-11 {
    right: 91.66666667%;
  }
  .col-lg-pull-10 {
    right: 83.33333333%;
  }
  .col-lg-pull-9 {
    right: 75%;
  }
  .col-lg-pull-8 {
    right: 66.66666667%;
  }
  .col-lg-pull-7 {
    right: 58.33333333%;
  }
  .col-lg-pull-6 {
    right: 50%;
  }
  .col-lg-pull-5 {
    right: 41.66666667%;
  }
  .col-lg-pull-4 {
    right: 33.33333333%;
  }
  .col-lg-pull-3 {
    right: 25%;
  }
  .col-lg-pull-2 {
    right: 16.66666667%;
  }
  .col-lg-pull-1 {
    right: 8.33333333%;
  }
  .col-lg-pull-0 {
    right: auto;
  }
  .col-lg-push-12 {
    left: 100%;
  }
  .col-lg-push-11 {
    left: 91.66666667%;
  }
  .col-lg-push-10 {
    left: 83.33333333%;
  }
  .col-lg-push-9 {
    left: 75%;
  }
  .col-lg-push-8 {
    left: 66.66666667%;
  }
  .col-lg-push-7 {
    left: 58.33333333%;
  }
  .col-lg-push-6 {
    left: 50%;
  }
  .col-lg-push-5 {
    left: 41.66666667%;
  }
  .col-lg-push-4 {
    left: 33.33333333%;
  }
  .col-lg-push-3 {
    left: 25%;
  }
  .col-lg-push-2 {
    left: 16.66666667%;
  }
  .col-lg-push-1 {
    left: 8.33333333%;
  }
  .col-lg-push-0 {
    left: auto;
  }
  .col-lg-offset-12 {
    margin-left: 100%;
  }
  .col-lg-offset-11 {
    margin-left: 91.66666667%;
  }
  .col-lg-offset-10 {
    margin-left: 83.33333333%;
  }
  .col-lg-offset-9 {
    margin-left: 75%;
  }
  .col-lg-offset-8 {
    margin-left: 66.66666667%;
  }
  .col-lg-offset-7 {
    margin-left: 58.33333333%;
  }
  .col-lg-offset-6 {
    margin-left: 50%;
  }
  .col-lg-offset-5 {
    margin-left: 41.66666667%;
  }
  .col-lg-offset-4 {
    margin-left: 33.33333333%;
  }
  .col-lg-offset-3 {
    margin-left: 25%;
  }
  .col-lg-offset-2 {
    margin-left: 16.66666667%;
  }
  .col-lg-offset-1 {
    margin-left: 8.33333333%;
  }
  .col-lg-offset-0 {
    margin-left: 0%;
  }
}
table {
  background-color: transparent;
}
caption {
  padding-top: 8px;
  padding-bottom: 8px;
  color: #777777;
  text-align: left;
}
th {
  text-align: left;
}
.table {
  width: 100%;
  max-width: 100%;
  margin-bottom: 18px;
}
.table > thead > tr > th,
.table > tbody > tr > th,
.table > tfoot > tr > th,
.table > thead > tr > td,
.table > tbody > tr > td,
.table > tfoot > tr > td {
  padding: 8px;
  line-height: 1.42857143;
  vertical-align: top;
  border-top: 1px solid #ddd;
}
.table > thead > tr > th {
  vertical-align: bottom;
  border-bottom: 2px solid #ddd;
}
.table > caption + thead > tr:first-child > th,
.table > colgroup + thead > tr:first-child > th,
.table > thead:first-child > tr:first-child > th,
.table > caption + thead > tr:first-child > td,
.table > colgroup + thead > tr:first-child > td,
.table > thead:first-child > tr:first-child > td {
  border-top: 0;
}
.table > tbody + tbody {
  border-top: 2px solid #ddd;
}
.table .table {
  background-color: #fff;
}
.table-condensed > thead > tr > th,
.table-condensed > tbody > tr > th,
.table-condensed > tfoot > tr > th,
.table-condensed > thead > tr > td,
.table-condensed > tbody > tr > td,
.table-condensed > tfoot > tr > td {
  padding: 5px;
}
.table-bordered {
  border: 1px solid #ddd;
}
.table-bordered > thead > tr > th,
.table-bordered > tbody > tr > th,
.table-bordered > tfoot > tr > th,
.table-bordered > thead > tr > td,
.table-bordered > tbody > tr > td,
.table-bordered > tfoot > tr > td {
  border: 1px solid #ddd;
}
.table-bordered > thead > tr > th,
.table-bordered > thead > tr > td {
  border-bottom-width: 2px;
}
.table-striped > tbody > tr:nth-of-type(odd) {
  background-color: #f9f9f9;
}
.table-hover > tbody > tr:hover {
  background-color: #f5f5f5;
}
table col[class*="col-"] {
  position: static;
  float: none;
  display: table-column;
}
table td[class*="col-"],
table th[class*="col-"] {
  position: static;
  float: none;
  display: table-cell;
}
.table > thead > tr > td.active,
.table > tbody > tr > td.active,
.table > tfoot > tr > td.active,
.table > thead > tr > th.active,
.table > tbody > tr > th.active,
.table > tfoot > tr > th.active,
.table > thead > tr.active > td,
.table > tbody > tr.active > td,
.table > tfoot > tr.active > td,
.table > thead > tr.active > th,
.table > tbody > tr.active > th,
.table > tfoot > tr.active > th {
  background-color: #f5f5f5;
}
.table-hover > tbody > tr > td.active:hover,
.table-hover > tbody > tr > th.active:hover,
.table-hover > tbody > tr.active:hover > td,
.table-hover > tbody > tr:hover > .active,
.table-hover > tbody > tr.active:hover > th {
  background-color: #e8e8e8;
}
.table > thead > tr > td.success,
.table > tbody > tr > td.success,
.table > tfoot > tr > td.success,
.table > thead > tr > th.success,
.table > tbody > tr > th.success,
.table > tfoot > tr > th.success,
.table > thead > tr.success > td,
.table > tbody > tr.success > td,
.table > tfoot > tr.success > td,
.table > thead > tr.success > th,
.table > tbody > tr.success > th,
.table > tfoot > tr.success > th {
  background-color: #dff0d8;
}
.table-hover > tbody > tr > td.success:hover,
.table-hover > tbody > tr > th.success:hover,
.table-hover > tbody > tr.success:hover > td,
.table-hover > tbody > tr:hover > .success,
.table-hover > tbody > tr.success:hover > th {
  background-color: #d0e9c6;
}
.table > thead > tr > td.info,
.table > tbody > tr > td.info,
.table > tfoot > tr > td.info,
.table > thead > tr > th.info,
.table > tbody > tr > th.info,
.table > tfoot > tr > th.info,
.table > thead > tr.info > td,
.table > tbody > tr.info > td,
.table > tfoot > tr.info > td,
.table > thead > tr.info > th,
.table > tbody > tr.info > th,
.table > tfoot > tr.info > th {
  background-color: #d9edf7;
}
.table-hover > tbody > tr > td.info:hover,
.table-hover > tbody > tr > th.info:hover,
.table-hover > tbody > tr.info:hover > td,
.table-hover > tbody > tr:hover > .info,
.table-hover > tbody > tr.info:hover > th {
  background-color: #c4e3f3;
}
.table > thead > tr > td.warning,
.table > tbody > tr > td.warning,
.table > tfoot > tr > td.warning,
.table > thead > tr > th.warning,
.table > tbody > tr > th.warning,
.table > tfoot > tr > th.warning,
.table > thead > tr.warning > td,
.table > tbody > tr.warning > td,
.table > tfoot > tr.warning > td,
.table > thead > tr.warning > th,
.table > tbody > tr.warning > th,
.table > tfoot > tr.warning > th {
  background-color: #fcf8e3;
}
.table-hover > tbody > tr > td.warning:hover,
.table-hover > tbody > tr > th.warning:hover,
.table-hover > tbody > tr.warning:hover > td,
.table-hover > tbody > tr:hover > .warning,
.table-hover > tbody > tr.warning:hover > th {
  background-color: #faf2cc;
}
.table > thead > tr > td.danger,
.table > tbody > tr > td.danger,
.table > tfoot > tr > td.danger,
.table > thead > tr > th.danger,
.table > tbody > tr > th.danger,
.table > tfoot > tr > th.danger,
.table > thead > tr.danger > td,
.table > tbody > tr.danger > td,
.table > tfoot > tr.danger > td,
.table > thead > tr.danger > th,
.table > tbody > tr.danger > th,
.table > tfoot > tr.danger > th {
  background-color: #f2dede;
}
.table-hover > tbody > tr > td.danger:hover,
.table-hover > tbody > tr > th.danger:hover,
.table-hover > tbody > tr.danger:hover > td,
.table-hover > tbody > tr:hover > .danger,
.table-hover > tbody > tr.danger:hover > th {
  background-color: #ebcccc;
}
.table-responsive {
  overflow-x: auto;
  min-height: 0.01%;
}
@media screen and (max-width: 767px) {
  .table-responsive {
    width: 100%;
    margin-bottom: 13.5px;
    overflow-y: hidden;
    -ms-overflow-style: -ms-autohiding-scrollbar;
    border: 1px solid #ddd;
  }
  .table-responsive > .table {
    margin-bottom: 0;
  }
  .table-responsive > .table > thead > tr > th,
  .table-responsive > .table > tbody > tr > th,
  .table-responsive > .table > tfoot > tr > th,
  .table-responsive > .table > thead > tr > td,
  .table-responsive > .table > tbody > tr > td,
  .table-responsive > .table > tfoot > tr > td {
    white-space: nowrap;
  }
  .table-responsive > .table-bordered {
    border: 0;
  }
  .table-responsive > .table-bordered > thead > tr > th:first-child,
  .table-responsive > .table-bordered > tbody > tr > th:first-child,
  .table-responsive > .table-bordered > tfoot > tr > th:first-child,
  .table-responsive > .table-bordered > thead > tr > td:first-child,
  .table-responsive > .table-bordered > tbody > tr > td:first-child,
  .table-responsive > .table-bordered > tfoot > tr > td:first-child {
    border-left: 0;
  }
  .table-responsive > .table-bordered > thead > tr > th:last-child,
  .table-responsive > .table-bordered > tbody > tr > th:last-child,
  .table-responsive > .table-bordered > tfoot > tr > th:last-child,
  .table-responsive > .table-bordered > thead > tr > td:last-child,
  .table-responsive > .table-bordered > tbody > tr > td:last-child,
  .table-responsive > .table-bordered > tfoot > tr > td:last-child {
    border-right: 0;
  }
  .table-responsive > .table-bordered > tbody > tr:last-child > th,
  .table-responsive > .table-bordered > tfoot > tr:last-child > th,
  .table-responsive > .table-bordered > tbody > tr:last-child > td,
  .table-responsive > .table-bordered > tfoot > tr:last-child > td {
    border-bottom: 0;
  }
}
fieldset {
  padding: 0;
  margin: 0;
  border: 0;
  min-width: 0;
}
legend {
  display: block;
  width: 100%;
  padding: 0;
  margin-bottom: 18px;
  font-size: 19.5px;
  line-height: inherit;
  color: #333333;
  border: 0;
  border-bottom: 1px solid #e5e5e5;
}
label {
  display: inline-block;
  max-width: 100%;
  margin-bottom: 5px;
  font-weight: bold;
}
input[type="search"] {
  -webkit-box-sizing: border-box;
  -moz-box-sizing: border-box;
  box-sizing: border-box;
}
input[type="radio"],
input[type="checkbox"] {
  margin: 4px 0 0;
  margin-top: 1px \9;
  line-height: normal;
}
input[type="file"] {
  display: block;
}
input[type="range"] {
  display: block;
  width: 100%;
}
select[multiple],
select[size] {
  height: auto;
}
input[type="file"]:focus,
input[type="radio"]:focus,
input[type="checkbox"]:focus {
  outline: 5px auto -webkit-focus-ring-color;
  outline-offset: -2px;
}
output {
  display: block;
  padding-top: 7px;
  font-size: 13px;
  line-height: 1.42857143;
  color: #555555;
}
.form-control {
  display: block;
  width: 100%;
  height: 32px;
  padding: 6px 12px;
  font-size: 13px;
  line-height: 1.42857143;
  color: #555555;
  background-color: #fff;
  background-image: none;
  border: 1px solid #ccc;
  border-radius: 2px;
  -webkit-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075);
  box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075);
  -webkit-transition: border-color ease-in-out .15s, box-shadow ease-in-out .15s;
  -o-transition: border-color ease-in-out .15s, box-shadow ease-in-out .15s;
  transition: border-color ease-in-out .15s, box-shadow ease-in-out .15s;
}
.form-control:focus {
  border-color: #66afe9;
  outline: 0;
  -webkit-box-shadow: inset 0 1px 1px rgba(0,0,0,.075), 0 0 8px rgba(102, 175, 233, 0.6);
  box-shadow: inset 0 1px 1px rgba(0,0,0,.075), 0 0 8px rgba(102, 175, 233, 0.6);
}
.form-control::-moz-placeholder {
  color: #999;
  opacity: 1;
}
.form-control:-ms-input-placeholder {
  color: #999;
}
.form-control::-webkit-input-placeholder {
  color: #999;
}
.form-control::-ms-expand {
  border: 0;
  background-color: transparent;
}
.form-control[disabled],
.form-control[readonly],
fieldset[disabled] .form-control {
  background-color: #eeeeee;
  opacity: 1;
}
.form-control[disabled],
fieldset[disabled] .form-control {
  cursor: not-allowed;
}
textarea.form-control {
  height: auto;
}
input[type="search"] {
  -webkit-appearance: none;
}
@media screen and (-webkit-min-device-pixel-ratio: 0) {
  input[type="date"].form-control,
  input[type="time"].form-control,
  input[type="datetime-local"].form-control,
  input[type="month"].form-control {
    line-height: 32px;
  }
  input[type="date"].input-sm,
  input[type="time"].input-sm,
  input[type="datetime-local"].input-sm,
  input[type="month"].input-sm,
  .input-group-sm input[type="date"],
  .input-group-sm input[type="time"],
  .input-group-sm input[type="datetime-local"],
  .input-group-sm input[type="month"] {
    line-height: 30px;
  }
  input[type="date"].input-lg,
  input[type="time"].input-lg,
  input[type="datetime-local"].input-lg,
  input[type="month"].input-lg,
  .input-group-lg input[type="date"],
  .input-group-lg input[type="time"],
  .input-group-lg input[type="datetime-local"],
  .input-group-lg input[type="month"] {
    line-height: 45px;
  }
}
.form-group {
  margin-bottom: 15px;
}
.radio,
.checkbox {
  position: relative;
  display: block;
  margin-top: 10px;
  margin-bottom: 10px;
}
.radio label,
.checkbox label {
  min-height: 18px;
  padding-left: 20px;
  margin-bottom: 0;
  font-weight: normal;
  cursor: pointer;
}
.radio input[type="radio"],
.radio-inline input[type="radio"],
.checkbox input[type="checkbox"],
.checkbox-inline input[type="checkbox"] {
  position: absolute;
  margin-left: -20px;
  margin-top: 4px \9;
}
.radio + .radio,
.checkbox + .checkbox {
  margin-top: -5px;
}
.radio-inline,
.checkbox-inline {
  position: relative;
  display: inline-block;
  padding-left: 20px;
  margin-bottom: 0;
  vertical-align: middle;
  font-weight: normal;
  cursor: pointer;
}
.radio-inline + .radio-inline,
.checkbox-inline + .checkbox-inline {
  margin-top: 0;
  margin-left: 10px;
}
input[type="radio"][disabled],
input[type="checkbox"][disabled],
input[type="radio"].disabled,
input[type="checkbox"].disabled,
fieldset[disabled] input[type="radio"],
fieldset[disabled] input[type="checkbox"] {
  cursor: not-allowed;
}
.radio-inline.disabled,
.checkbox-inline.disabled,
fieldset[disabled] .radio-inline,
fieldset[disabled] .checkbox-inline {
  cursor: not-allowed;
}
.radio.disabled label,
.checkbox.disabled label,
fieldset[disabled] .radio label,
fieldset[disabled] .checkbox label {
  cursor: not-allowed;
}
.form-control-static {
  padding-top: 7px;
  padding-bottom: 7px;
  margin-bottom: 0;
  min-height: 31px;
}
.form-control-static.input-lg,
.form-control-static.input-sm {
  padding-left: 0;
  padding-right: 0;
}
.input-sm {
  height: 30px;
  padding: 5px 10px;
  font-size: 12px;
  line-height: 1.5;
  border-radius: 1px;
}
select.input-sm {
  height: 30px;
  line-height: 30px;
}
textarea.input-sm,
select[multiple].input-sm {
  height: auto;
}
.form-group-sm .form-control {
  height: 30px;
  padding: 5px 10px;
  font-size: 12px;
  line-height: 1.5;
  border-radius: 1px;
}
.form-group-sm select.form-control {
  height: 30px;
  line-height: 30px;
}
.form-group-sm textarea.form-control,
.form-group-sm select[multiple].form-control {
  height: auto;
}
.form-group-sm .form-control-static {
  height: 30px;
  min-height: 30px;
  padding: 6px 10px;
  font-size: 12px;
  line-height: 1.5;
}
.input-lg {
  height: 45px;
  padding: 10px 16px;
  font-size: 17px;
  line-height: 1.3333333;
  border-radius: 3px;
}
select.input-lg {
  height: 45px;
  line-height: 45px;
}
textarea.input-lg,
select[multiple].input-lg {
  height: auto;
}
.form-group-lg .form-control {
  height: 45px;
  padding: 10px 16px;
  font-size: 17px;
  line-height: 1.3333333;
  border-radius: 3px;
}
.form-group-lg select.form-control {
  height: 45px;
  line-height: 45px;
}
.form-group-lg textarea.form-control,
.form-group-lg select[multiple].form-control {
  height: auto;
}
.form-group-lg .form-control-static {
  height: 45px;
  min-height: 35px;
  padding: 11px 16px;
  font-size: 17px;
  line-height: 1.3333333;
}
.has-feedback {
  position: relative;
}
.has-feedback .form-control {
  padding-right: 40px;
}
.form-control-feedback {
  position: absolute;
  top: 0;
  right: 0;
  z-index: 2;
  display: block;
  width: 32px;
  height: 32px;
  line-height: 32px;
  text-align: center;
  pointer-events: none;
}
.input-lg + .form-control-feedback,
.input-group-lg + .form-control-feedback,
.form-group-lg .form-control + .form-control-feedback {
  width: 45px;
  height: 45px;
  line-height: 45px;
}
.input-sm + .form-control-feedback,
.input-group-sm + .form-control-feedback,
.form-group-sm .form-control + .form-control-feedback {
  width: 30px;
  height: 30px;
  line-height: 30px;
}
.has-success .help-block,
.has-success .control-label,
.has-success .radio,
.has-success .checkbox,
.has-success .radio-inline,
.has-success .checkbox-inline,
.has-success.radio label,
.has-success.checkbox label,
.has-success.radio-inline label,
.has-success.checkbox-inline label {
  color: #3c763d;
}
.has-success .form-control {
  border-color: #3c763d;
  -webkit-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075);
  box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075);
}
.has-success .form-control:focus {
  border-color: #2b542c;
  -webkit-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075), 0 0 6px #67b168;
  box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075), 0 0 6px #67b168;
}
.has-success .input-group-addon {
  color: #3c763d;
  border-color: #3c763d;
  background-color: #dff0d8;
}
.has-success .form-control-feedback {
  color: #3c763d;
}
.has-warning .help-block,
.has-warning .control-label,
.has-warning .radio,
.has-warning .checkbox,
.has-warning .radio-inline,
.has-warning .checkbox-inline,
.has-warning.radio label,
.has-warning.checkbox label,
.has-warning.radio-inline label,
.has-warning.checkbox-inline label {
  color: #8a6d3b;
}
.has-warning .form-control {
  border-color: #8a6d3b;
  -webkit-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075);
  box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075);
}
.has-warning .form-control:focus {
  border-color: #66512c;
  -webkit-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075), 0 0 6px #c0a16b;
  box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075), 0 0 6px #c0a16b;
}
.has-warning .input-group-addon {
  color: #8a6d3b;
  border-color: #8a6d3b;
  background-color: #fcf8e3;
}
.has-warning .form-control-feedback {
  color: #8a6d3b;
}
.has-error .help-block,
.has-error .control-label,
.has-error .radio,
.has-error .checkbox,
.has-error .radio-inline,
.has-error .checkbox-inline,
.has-error.radio label,
.has-error.checkbox label,
.has-error.radio-inline label,
.has-error.checkbox-inline label {
  color: #a94442;
}
.has-error .form-control {
  border-color: #a94442;
  -webkit-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075);
  box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075);
}
.has-error .form-control:focus {
  border-color: #843534;
  -webkit-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075), 0 0 6px #ce8483;
  box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075), 0 0 6px #ce8483;
}
.has-error .input-group-addon {
  color: #a94442;
  border-color: #a94442;
  background-color: #f2dede;
}
.has-error .form-control-feedback {
  color: #a94442;
}
.has-feedback label ~ .form-control-feedback {
  top: 23px;
}
.has-feedback label.sr-only ~ .form-control-feedback {
  top: 0;
}
.help-block {
  display: block;
  margin-top: 5px;
  margin-bottom: 10px;
  color: #404040;
}
@media (min-width: 768px) {
  .form-inline .form-group {
    display: inline-block;
    margin-bottom: 0;
    vertical-align: middle;
  }
  .form-inline .form-control {
    display: inline-block;
    width: auto;
    vertical-align: middle;
  }
  .form-inline .form-control-static {
    display: inline-block;
  }
  .form-inline .input-group {
    display: inline-table;
    vertical-align: middle;
  }
  .form-inline .input-group .input-group-addon,
  .form-inline .input-group .input-group-btn,
  .form-inline .input-group .form-control {
    width: auto;
  }
  .form-inline .input-group > .form-control {
    width: 100%;
  }
  .form-inline .control-label {
    margin-bottom: 0;
    vertical-align: middle;
  }
  .form-inline .radio,
  .form-inline .checkbox {
    display: inline-block;
    margin-top: 0;
    margin-bottom: 0;
    vertical-align: middle;
  }
  .form-inline .radio label,
  .form-inline .checkbox label {
    padding-left: 0;
  }
  .form-inline .radio input[type="radio"],
  .form-inline .checkbox input[type="checkbox"] {
    position: relative;
    margin-left: 0;
  }
  .form-inline .has-feedback .form-control-feedback {
    top: 0;
  }
}
.form-horizontal .radio,
.form-horizontal .checkbox,
.form-horizontal .radio-inline,
.form-horizontal .checkbox-inline {
  margin-top: 0;
  margin-bottom: 0;
  padding-top: 7px;
}
.form-horizontal .radio,
.form-horizontal .checkbox {
  min-height: 25px;
}
.form-horizontal .form-group {
  margin-left: 0px;
  margin-right: 0px;
}
@media (min-width: 768px) {
  .form-horizontal .control-label {
    text-align: right;
    margin-bottom: 0;
    padding-top: 7px;
  }
}
.form-horizontal .has-feedback .form-control-feedback {
  right: 0px;
}
@media (min-width: 768px) {
  .form-horizontal .form-group-lg .control-label {
    padding-top: 11px;
    font-size: 17px;
  }
}
@media (min-width: 768px) {
  .form-horizontal .form-group-sm .control-label {
    padding-top: 6px;
    font-size: 12px;
  }
}
.btn {
  display: inline-block;
  margin-bottom: 0;
  font-weight: normal;
  text-align: center;
  vertical-align: middle;
  touch-action: manipulation;
  cursor: pointer;
  background-image: none;
  border: 1px solid transparent;
  white-space: nowrap;
  padding: 6px 12px;
  font-size: 13px;
  line-height: 1.42857143;
  border-radius: 2px;
  -webkit-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
}
.btn:focus,
.btn:active:focus,
.btn.active:focus,
.btn.focus,
.btn:active.focus,
.btn.active.focus {
  outline: 5px auto -webkit-focus-ring-color;
  outline-offset: -2px;
}
.btn:hover,
.btn:focus,
.btn.focus {
  color: #333;
  text-decoration: none;
}
.btn:active,
.btn.active {
  outline: 0;
  background-image: none;
  -webkit-box-shadow: inset 0 3px 5px rgba(0, 0, 0, 0.125);
  box-shadow: inset 0 3px 5px rgba(0, 0, 0, 0.125);
}
.btn.disabled,
.btn[disabled],
fieldset[disabled] .btn {
  cursor: not-allowed;
  opacity: 0.65;
  filter: alpha(opacity=65);
  -webkit-box-shadow: none;
  box-shadow: none;
}
a.btn.disabled,
fieldset[disabled] a.btn {
  pointer-events: none;
}
.btn-default {
  color: #333;
  background-color: #fff;
  border-color: #ccc;
}
.btn-default:focus,
.btn-default.focus {
  color: #333;
  background-color: #e6e6e6;
  border-color: #8c8c8c;
}
.btn-default:hover {
  color: #333;
  background-color: #e6e6e6;
  border-color: #adadad;
}
.btn-default:active,
.btn-default.active,
.open > .dropdown-toggle.btn-default {
  color: #333;
  background-color: #e6e6e6;
  border-color: #adadad;
}
.btn-default:active:hover,
.btn-default.active:hover,
.open > .dropdown-toggle.btn-default:hover,
.btn-default:active:focus,
.btn-default.active:focus,
.open > .dropdown-toggle.btn-default:focus,
.btn-default:active.focus,
.btn-default.active.focus,
.open > .dropdown-toggle.btn-default.focus {
  color: #333;
  background-color: #d4d4d4;
  border-color: #8c8c8c;
}
.btn-default:active,
.btn-default.active,
.open > .dropdown-toggle.btn-default {
  background-image: none;
}
.btn-default.disabled:hover,
.btn-default[disabled]:hover,
fieldset[disabled] .btn-default:hover,
.btn-default.disabled:focus,
.btn-default[disabled]:focus,
fieldset[disabled] .btn-default:focus,
.btn-default.disabled.focus,
.btn-default[disabled].focus,
fieldset[disabled] .btn-default.focus {
  background-color: #fff;
  border-color: #ccc;
}
.btn-default .badge {
  color: #fff;
  background-color: #333;
}
.btn-primary {
  color: #fff;
  background-color: #337ab7;
  border-color: #2e6da4;
}
.btn-primary:focus,
.btn-primary.focus {
  color: #fff;
  background-color: #286090;
  border-color: #122b40;
}
.btn-primary:hover {
  color: #fff;
  background-color: #286090;
  border-color: #204d74;
}
.btn-primary:active,
.btn-primary.active,
.open > .dropdown-toggle.btn-primary {
  color: #fff;
  background-color: #286090;
  border-color: #204d74;
}
.btn-primary:active:hover,
.btn-primary.active:hover,
.open > .dropdown-toggle.btn-primary:hover,
.btn-primary:active:focus,
.btn-primary.active:focus,
.open > .dropdown-toggle.btn-primary:focus,
.btn-primary:active.focus,
.btn-primary.active.focus,
.open > .dropdown-toggle.btn-primary.focus {
  color: #fff;
  background-color: #204d74;
  border-color: #122b40;
}
.btn-primary:active,
.btn-primary.active,
.open > .dropdown-toggle.btn-primary {
  background-image: none;
}
.btn-primary.disabled:hover,
.btn-primary[disabled]:hover,
fieldset[disabled] .btn-primary:hover,
.btn-primary.disabled:focus,
.btn-primary[disabled]:focus,
fieldset[disabled] .btn-primary:focus,
.btn-primary.disabled.focus,
.btn-primary[disabled].focus,
fieldset[disabled] .btn-primary.focus {
  background-color: #337ab7;
  border-color: #2e6da4;
}
.btn-primary .badge {
  color: #337ab7;
  background-color: #fff;
}
.btn-success {
  color: #fff;
  background-color: #5cb85c;
  border-color: #4cae4c;
}
.btn-success:focus,
.btn-success.focus {
  color: #fff;
  background-color: #449d44;
  border-color: #255625;
}
.btn-success:hover {
  color: #fff;
  background-color: #449d44;
  border-color: #398439;
}
.btn-success:active,
.btn-success.active,
.open > .dropdown-toggle.btn-success {
  color: #fff;
  background-color: #449d44;
  border-color: #398439;
}
.btn-success:active:hover,
.btn-success.active:hover,
.open > .dropdown-toggle.btn-success:hover,
.btn-success:active:focus,
.btn-success.active:focus,
.open > .dropdown-toggle.btn-success:focus,
.btn-success:active.focus,
.btn-success.active.focus,
.open > .dropdown-toggle.btn-success.focus {
  color: #fff;
  background-color: #398439;
  border-color: #255625;
}
.btn-success:active,
.btn-success.active,
.open > .dropdown-toggle.btn-success {
  background-image: none;
}
.btn-success.disabled:hover,
.btn-success[disabled]:hover,
fieldset[disabled] .btn-success:hover,
.btn-success.disabled:focus,
.btn-success[disabled]:focus,
fieldset[disabled] .btn-success:focus,
.btn-success.disabled.focus,
.btn-success[disabled].focus,
fieldset[disabled] .btn-success.focus {
  background-color: #5cb85c;
  border-color: #4cae4c;
}
.btn-success .badge {
  color: #5cb85c;
  background-color: #fff;
}
.btn-info {
  color: #fff;
  background-color: #5bc0de;
  border-color: #46b8da;
}
.btn-info:focus,
.btn-info.focus {
  color: #fff;
  background-color: #31b0d5;
  border-color: #1b6d85;
}
.btn-info:hover {
  color: #fff;
  background-color: #31b0d5;
  border-color: #269abc;
}
.btn-info:active,
.btn-info.active,
.open > .dropdown-toggle.btn-info {
  color: #fff;
  background-color: #31b0d5;
  border-color: #269abc;
}
.btn-info:active:hover,
.btn-info.active:hover,
.open > .dropdown-toggle.btn-info:hover,
.btn-info:active:focus,
.btn-info.active:focus,
.open > .dropdown-toggle.btn-info:focus,
.btn-info:active.focus,
.btn-info.active.focus,
.open > .dropdown-toggle.btn-info.focus {
  color: #fff;
  background-color: #269abc;
  border-color: #1b6d85;
}
.btn-info:active,
.btn-info.active,
.open > .dropdown-toggle.btn-info {
  background-image: none;
}
.btn-info.disabled:hover,
.btn-info[disabled]:hover,
fieldset[disabled] .btn-info:hover,
.btn-info.disabled:focus,
.btn-info[disabled]:focus,
fieldset[disabled] .btn-info:focus,
.btn-info.disabled.focus,
.btn-info[disabled].focus,
fieldset[disabled] .btn-info.focus {
  background-color: #5bc0de;
  border-color: #46b8da;
}
.btn-info .badge {
  color: #5bc0de;
  background-color: #fff;
}
.btn-warning {
  color: #fff;
  background-color: #f0ad4e;
  border-color: #eea236;
}
.btn-warning:focus,
.btn-warning.focus {
  color: #fff;
  background-color: #ec971f;
  border-color: #985f0d;
}
.btn-warning:hover {
  color: #fff;
  background-color: #ec971f;
  border-color: #d58512;
}
.btn-warning:active,
.btn-warning.active,
.open > .dropdown-toggle.btn-warning {
  color: #fff;
  background-color: #ec971f;
  border-color: #d58512;
}
.btn-warning:active:hover,
.btn-warning.active:hover,
.open > .dropdown-toggle.btn-warning:hover,
.btn-warning:active:focus,
.btn-warning.active:focus,
.open > .dropdown-toggle.btn-warning:focus,
.btn-warning:active.focus,
.btn-warning.active.focus,
.open > .dropdown-toggle.btn-warning.focus {
  color: #fff;
  background-color: #d58512;
  border-color: #985f0d;
}
.btn-warning:active,
.btn-warning.active,
.open > .dropdown-toggle.btn-warning {
  background-image: none;
}
.btn-warning.disabled:hover,
.btn-warning[disabled]:hover,
fieldset[disabled] .btn-warning:hover,
.btn-warning.disabled:focus,
.btn-warning[disabled]:focus,
fieldset[disabled] .btn-warning:focus,
.btn-warning.disabled.focus,
.btn-warning[disabled].focus,
fieldset[disabled] .btn-warning.focus {
  background-color: #f0ad4e;
  border-color: #eea236;
}
.btn-warning .badge {
  color: #f0ad4e;
  background-color: #fff;
}
.btn-danger {
  color: #fff;
  background-color: #d9534f;
  border-color: #d43f3a;
}
.btn-danger:focus,
.btn-danger.focus {
  color: #fff;
  background-color: #c9302c;
  border-color: #761c19;
}
.btn-danger:hover {
  color: #fff;
  background-color: #c9302c;
  border-color: #ac2925;
}
.btn-danger:active,
.btn-danger.active,
.open > .dropdown-toggle.btn-danger {
  color: #fff;
  background-color: #c9302c;
  border-color: #ac2925;
}
.btn-danger:active:hover,
.btn-danger.active:hover,
.open > .dropdown-toggle.btn-danger:hover,
.btn-danger:active:focus,
.btn-danger.active:focus,
.open > .dropdown-toggle.btn-danger:focus,
.btn-danger:active.focus,
.btn-danger.active.focus,
.open > .dropdown-toggle.btn-danger.focus {
  color: #fff;
  background-color: #ac2925;
  border-color: #761c19;
}
.btn-danger:active,
.btn-danger.active,
.open > .dropdown-toggle.btn-danger {
  background-image: none;
}
.btn-danger.disabled:hover,
.btn-danger[disabled]:hover,
fieldset[disabled] .btn-danger:hover,
.btn-danger.disabled:focus,
.btn-danger[disabled]:focus,
fieldset[disabled] .btn-danger:focus,
.btn-danger.disabled.focus,
.btn-danger[disabled].focus,
fieldset[disabled] .btn-danger.focus {
  background-color: #d9534f;
  border-color: #d43f3a;
}
.btn-danger .badge {
  color: #d9534f;
  background-color: #fff;
}
.btn-link {
  color: #337ab7;
  font-weight: normal;
  border-radius: 0;
}
.btn-link,
.btn-link:active,
.btn-link.active,
.btn-link[disabled],
fieldset[disabled] .btn-link {
  background-color: transparent;
  -webkit-box-shadow: none;
  box-shadow: none;
}
.btn-link,
.btn-link:hover,
.btn-link:focus,
.btn-link:active {
  border-color: transparent;
}
.btn-link:hover,
.btn-link:focus {
  color: #23527c;
  text-decoration: underline;
  background-color: transparent;
}
.btn-link[disabled]:hover,
fieldset[disabled] .btn-link:hover,
.btn-link[disabled]:focus,
fieldset[disabled] .btn-link:focus {
  color: #777777;
  text-decoration: none;
}
.btn-lg,
.btn-group-lg > .btn {
  padding: 10px 16px;
  font-size: 17px;
  line-height: 1.3333333;
  border-radius: 3px;
}
.btn-sm,
.btn-group-sm > .btn {
  padding: 5px 10px;
  font-size: 12px;
  line-height: 1.5;
  border-radius: 1px;
}
.btn-xs,
.btn-group-xs > .btn {
  padding: 1px 5px;
  font-size: 12px;
  line-height: 1.5;
  border-radius: 1px;
}
.btn-block {
  display: block;
  width: 100%;
}
.btn-block + .btn-block {
  margin-top: 5px;
}
input[type="submit"].btn-block,
input[type="reset"].btn-block,
input[type="button"].btn-block {
  width: 100%;
}
.fade {
  opacity: 0;
  -webkit-transition: opacity 0.15s linear;
  -o-transition: opacity 0.15s linear;
  transition: opacity 0.15s linear;
}
.fade.in {
  opacity: 1;
}
.collapse {
  display: none;
}
.collapse.in {
  display: block;
}
tr.collapse.in {
  display: table-row;
}
tbody.collapse.in {
  display: table-row-group;
}
.collapsing {
  position: relative;
  height: 0;
  overflow: hidden;
  -webkit-transition-property: height, visibility;
  transition-property: height, visibility;
  -webkit-transition-duration: 0.35s;
  transition-duration: 0.35s;
  -webkit-transition-timing-function: ease;
  transition-timing-function: ease;
}
.caret {
  display: inline-block;
  width: 0;
  height: 0;
  margin-left: 2px;
  vertical-align: middle;
  border-top: 4px dashed;
  border-top: 4px solid \9;
  border-right: 4px solid transparent;
  border-left: 4px solid transparent;
}
.dropup,
.dropdown {
  position: relative;
}
.dropdown-toggle:focus {
  outline: 0;
}
.dropdown-menu {
  position: absolute;
  top: 100%;
  left: 0;
  z-index: 1000;
  display: none;
  float: left;
  min-width: 160px;
  padding: 5px 0;
  margin: 2px 0 0;
  list-style: none;
  font-size: 13px;
  text-align: left;
  background-color: #fff;
  border: 1px solid #ccc;
  border: 1px solid rgba(0, 0, 0, 0.15);
  border-radius: 2px;
  -webkit-box-shadow: 0 6px 12px rgba(0, 0, 0, 0.175);
  box-shadow: 0 6px 12px rgba(0, 0, 0, 0.175);
  background-clip: padding-box;
}
.dropdown-menu.pull-right {
  right: 0;
  left: auto;
}
.dropdown-menu .divider {
  height: 1px;
  margin: 8px 0;
  overflow: hidden;
  background-color: #e5e5e5;
}
.dropdown-menu > li > a {
  display: block;
  padding: 3px 20px;
  clear: both;
  font-weight: normal;
  line-height: 1.42857143;
  color: #333333;
  white-space: nowrap;
}
.dropdown-menu > li > a:hover,
.dropdown-menu > li > a:focus {
  text-decoration: none;
  color: #262626;
  background-color: #f5f5f5;
}
.dropdown-menu > .active > a,
.dropdown-menu > .active > a:hover,
.dropdown-menu > .active > a:focus {
  color: #fff;
  text-decoration: none;
  outline: 0;
  background-color: #337ab7;
}
.dropdown-menu > .disabled > a,
.dropdown-menu > .disabled > a:hover,
.dropdown-menu > .disabled > a:focus {
  color: #777777;
}
.dropdown-menu > .disabled > a:hover,
.dropdown-menu > .disabled > a:focus {
  text-decoration: none;
  background-color: transparent;
  background-image: none;
  filter: progid:DXImageTransform.Microsoft.gradient(enabled = false);
  cursor: not-allowed;
}
.open > .dropdown-menu {
  display: block;
}
.open > a {
  outline: 0;
}
.dropdown-menu-right {
  left: auto;
  right: 0;
}
.dropdown-menu-left {
  left: 0;
  right: auto;
}
.dropdown-header {
  display: block;
  padding: 3px 20px;
  font-size: 12px;
  line-height: 1.42857143;
  color: #777777;
  white-space: nowrap;
}
.dropdown-backdrop {
  position: fixed;
  left: 0;
  right: 0;
  bottom: 0;
  top: 0;
  z-index: 990;
}
.pull-right > .dropdown-menu {
  right: 0;
  left: auto;
}
.dropup .caret,
.navbar-fixed-bottom .dropdown .caret {
  border-top: 0;
  border-bottom: 4px dashed;
  border-bottom: 4px solid \9;
  content: "";
}
.dropup .dropdown-menu,
.navbar-fixed-bottom .dropdown .dropdown-menu {
  top: auto;
  bottom: 100%;
  margin-bottom: 2px;
}
@media (min-width: 541px) {
  .navbar-right .dropdown-menu {
    left: auto;
    right: 0;
  }
  .navbar-right .dropdown-menu-left {
    left: 0;
    right: auto;
  }
}
.btn-group,
.btn-group-vertical {
  position: relative;
  display: inline-block;
  vertical-align: middle;
}
.btn-group > .btn,
.btn-group-vertical > .btn {
  position: relative;
  float: left;
}
.btn-group > .btn:hover,
.btn-group-vertical > .btn:hover,
.btn-group > .btn:focus,
.btn-group-vertical > .btn:focus,
.btn-group > .btn:active,
.btn-group-vertical > .btn:active,
.btn-group > .btn.active,
.btn-group-vertical > .btn.active {
  z-index: 2;
}
.btn-group .btn + .btn,
.btn-group .btn + .btn-group,
.btn-group .btn-group + .btn,
.btn-group .btn-group + .btn-group {
  margin-left: -1px;
}
.btn-toolbar {
  margin-left: -5px;
}
.btn-toolbar .btn,
.btn-toolbar .btn-group,
.btn-toolbar .input-group {
  float: left;
}
.btn-toolbar > .btn,
.btn-toolbar > .btn-group,
.btn-toolbar > .input-group {
  margin-left: 5px;
}
.btn-group > .btn:not(:first-child):not(:last-child):not(.dropdown-toggle) {
  border-radius: 0;
}
.btn-group > .btn:first-child {
  margin-left: 0;
}
.btn-group > .btn:first-child:not(:last-child):not(.dropdown-toggle) {
  border-bottom-right-radius: 0;
  border-top-right-radius: 0;
}
.btn-group > .btn:last-child:not(:first-child),
.btn-group > .dropdown-toggle:not(:first-child) {
  border-bottom-left-radius: 0;
  border-top-left-radius: 0;
}
.btn-group > .btn-group {
  float: left;
}
.btn-group > .btn-group:not(:first-child):not(:last-child) > .btn {
  border-radius: 0;
}
.btn-group > .btn-group:first-child:not(:last-child) > .btn:last-child,
.btn-group > .btn-group:first-child:not(:last-child) > .dropdown-toggle {
  border-bottom-right-radius: 0;
  border-top-right-radius: 0;
}
.btn-group > .btn-group:last-child:not(:first-child) > .btn:first-child {
  border-bottom-left-radius: 0;
  border-top-left-radius: 0;
}
.btn-group .dropdown-toggle:active,
.btn-group.open .dropdown-toggle {
  outline: 0;
}
.btn-group > .btn + .dropdown-toggle {
  padding-left: 8px;
  padding-right: 8px;
}
.btn-group > .btn-lg + .dropdown-toggle {
  padding-left: 12px;
  padding-right: 12px;
}
.btn-group.open .dropdown-toggle {
  -webkit-box-shadow: inset 0 3px 5px rgba(0, 0, 0, 0.125);
  box-shadow: inset 0 3px 5px rgba(0, 0, 0, 0.125);
}
.btn-group.open .dropdown-toggle.btn-link {
  -webkit-box-shadow: none;
  box-shadow: none;
}
.btn .caret {
  margin-left: 0;
}
.btn-lg .caret {
  border-width: 5px 5px 0;
  border-bottom-width: 0;
}
.dropup .btn-lg .caret {
  border-width: 0 5px 5px;
}
.btn-group-vertical > .btn,
.btn-group-vertical > .btn-group,
.btn-group-vertical > .btn-group > .btn {
  display: block;
  float: none;
  width: 100%;
  max-width: 100%;
}
.btn-group-vertical > .btn-group > .btn {
  float: none;
}
.btn-group-vertical > .btn + .btn,
.btn-group-vertical > .btn + .btn-group,
.btn-group-vertical > .btn-group + .btn,
.btn-group-vertical > .btn-group + .btn-group {
  margin-top: -1px;
  margin-left: 0;
}
.btn-group-vertical > .btn:not(:first-child):not(:last-child) {
  border-radius: 0;
}
.btn-group-vertical > .btn:first-child:not(:last-child) {
  border-top-right-radius: 2px;
  border-top-left-radius: 2px;
  border-bottom-right-radius: 0;
  border-bottom-left-radius: 0;
}
.btn-group-vertical > .btn:last-child:not(:first-child) {
  border-top-right-radius: 0;
  border-top-left-radius: 0;
  border-bottom-right-radius: 2px;
  border-bottom-left-radius: 2px;
}
.btn-group-vertical > .btn-group:not(:first-child):not(:last-child) > .btn {
  border-radius: 0;
}
.btn-group-vertical > .btn-group:first-child:not(:last-child) > .btn:last-child,
.btn-group-vertical > .btn-group:first-child:not(:last-child) > .dropdown-toggle {
  border-bottom-right-radius: 0;
  border-bottom-left-radius: 0;
}
.btn-group-vertical > .btn-group:last-child:not(:first-child) > .btn:first-child {
  border-top-right-radius: 0;
  border-top-left-radius: 0;
}
.btn-group-justified {
  display: table;
  width: 100%;
  table-layout: fixed;
  border-collapse: separate;
}
.btn-group-justified > .btn,
.btn-group-justified > .btn-group {
  float: none;
  display: table-cell;
  width: 1%;
}
.btn-group-justified > .btn-group .btn {
  width: 100%;
}
.btn-group-justified > .btn-group .dropdown-menu {
  left: auto;
}
[data-toggle="buttons"] > .btn input[type="radio"],
[data-toggle="buttons"] > .btn-group > .btn input[type="radio"],
[data-toggle="buttons"] > .btn input[type="checkbox"],
[data-toggle="buttons"] > .btn-group > .btn input[type="checkbox"] {
  position: absolute;
  clip: rect(0, 0, 0, 0);
  pointer-events: none;
}
.input-group {
  position: relative;
  display: table;
  border-collapse: separate;
}
.input-group[class*="col-"] {
  float: none;
  padding-left: 0;
  padding-right: 0;
}
.input-group .form-control {
  position: relative;
  z-index: 2;
  float: left;
  width: 100%;
  margin-bottom: 0;
}
.input-group .form-control:focus {
  z-index: 3;
}
.input-group-lg > .form-control,
.input-group-lg > .input-group-addon,
.input-group-lg > .input-group-btn > .btn {
  height: 45px;
  padding: 10px 16px;
  font-size: 17px;
  line-height: 1.3333333;
  border-radius: 3px;
}
select.input-group-lg > .form-control,
select.input-group-lg > .input-group-addon,
select.input-group-lg > .input-group-btn > .btn {
  height: 45px;
  line-height: 45px;
}
textarea.input-group-lg > .form-control,
textarea.input-group-lg > .input-group-addon,
textarea.input-group-lg > .input-group-btn > .btn,
select[multiple].input-group-lg > .form-control,
select[multiple].input-group-lg > .input-group-addon,
select[multiple].input-group-lg > .input-group-btn > .btn {
  height: auto;
}
.input-group-sm > .form-control,
.input-group-sm > .input-group-addon,
.input-group-sm > .input-group-btn > .btn {
  height: 30px;
  padding: 5px 10px;
  font-size: 12px;
  line-height: 1.5;
  border-radius: 1px;
}
select.input-group-sm > .form-control,
select.input-group-sm > .input-group-addon,
select.input-group-sm > .input-group-btn > .btn {
  height: 30px;
  line-height: 30px;
}
textarea.input-group-sm > .form-control,
textarea.input-group-sm > .input-group-addon,
textarea.input-group-sm > .input-group-btn > .btn,
select[multiple].input-group-sm > .form-control,
select[multiple].input-group-sm > .input-group-addon,
select[multiple].input-group-sm > .input-group-btn > .btn {
  height: auto;
}
.input-group-addon,
.input-group-btn,
.input-group .form-control {
  display: table-cell;
}
.input-group-addon:not(:first-child):not(:last-child),
.input-group-btn:not(:first-child):not(:last-child),
.input-group .form-control:not(:first-child):not(:last-child) {
  border-radius: 0;
}
.input-group-addon,
.input-group-btn {
  width: 1%;
  white-space: nowrap;
  vertical-align: middle;
}
.input-group-addon {
  padding: 6px 12px;
  font-size: 13px;
  font-weight: normal;
  line-height: 1;
  color: #555555;
  text-align: center;
  background-color: #eeeeee;
  border: 1px solid #ccc;
  border-radius: 2px;
}
.input-group-addon.input-sm {
  padding: 5px 10px;
  font-size: 12px;
  border-radius: 1px;
}
.input-group-addon.input-lg {
  padding: 10px 16px;
  font-size: 17px;
  border-radius: 3px;
}
.input-group-addon input[type="radio"],
.input-group-addon input[type="checkbox"] {
  margin-top: 0;
}
.input-group .form-control:first-child,
.input-group-addon:first-child,
.input-group-btn:first-child > .btn,
.input-group-btn:first-child > .btn-group > .btn,
.input-group-btn:first-child > .dropdown-toggle,
.input-group-btn:last-child > .btn:not(:last-child):not(.dropdown-toggle),
.input-group-btn:last-child > .btn-group:not(:last-child) > .btn {
  border-bottom-right-radius: 0;
  border-top-right-radius: 0;
}
.input-group-addon:first-child {
  border-right: 0;
}
.input-group .form-control:last-child,
.input-group-addon:last-child,
.input-group-btn:last-child > .btn,
.input-group-btn:last-child > .btn-group > .btn,
.input-group-btn:last-child > .dropdown-toggle,
.input-group-btn:first-child > .btn:not(:first-child),
.input-group-btn:first-child > .btn-group:not(:first-child) > .btn {
  border-bottom-left-radius: 0;
  border-top-left-radius: 0;
}
.input-group-addon:last-child {
  border-left: 0;
}
.input-group-btn {
  position: relative;
  font-size: 0;
  white-space: nowrap;
}
.input-group-btn > .btn {
  position: relative;
}
.input-group-btn > .btn + .btn {
  margin-left: -1px;
}
.input-group-btn > .btn:hover,
.input-group-btn > .btn:focus,
.input-group-btn > .btn:active {
  z-index: 2;
}
.input-group-btn:first-child > .btn,
.input-group-btn:first-child > .btn-group {
  margin-right: -1px;
}
.input-group-btn:last-child > .btn,
.input-group-btn:last-child > .btn-group {
  z-index: 2;
  margin-left: -1px;
}
.nav {
  margin-bottom: 0;
  padding-left: 0;
  list-style: none;
}
.nav > li {
  position: relative;
  display: block;
}
.nav > li > a {
  position: relative;
  display: block;
  padding: 10px 15px;
}
.nav > li > a:hover,
.nav > li > a:focus {
  text-decoration: none;
  background-color: #eeeeee;
}
.nav > li.disabled > a {
  color: #777777;
}
.nav > li.disabled > a:hover,
.nav > li.disabled > a:focus {
  color: #777777;
  text-decoration: none;
  background-color: transparent;
  cursor: not-allowed;
}
.nav .open > a,
.nav .open > a:hover,
.nav .open > a:focus {
  background-color: #eeeeee;
  border-color: #337ab7;
}
.nav .nav-divider {
  height: 1px;
  margin: 8px 0;
  overflow: hidden;
  background-color: #e5e5e5;
}
.nav > li > a > img {
  max-width: none;
}
.nav-tabs {
  border-bottom: 1px solid #ddd;
}
.nav-tabs > li {
  float: left;
  margin-bottom: -1px;
}
.nav-tabs > li > a {
  margin-right: 2px;
  line-height: 1.42857143;
  border: 1px solid transparent;
  border-radius: 2px 2px 0 0;
}
.nav-tabs > li > a:hover {
  border-color: #eeeeee #eeeeee #ddd;
}
.nav-tabs > li.active > a,
.nav-tabs > li.active > a:hover,
.nav-tabs > li.active > a:focus {
  color: #555555;
  background-color: #fff;
  border: 1px solid #ddd;
  border-bottom-color: transparent;
  cursor: default;
}
.nav-tabs.nav-justified {
  width: 100%;
  border-bottom: 0;
}
.nav-tabs.nav-justified > li {
  float: none;
}
.nav-tabs.nav-justified > li > a {
  text-align: center;
  margin-bottom: 5px;
}
.nav-tabs.nav-justified > .dropdown .dropdown-menu {
  top: auto;
  left: auto;
}
@media (min-width: 768px) {
  .nav-tabs.nav-justified > li {
    display: table-cell;
    width: 1%;
  }
  .nav-tabs.nav-justified > li > a {
    margin-bottom: 0;
  }
}
.nav-tabs.nav-justified > li > a {
  margin-right: 0;
  border-radius: 2px;
}
.nav-tabs.nav-justified > .active > a,
.nav-tabs.nav-justified > .active > a:hover,
.nav-tabs.nav-justified > .active > a:focus {
  border: 1px solid #ddd;
}
@media (min-width: 768px) {
  .nav-tabs.nav-justified > li > a {
    border-bottom: 1px solid #ddd;
    border-radius: 2px 2px 0 0;
  }
  .nav-tabs.nav-justified > .active > a,
  .nav-tabs.nav-justified > .active > a:hover,
  .nav-tabs.nav-justified > .active > a:focus {
    border-bottom-color: #fff;
  }
}
.nav-pills > li {
  float: left;
}
.nav-pills > li > a {
  border-radius: 2px;
}
.nav-pills > li + li {
  margin-left: 2px;
}
.nav-pills > li.active > a,
.nav-pills > li.active > a:hover,
.nav-pills > li.active > a:focus {
  color: #fff;
  background-color: #337ab7;
}
.nav-stacked > li {
  float: none;
}
.nav-stacked > li + li {
  margin-top: 2px;
  margin-left: 0;
}
.nav-justified {
  width: 100%;
}
.nav-justified > li {
  float: none;
}
.nav-justified > li > a {
  text-align: center;
  margin-bottom: 5px;
}
.nav-justified > .dropdown .dropdown-menu {
  top: auto;
  left: auto;
}
@media (min-width: 768px) {
  .nav-justified > li {
    display: table-cell;
    width: 1%;
  }
  .nav-justified > li > a {
    margin-bottom: 0;
  }
}
.nav-tabs-justified {
  border-bottom: 0;
}
.nav-tabs-justified > li > a {
  margin-right: 0;
  border-radius: 2px;
}
.nav-tabs-justified > .active > a,
.nav-tabs-justified > .active > a:hover,
.nav-tabs-justified > .active > a:focus {
  border: 1px solid #ddd;
}
@media (min-width: 768px) {
  .nav-tabs-justified > li > a {
    border-bottom: 1px solid #ddd;
    border-radius: 2px 2px 0 0;
  }
  .nav-tabs-justified > .active > a,
  .nav-tabs-justified > .active > a:hover,
  .nav-tabs-justified > .active > a:focus {
    border-bottom-color: #fff;
  }
}
.tab-content > .tab-pane {
  display: none;
}
.tab-content > .active {
  display: block;
}
.nav-tabs .dropdown-menu {
  margin-top: -1px;
  border-top-right-radius: 0;
  border-top-left-radius: 0;
}
.navbar {
  position: relative;
  min-height: 30px;
  margin-bottom: 18px;
  border: 1px solid transparent;
}
@media (min-width: 541px) {
  .navbar {
    border-radius: 2px;
  }
}
@media (min-width: 541px) {
  .navbar-header {
    float: left;
  }
}
.navbar-collapse {
  overflow-x: visible;
  padding-right: 0px;
  padding-left: 0px;
  border-top: 1px solid transparent;
  box-shadow: inset 0 1px 0 rgba(255, 255, 255, 0.1);
  -webkit-overflow-scrolling: touch;
}
.navbar-collapse.in {
  overflow-y: auto;
}
@media (min-width: 541px) {
  .navbar-collapse {
    width: auto;
    border-top: 0;
    box-shadow: none;
  }
  .navbar-collapse.collapse {
    display: block !important;
    height: auto !important;
    padding-bottom: 0;
    overflow: visible !important;
  }
  .navbar-collapse.in {
    overflow-y: visible;
  }
  .navbar-fixed-top .navbar-collapse,
  .navbar-static-top .navbar-collapse,
  .navbar-fixed-bottom .navbar-collapse {
    padding-left: 0;
    padding-right: 0;
  }
}
.navbar-fixed-top .navbar-collapse,
.navbar-fixed-bottom .navbar-collapse {
  max-height: 340px;
}
@media (max-device-width: 540px) and (orientation: landscape) {
  .navbar-fixed-top .navbar-collapse,
  .navbar-fixed-bottom .navbar-collapse {
    max-height: 200px;
  }
}
.container > .navbar-header,
.container-fluid > .navbar-header,
.container > .navbar-collapse,
.container-fluid > .navbar-collapse {
  margin-right: 0px;
  margin-left: 0px;
}
@media (min-width: 541px) {
  .container > .navbar-header,
  .container-fluid > .navbar-header,
  .container > .navbar-collapse,
  .container-fluid > .navbar-collapse {
    margin-right: 0;
    margin-left: 0;
  }
}
.navbar-static-top {
  z-index: 1000;
  border-width: 0 0 1px;
}
@media (min-width: 541px) {
  .navbar-static-top {
    border-radius: 0;
  }
}
.navbar-fixed-top,
.navbar-fixed-bottom {
  position: fixed;
  right: 0;
  left: 0;
  z-index: 1030;
}
@media (min-width: 541px) {
  .navbar-fixed-top,
  .navbar-fixed-bottom {
    border-radius: 0;
  }
}
.navbar-fixed-top {
  top: 0;
  border-width: 0 0 1px;
}
.navbar-fixed-bottom {
  bottom: 0;
  margin-bottom: 0;
  border-width: 1px 0 0;
}
.navbar-brand {
  float: left;
  padding: 6px 0px;
  font-size: 17px;
  line-height: 18px;
  height: 30px;
}
.navbar-brand:hover,
.navbar-brand:focus {
  text-decoration: none;
}
.navbar-brand > img {
  display: block;
}
@media (min-width: 541px) {
  .navbar > .container .navbar-brand,
  .navbar > .container-fluid .navbar-brand {
    margin-left: 0px;
  }
}
.navbar-toggle {
  position: relative;
  float: right;
  margin-right: 0px;
  padding: 9px 10px;
  margin-top: -2px;
  margin-bottom: -2px;
  background-color: transparent;
  background-image: none;
  border: 1px solid transparent;
  border-radius: 2px;
}
.navbar-toggle:focus {
  outline: 0;
}
.navbar-toggle .icon-bar {
  display: block;
  width: 22px;
  height: 2px;
  border-radius: 1px;
}
.navbar-toggle .icon-bar + .icon-bar {
  margin-top: 4px;
}
@media (min-width: 541px) {
  .navbar-toggle {
    display: none;
  }
}
.navbar-nav {
  margin: 3px 0px;
}
.navbar-nav > li > a {
  padding-top: 10px;
  padding-bottom: 10px;
  line-height: 18px;
}
@media (max-width: 540px) {
  .navbar-nav .open .dropdown-menu {
    position: static;
    float: none;
    width: auto;
    margin-top: 0;
    background-color: transparent;
    border: 0;
    box-shadow: none;
  }
  .navbar-nav .open .dropdown-menu > li > a,
  .navbar-nav .open .dropdown-menu .dropdown-header {
    padding: 5px 15px 5px 25px;
  }
  .navbar-nav .open .dropdown-menu > li > a {
    line-height: 18px;
  }
  .navbar-nav .open .dropdown-menu > li > a:hover,
  .navbar-nav .open .dropdown-menu > li > a:focus {
    background-image: none;
  }
}
@media (min-width: 541px) {
  .navbar-nav {
    float: left;
    margin: 0;
  }
  .navbar-nav > li {
    float: left;
  }
  .navbar-nav > li > a {
    padding-top: 6px;
    padding-bottom: 6px;
  }
}
.navbar-form {
  margin-left: 0px;
  margin-right: 0px;
  padding: 10px 0px;
  border-top: 1px solid transparent;
  border-bottom: 1px solid transparent;
  -webkit-box-shadow: inset 0 1px 0 rgba(255, 255, 255, 0.1), 0 1px 0 rgba(255, 255, 255, 0.1);
  box-shadow: inset 0 1px 0 rgba(255, 255, 255, 0.1), 0 1px 0 rgba(255, 255, 255, 0.1);
  margin-top: -1px;
  margin-bottom: -1px;
}
@media (min-width: 768px) {
  .navbar-form .form-group {
    display: inline-block;
    margin-bottom: 0;
    vertical-align: middle;
  }
  .navbar-form .form-control {
    display: inline-block;
    width: auto;
    vertical-align: middle;
  }
  .navbar-form .form-control-static {
    display: inline-block;
  }
  .navbar-form .input-group {
    display: inline-table;
    vertical-align: middle;
  }
  .navbar-form .input-group .input-group-addon,
  .navbar-form .input-group .input-group-btn,
  .navbar-form .input-group .form-control {
    width: auto;
  }
  .navbar-form .input-group > .form-control {
    width: 100%;
  }
  .navbar-form .control-label {
    margin-bottom: 0;
    vertical-align: middle;
  }
  .navbar-form .radio,
  .navbar-form .checkbox {
    display: inline-block;
    margin-top: 0;
    margin-bottom: 0;
    vertical-align: middle;
  }
  .navbar-form .radio label,
  .navbar-form .checkbox label {
    padding-left: 0;
  }
  .navbar-form .radio input[type="radio"],
  .navbar-form .checkbox input[type="checkbox"] {
    position: relative;
    margin-left: 0;
  }
  .navbar-form .has-feedback .form-control-feedback {
    top: 0;
  }
}
@media (max-width: 540px) {
  .navbar-form .form-group {
    margin-bottom: 5px;
  }
  .navbar-form .form-group:last-child {
    margin-bottom: 0;
  }
}
@media (min-width: 541px) {
  .navbar-form {
    width: auto;
    border: 0;
    margin-left: 0;
    margin-right: 0;
    padding-top: 0;
    padding-bottom: 0;
    -webkit-box-shadow: none;
    box-shadow: none;
  }
}
.navbar-nav > li > .dropdown-menu {
  margin-top: 0;
  border-top-right-radius: 0;
  border-top-left-radius: 0;
}
.navbar-fixed-bottom .navbar-nav > li > .dropdown-menu {
  margin-bottom: 0;
  border-top-right-radius: 2px;
  border-top-left-radius: 2px;
  border-bottom-right-radius: 0;
  border-bottom-left-radius: 0;
}
.navbar-btn {
  margin-top: -1px;
  margin-bottom: -1px;
}
.navbar-btn.btn-sm {
  margin-top: 0px;
  margin-bottom: 0px;
}
.navbar-btn.btn-xs {
  margin-top: 4px;
  margin-bottom: 4px;
}
.navbar-text {
  margin-top: 6px;
  margin-bottom: 6px;
}
@media (min-width: 541px) {
  .navbar-text {
    float: left;
    margin-left: 0px;
    margin-right: 0px;
  }
}
@media (min-width: 541px) {
  .navbar-left {
    float: left !important;
    float: left;
  }
  .navbar-right {
    float: right !important;
    float: right;
    margin-right: 0px;
  }
  .navbar-right ~ .navbar-right {
    margin-right: 0;
  }
}
.navbar-default {
  background-color: #f8f8f8;
  border-color: #e7e7e7;
}
.navbar-default .navbar-brand {
  color: #777;
}
.navbar-default .navbar-brand:hover,
.navbar-default .navbar-brand:focus {
  color: #5e5e5e;
  background-color: transparent;
}
.navbar-default .navbar-text {
  color: #777;
}
.navbar-default .navbar-nav > li > a {
  color: #777;
}
.navbar-default .navbar-nav > li > a:hover,
.navbar-default .navbar-nav > li > a:focus {
  color: #333;
  background-color: transparent;
}
.navbar-default .navbar-nav > .active > a,
.navbar-default .navbar-nav > .active > a:hover,
.navbar-default .navbar-nav > .active > a:focus {
  color: #555;
  background-color: #e7e7e7;
}
.navbar-default .navbar-nav > .disabled > a,
.navbar-default .navbar-nav > .disabled > a:hover,
.navbar-default .navbar-nav > .disabled > a:focus {
  color: #ccc;
  background-color: transparent;
}
.navbar-default .navbar-toggle {
  border-color: #ddd;
}
.navbar-default .navbar-toggle:hover,
.navbar-default .navbar-toggle:focus {
  background-color: #ddd;
}
.navbar-default .navbar-toggle .icon-bar {
  background-color: #888;
}
.navbar-default .navbar-collapse,
.navbar-default .navbar-form {
  border-color: #e7e7e7;
}
.navbar-default .navbar-nav > .open > a,
.navbar-default .navbar-nav > .open > a:hover,
.navbar-default .navbar-nav > .open > a:focus {
  background-color: #e7e7e7;
  color: #555;
}
@media (max-width: 540px) {
  .navbar-default .navbar-nav .open .dropdown-menu > li > a {
    color: #777;
  }
  .navbar-default .navbar-nav .open .dropdown-menu > li > a:hover,
  .navbar-default .navbar-nav .open .dropdown-menu > li > a:focus {
    color: #333;
    background-color: transparent;
  }
  .navbar-default .navbar-nav .open .dropdown-menu > .active > a,
  .navbar-default .navbar-nav .open .dropdown-menu > .active > a:hover,
  .navbar-default .navbar-nav .open .dropdown-menu > .active > a:focus {
    color: #555;
    background-color: #e7e7e7;
  }
  .navbar-default .navbar-nav .open .dropdown-menu > .disabled > a,
  .navbar-default .navbar-nav .open .dropdown-menu > .disabled > a:hover,
  .navbar-default .navbar-nav .open .dropdown-menu > .disabled > a:focus {
    color: #ccc;
    background-color: transparent;
  }
}
.navbar-default .navbar-link {
  color: #777;
}
.navbar-default .navbar-link:hover {
  color: #333;
}
.navbar-default .btn-link {
  color: #777;
}
.navbar-default .btn-link:hover,
.navbar-default .btn-link:focus {
  color: #333;
}
.navbar-default .btn-link[disabled]:hover,
fieldset[disabled] .navbar-default .btn-link:hover,
.navbar-default .btn-link[disabled]:focus,
fieldset[disabled] .navbar-default .btn-link:focus {
  color: #ccc;
}
.navbar-inverse {
  background-color: #222;
  border-color: #080808;
}
.navbar-inverse .navbar-brand {
  color: #9d9d9d;
}
.navbar-inverse .navbar-brand:hover,
.navbar-inverse .navbar-brand:focus {
  color: #fff;
  background-color: transparent;
}
.navbar-inverse .navbar-text {
  color: #9d9d9d;
}
.navbar-inverse .navbar-nav > li > a {
  color: #9d9d9d;
}
.navbar-inverse .navbar-nav > li > a:hover,
.navbar-inverse .navbar-nav > li > a:focus {
  color: #fff;
  background-color: transparent;
}
.navbar-inverse .navbar-nav > .active > a,
.navbar-inverse .navbar-nav > .active > a:hover,
.navbar-inverse .navbar-nav > .active > a:focus {
  color: #fff;
  background-color: #080808;
}
.navbar-inverse .navbar-nav > .disabled > a,
.navbar-inverse .navbar-nav > .disabled > a:hover,
.navbar-inverse .navbar-nav > .disabled > a:focus {
  color: #444;
  background-color: transparent;
}
.navbar-inverse .navbar-toggle {
  border-color: #333;
}
.navbar-inverse .navbar-toggle:hover,
.navbar-inverse .navbar-toggle:focus {
  background-color: #333;
}
.navbar-inverse .navbar-toggle .icon-bar {
  background-color: #fff;
}
.navbar-inverse .navbar-collapse,
.navbar-inverse .navbar-form {
  border-color: #101010;
}
.navbar-inverse .navbar-nav > .open > a,
.navbar-inverse .navbar-nav > .open > a:hover,
.navbar-inverse .navbar-nav > .open > a:focus {
  background-color: #080808;
  color: #fff;
}
@media (max-width: 540px) {
  .navbar-inverse .navbar-nav .open .dropdown-menu > .dropdown-header {
    border-color: #080808;
  }
  .navbar-inverse .navbar-nav .open .dropdown-menu .divider {
    background-color: #080808;
  }
  .navbar-inverse .navbar-nav .open .dropdown-menu > li > a {
    color: #9d9d9d;
  }
  .navbar-inverse .navbar-nav .open .dropdown-menu > li > a:hover,
  .navbar-inverse .navbar-nav .open .dropdown-menu > li > a:focus {
    color: #fff;
    background-color: transparent;
  }
  .navbar-inverse .navbar-nav .open .dropdown-menu > .active > a,
  .navbar-inverse .navbar-nav .open .dropdown-menu > .active > a:hover,
  .navbar-inverse .navbar-nav .open .dropdown-menu > .active > a:focus {
    color: #fff;
    background-color: #080808;
  }
  .navbar-inverse .navbar-nav .open .dropdown-menu > .disabled > a,
  .navbar-inverse .navbar-nav .open .dropdown-menu > .disabled > a:hover,
  .navbar-inverse .navbar-nav .open .dropdown-menu > .disabled > a:focus {
    color: #444;
    background-color: transparent;
  }
}
.navbar-inverse .navbar-link {
  color: #9d9d9d;
}
.navbar-inverse .navbar-link:hover {
  color: #fff;
}
.navbar-inverse .btn-link {
  color: #9d9d9d;
}
.navbar-inverse .btn-link:hover,
.navbar-inverse .btn-link:focus {
  color: #fff;
}
.navbar-inverse .btn-link[disabled]:hover,
fieldset[disabled] .navbar-inverse .btn-link:hover,
.navbar-inverse .btn-link[disabled]:focus,
fieldset[disabled] .navbar-inverse .btn-link:focus {
  color: #444;
}
.breadcrumb {
  padding: 8px 15px;
  margin-bottom: 18px;
  list-style: none;
  background-color: #f5f5f5;
  border-radius: 2px;
}
.breadcrumb > li {
  display: inline-block;
}
.breadcrumb > li + li:before {
  content: "/\00a0";
  padding: 0 5px;
  color: #5e5e5e;
}
.breadcrumb > .active {
  color: #777777;
}
.pagination {
  display: inline-block;
  padding-left: 0;
  margin: 18px 0;
  border-radius: 2px;
}
.pagination > li {
  display: inline;
}
.pagination > li > a,
.pagination > li > span {
  position: relative;
  float: left;
  padding: 6px 12px;
  line-height: 1.42857143;
  text-decoration: none;
  color: #337ab7;
  background-color: #fff;
  border: 1px solid #ddd;
  margin-left: -1px;
}
.pagination > li:first-child > a,
.pagination > li:first-child > span {
  margin-left: 0;
  border-bottom-left-radius: 2px;
  border-top-left-radius: 2px;
}
.pagination > li:last-child > a,
.pagination > li:last-child > span {
  border-bottom-right-radius: 2px;
  border-top-right-radius: 2px;
}
.pagination > li > a:hover,
.pagination > li > span:hover,
.pagination > li > a:focus,
.pagination > li > span:focus {
  z-index: 2;
  color: #23527c;
  background-color: #eeeeee;
  border-color: #ddd;
}
.pagination > .active > a,
.pagination > .active > span,
.pagination > .active > a:hover,
.pagination > .active > span:hover,
.pagination > .active > a:focus,
.pagination > .active > span:focus {
  z-index: 3;
  color: #fff;
  background-color: #337ab7;
  border-color: #337ab7;
  cursor: default;
}
.pagination > .disabled > span,
.pagination > .disabled > span:hover,
.pagination > .disabled > span:focus,
.pagination > .disabled > a,
.pagination > .disabled > a:hover,
.pagination > .disabled > a:focus {
  color: #777777;
  background-color: #fff;
  border-color: #ddd;
  cursor: not-allowed;
}
.pagination-lg > li > a,
.pagination-lg > li > span {
  padding: 10px 16px;
  font-size: 17px;
  line-height: 1.3333333;
}
.pagination-lg > li:first-child > a,
.pagination-lg > li:first-child > span {
  border-bottom-left-radius: 3px;
  border-top-left-radius: 3px;
}
.pagination-lg > li:last-child > a,
.pagination-lg > li:last-child > span {
  border-bottom-right-radius: 3px;
  border-top-right-radius: 3px;
}
.pagination-sm > li > a,
.pagination-sm > li > span {
  padding: 5px 10px;
  font-size: 12px;
  line-height: 1.5;
}
.pagination-sm > li:first-child > a,
.pagination-sm > li:first-child > span {
  border-bottom-left-radius: 1px;
  border-top-left-radius: 1px;
}
.pagination-sm > li:last-child > a,
.pagination-sm > li:last-child > span {
  border-bottom-right-radius: 1px;
  border-top-right-radius: 1px;
}
.pager {
  padding-left: 0;
  margin: 18px 0;
  list-style: none;
  text-align: center;
}
.pager li {
  display: inline;
}
.pager li > a,
.pager li > span {
  display: inline-block;
  padding: 5px 14px;
  background-color: #fff;
  border: 1px solid #ddd;
  border-radius: 15px;
}
.pager li > a:hover,
.pager li > a:focus {
  text-decoration: none;
  background-color: #eeeeee;
}
.pager .next > a,
.pager .next > span {
  float: right;
}
.pager .previous > a,
.pager .previous > span {
  float: left;
}
.pager .disabled > a,
.pager .disabled > a:hover,
.pager .disabled > a:focus,
.pager .disabled > span {
  color: #777777;
  background-color: #fff;
  cursor: not-allowed;
}
.label {
  display: inline;
  padding: .2em .6em .3em;
  font-size: 75%;
  font-weight: bold;
  line-height: 1;
  color: #fff;
  text-align: center;
  white-space: nowrap;
  vertical-align: baseline;
  border-radius: .25em;
}
a.label:hover,
a.label:focus {
  color: #fff;
  text-decoration: none;
  cursor: pointer;
}
.label:empty {
  display: none;
}
.btn .label {
  position: relative;
  top: -1px;
}
.label-default {
  background-color: #777777;
}
.label-default[href]:hover,
.label-default[href]:focus {
  background-color: #5e5e5e;
}
.label-primary {
  background-color: #337ab7;
}
.label-primary[href]:hover,
.label-primary[href]:focus {
  background-color: #286090;
}
.label-success {
  background-color: #5cb85c;
}
.label-success[href]:hover,
.label-success[href]:focus {
  background-color: #449d44;
}
.label-info {
  background-color: #5bc0de;
}
.label-info[href]:hover,
.label-info[href]:focus {
  background-color: #31b0d5;
}
.label-warning {
  background-color: #f0ad4e;
}
.label-warning[href]:hover,
.label-warning[href]:focus {
  background-color: #ec971f;
}
.label-danger {
  background-color: #d9534f;
}
.label-danger[href]:hover,
.label-danger[href]:focus {
  background-color: #c9302c;
}
.badge {
  display: inline-block;
  min-width: 10px;
  padding: 3px 7px;
  font-size: 12px;
  font-weight: bold;
  color: #fff;
  line-height: 1;
  vertical-align: middle;
  white-space: nowrap;
  text-align: center;
  background-color: #777777;
  border-radius: 10px;
}
.badge:empty {
  display: none;
}
.btn .badge {
  position: relative;
  top: -1px;
}
.btn-xs .badge,
.btn-group-xs > .btn .badge {
  top: 0;
  padding: 1px 5px;
}
a.badge:hover,
a.badge:focus {
  color: #fff;
  text-decoration: none;
  cursor: pointer;
}
.list-group-item.active > .badge,
.nav-pills > .active > a > .badge {
  color: #337ab7;
  background-color: #fff;
}
.list-group-item > .badge {
  float: right;
}
.list-group-item > .badge + .badge {
  margin-right: 5px;
}
.nav-pills > li > a > .badge {
  margin-left: 3px;
}
.jumbotron {
  padding-top: 30px;
  padding-bottom: 30px;
  margin-bottom: 30px;
  color: inherit;
  background-color: #eeeeee;
}
.jumbotron h1,
.jumbotron .h1 {
  color: inherit;
}
.jumbotron p {
  margin-bottom: 15px;
  font-size: 20px;
  font-weight: 200;
}
.jumbotron > hr {
  border-top-color: #d5d5d5;
}
.container .jumbotron,
.container-fluid .jumbotron {
  border-radius: 3px;
  padding-left: 0px;
  padding-right: 0px;
}
.jumbotron .container {
  max-width: 100%;
}
@media screen and (min-width: 768px) {
  .jumbotron {
    padding-top: 48px;
    padding-bottom: 48px;
  }
  .container .jumbotron,
  .container-fluid .jumbotron {
    padding-left: 60px;
    padding-right: 60px;
  }
  .jumbotron h1,
  .jumbotron .h1 {
    font-size: 59px;
  }
}
.thumbnail {
  display: block;
  padding: 4px;
  margin-bottom: 18px;
  line-height: 1.42857143;
  background-color: #fff;
  border: 1px solid #ddd;
  border-radius: 2px;
  -webkit-transition: border 0.2s ease-in-out;
  -o-transition: border 0.2s ease-in-out;
  transition: border 0.2s ease-in-out;
}
.thumbnail > img,
.thumbnail a > img {
  margin-left: auto;
  margin-right: auto;
}
a.thumbnail:hover,
a.thumbnail:focus,
a.thumbnail.active {
  border-color: #337ab7;
}
.thumbnail .caption {
  padding: 9px;
  color: #000;
}
.alert {
  padding: 15px;
  margin-bottom: 18px;
  border: 1px solid transparent;
  border-radius: 2px;
}
.alert h4 {
  margin-top: 0;
  color: inherit;
}
.alert .alert-link {
  font-weight: bold;
}
.alert > p,
.alert > ul {
  margin-bottom: 0;
}
.alert > p + p {
  margin-top: 5px;
}
.alert-dismissable,
.alert-dismissible {
  padding-right: 35px;
}
.alert-dismissable .close,
.alert-dismissible .close {
  position: relative;
  top: -2px;
  right: -21px;
  color: inherit;
}
.alert-success {
  background-color: #dff0d8;
  border-color: #d6e9c6;
  color: #3c763d;
}
.alert-success hr {
  border-top-color: #c9e2b3;
}
.alert-success .alert-link {
  color: #2b542c;
}
.alert-info {
  background-color: #d9edf7;
  border-color: #bce8f1;
  color: #31708f;
}
.alert-info hr {
  border-top-color: #a6e1ec;
}
.alert-info .alert-link {
  color: #245269;
}
.alert-warning {
  background-color: #fcf8e3;
  border-color: #faebcc;
  color: #8a6d3b;
}
.alert-warning hr {
  border-top-color: #f7e1b5;
}
.alert-warning .alert-link {
  color: #66512c;
}
.alert-danger {
  background-color: #f2dede;
  border-color: #ebccd1;
  color: #a94442;
}
.alert-danger hr {
  border-top-color: #e4b9c0;
}
.alert-danger .alert-link {
  color: #843534;
}
@-webkit-keyframes progress-bar-stripes {
  from {
    background-position: 40px 0;
  }
  to {
    background-position: 0 0;
  }
}
@keyframes progress-bar-stripes {
  from {
    background-position: 40px 0;
  }
  to {
    background-position: 0 0;
  }
}
.progress {
  overflow: hidden;
  height: 18px;
  margin-bottom: 18px;
  background-color: #f5f5f5;
  border-radius: 2px;
  -webkit-box-shadow: inset 0 1px 2px rgba(0, 0, 0, 0.1);
  box-shadow: inset 0 1px 2px rgba(0, 0, 0, 0.1);
}
.progress-bar {
  float: left;
  width: 0%;
  height: 100%;
  font-size: 12px;
  line-height: 18px;
  color: #fff;
  text-align: center;
  background-color: #337ab7;
  -webkit-box-shadow: inset 0 -1px 0 rgba(0, 0, 0, 0.15);
  box-shadow: inset 0 -1px 0 rgba(0, 0, 0, 0.15);
  -webkit-transition: width 0.6s ease;
  -o-transition: width 0.6s ease;
  transition: width 0.6s ease;
}
.progress-striped .progress-bar,
.progress-bar-striped {
  background-image: -webkit-linear-gradient(45deg, rgba(255, 255, 255, 0.15) 25%, transparent 25%, transparent 50%, rgba(255, 255, 255, 0.15) 50%, rgba(255, 255, 255, 0.15) 75%, transparent 75%, transparent);
  background-image: -o-linear-gradient(45deg, rgba(255, 255, 255, 0.15) 25%, transparent 25%, transparent 50%, rgba(255, 255, 255, 0.15) 50%, rgba(255, 255, 255, 0.15) 75%, transparent 75%, transparent);
  background-image: linear-gradient(45deg, rgba(255, 255, 255, 0.15) 25%, transparent 25%, transparent 50%, rgba(255, 255, 255, 0.15) 50%, rgba(255, 255, 255, 0.15) 75%, transparent 75%, transparent);
  background-size: 40px 40px;
}
.progress.active .progress-bar,
.progress-bar.active {
  -webkit-animation: progress-bar-stripes 2s linear infinite;
  -o-animation: progress-bar-stripes 2s linear infinite;
  animation: progress-bar-stripes 2s linear infinite;
}
.progress-bar-success {
  background-color: #5cb85c;
}
.progress-striped .progress-bar-success {
  background-image: -webkit-linear-gradient(45deg, rgba(255, 255, 255, 0.15) 25%, transparent 25%, transparent 50%, rgba(255, 255, 255, 0.15) 50%, rgba(255, 255, 255, 0.15) 75%, transparent 75%, transparent);
  background-image: -o-linear-gradient(45deg, rgba(255, 255, 255, 0.15) 25%, transparent 25%, transparent 50%, rgba(255, 255, 255, 0.15) 50%, rgba(255, 255, 255, 0.15) 75%, transparent 75%, transparent);
  background-image: linear-gradient(45deg, rgba(255, 255, 255, 0.15) 25%, transparent 25%, transparent 50%, rgba(255, 255, 255, 0.15) 50%, rgba(255, 255, 255, 0.15) 75%, transparent 75%, transparent);
}
.progress-bar-info {
  background-color: #5bc0de;
}
.progress-striped .progress-bar-info {
  background-image: -webkit-linear-gradient(45deg, rgba(255, 255, 255, 0.15) 25%, transparent 25%, transparent 50%, rgba(255, 255, 255, 0.15) 50%, rgba(255, 255, 255, 0.15) 75%, transparent 75%, transparent);
  background-image: -o-linear-gradient(45deg, rgba(255, 255, 255, 0.15) 25%, transparent 25%, transparent 50%, rgba(255, 255, 255, 0.15) 50%, rgba(255, 255, 255, 0.15) 75%, transparent 75%, transparent);
  background-image: linear-gradient(45deg, rgba(255, 255, 255, 0.15) 25%, transparent 25%, transparent 50%, rgba(255, 255, 255, 0.15) 50%, rgba(255, 255, 255, 0.15) 75%, transparent 75%, transparent);
}
.progress-bar-warning {
  background-color: #f0ad4e;
}
.progress-striped .progress-bar-warning {
  background-image: -webkit-linear-gradient(45deg, rgba(255, 255, 255, 0.15) 25%, transparent 25%, transparent 50%, rgba(255, 255, 255, 0.15) 50%, rgba(255, 255, 255, 0.15) 75%, transparent 75%, transparent);
  background-image: -o-linear-gradient(45deg, rgba(255, 255, 255, 0.15) 25%, transparent 25%, transparent 50%, rgba(255, 255, 255, 0.15) 50%, rgba(255, 255, 255, 0.15) 75%, transparent 75%, transparent);
  background-image: linear-gradient(45deg, rgba(255, 255, 255, 0.15) 25%, transparent 25%, transparent 50%, rgba(255, 255, 255, 0.15) 50%, rgba(255, 255, 255, 0.15) 75%, transparent 75%, transparent);
}
.progress-bar-danger {
  background-color: #d9534f;
}
.progress-striped .progress-bar-danger {
  background-image: -webkit-linear-gradient(45deg, rgba(255, 255, 255, 0.15) 25%, transparent 25%, transparent 50%, rgba(255, 255, 255, 0.15) 50%, rgba(255, 255, 255, 0.15) 75%, transparent 75%, transparent);
  background-image: -o-linear-gradient(45deg, rgba(255, 255, 255, 0.15) 25%, transparent 25%, transparent 50%, rgba(255, 255, 255, 0.15) 50%, rgba(255, 255, 255, 0.15) 75%, transparent 75%, transparent);
  background-image: linear-gradient(45deg, rgba(255, 255, 255, 0.15) 25%, transparent 25%, transparent 50%, rgba(255, 255, 255, 0.15) 50%, rgba(255, 255, 255, 0.15) 75%, transparent 75%, transparent);
}
.media {
  margin-top: 15px;
}
.media:first-child {
  margin-top: 0;
}
.media,
.media-body {
  zoom: 1;
  overflow: hidden;
}
.media-body {
  width: 10000px;
}
.media-object {
  display: block;
}
.media-object.img-thumbnail {
  max-width: none;
}
.media-right,
.media > .pull-right {
  padding-left: 10px;
}
.media-left,
.media > .pull-left {
  padding-right: 10px;
}
.media-left,
.media-right,
.media-body {
  display: table-cell;
  vertical-align: top;
}
.media-middle {
  vertical-align: middle;
}
.media-bottom {
  vertical-align: bottom;
}
.media-heading {
  margin-top: 0;
  margin-bottom: 5px;
}
.media-list {
  padding-left: 0;
  list-style: none;
}
.list-group {
  margin-bottom: 20px;
  padding-left: 0;
}
.list-group-item {
  position: relative;
  display: block;
  padding: 10px 15px;
  margin-bottom: -1px;
  background-color: #fff;
  border: 1px solid #ddd;
}
.list-group-item:first-child {
  border-top-right-radius: 2px;
  border-top-left-radius: 2px;
}
.list-group-item:last-child {
  margin-bottom: 0;
  border-bottom-right-radius: 2px;
  border-bottom-left-radius: 2px;
}
a.list-group-item,
button.list-group-item {
  color: #555;
}
a.list-group-item .list-group-item-heading,
button.list-group-item .list-group-item-heading {
  color: #333;
}
a.list-group-item:hover,
button.list-group-item:hover,
a.list-group-item:focus,
button.list-group-item:focus {
  text-decoration: none;
  color: #555;
  background-color: #f5f5f5;
}
button.list-group-item {
  width: 100%;
  text-align: left;
}
.list-group-item.disabled,
.list-group-item.disabled:hover,
.list-group-item.disabled:focus {
  background-color: #eeeeee;
  color: #777777;
  cursor: not-allowed;
}
.list-group-item.disabled .list-group-item-heading,
.list-group-item.disabled:hover .list-group-item-heading,
.list-group-item.disabled:focus .list-group-item-heading {
  color: inherit;
}
.list-group-item.disabled .list-group-item-text,
.list-group-item.disabled:hover .list-group-item-text,
.list-group-item.disabled:focus .list-group-item-text {
  color: #777777;
}
.list-group-item.active,
.list-group-item.active:hover,
.list-group-item.active:focus {
  z-index: 2;
  color: #fff;
  background-color: #337ab7;
  border-color: #337ab7;
}
.list-group-item.active .list-group-item-heading,
.list-group-item.active:hover .list-group-item-heading,
.list-group-item.active:focus .list-group-item-heading,
.list-group-item.active .list-group-item-heading > small,
.list-group-item.active:hover .list-group-item-heading > small,
.list-group-item.active:focus .list-group-item-heading > small,
.list-group-item.active .list-group-item-heading > .small,
.list-group-item.active:hover .list-group-item-heading > .small,
.list-group-item.active:focus .list-group-item-heading > .small {
  color: inherit;
}
.list-group-item.active .list-group-item-text,
.list-group-item.active:hover .list-group-item-text,
.list-group-item.active:focus .list-group-item-text {
  color: #c7ddef;
}
.list-group-item-success {
  color: #3c763d;
  background-color: #dff0d8;
}
a.list-group-item-success,
button.list-group-item-success {
  color: #3c763d;
}
a.list-group-item-success .list-group-item-heading,
button.list-group-item-success .list-group-item-heading {
  color: inherit;
}
a.list-group-item-success:hover,
button.list-group-item-success:hover,
a.list-group-item-success:focus,
button.list-group-item-success:focus {
  color: #3c763d;
  background-color: #d0e9c6;
}
a.list-group-item-success.active,
button.list-group-item-success.active,
a.list-group-item-success.active:hover,
button.list-group-item-success.active:hover,
a.list-group-item-success.active:focus,
button.list-group-item-success.active:focus {
  color: #fff;
  background-color: #3c763d;
  border-color: #3c763d;
}
.list-group-item-info {
  color: #31708f;
  background-color: #d9edf7;
}
a.list-group-item-info,
button.list-group-item-info {
  color: #31708f;
}
a.list-group-item-info .list-group-item-heading,
button.list-group-item-info .list-group-item-heading {
  color: inherit;
}
a.list-group-item-info:hover,
button.list-group-item-info:hover,
a.list-group-item-info:focus,
button.list-group-item-info:focus {
  color: #31708f;
  background-color: #c4e3f3;
}
a.list-group-item-info.active,
button.list-group-item-info.active,
a.list-group-item-info.active:hover,
button.list-group-item-info.active:hover,
a.list-group-item-info.active:focus,
button.list-group-item-info.active:focus {
  color: #fff;
  background-color: #31708f;
  border-color: #31708f;
}
.list-group-item-warning {
  color: #8a6d3b;
  background-color: #fcf8e3;
}
a.list-group-item-warning,
button.list-group-item-warning {
  color: #8a6d3b;
}
a.list-group-item-warning .list-group-item-heading,
button.list-group-item-warning .list-group-item-heading {
  color: inherit;
}
a.list-group-item-warning:hover,
button.list-group-item-warning:hover,
a.list-group-item-warning:focus,
button.list-group-item-warning:focus {
  color: #8a6d3b;
  background-color: #faf2cc;
}
a.list-group-item-warning.active,
button.list-group-item-warning.active,
a.list-group-item-warning.active:hover,
button.list-group-item-warning.active:hover,
a.list-group-item-warning.active:focus,
button.list-group-item-warning.active:focus {
  color: #fff;
  background-color: #8a6d3b;
  border-color: #8a6d3b;
}
.list-group-item-danger {
  color: #a94442;
  background-color: #f2dede;
}
a.list-group-item-danger,
button.list-group-item-danger {
  color: #a94442;
}
a.list-group-item-danger .list-group-item-heading,
button.list-group-item-danger .list-group-item-heading {
  color: inherit;
}
a.list-group-item-danger:hover,
button.list-group-item-danger:hover,
a.list-group-item-danger:focus,
button.list-group-item-danger:focus {
  color: #a94442;
  background-color: #ebcccc;
}
a.list-group-item-danger.active,
button.list-group-item-danger.active,
a.list-group-item-danger.active:hover,
button.list-group-item-danger.active:hover,
a.list-group-item-danger.active:focus,
button.list-group-item-danger.active:focus {
  color: #fff;
  background-color: #a94442;
  border-color: #a94442;
}
.list-group-item-heading {
  margin-top: 0;
  margin-bottom: 5px;
}
.list-group-item-text {
  margin-bottom: 0;
  line-height: 1.3;
}
.panel {
  margin-bottom: 18px;
  background-color: #fff;
  border: 1px solid transparent;
  border-radius: 2px;
  -webkit-box-shadow: 0 1px 1px rgba(0, 0, 0, 0.05);
  box-shadow: 0 1px 1px rgba(0, 0, 0, 0.05);
}
.panel-body {
  padding: 15px;
}
.panel-heading {
  padding: 10px 15px;
  border-bottom: 1px solid transparent;
  border-top-right-radius: 1px;
  border-top-left-radius: 1px;
}
.panel-heading > .dropdown .dropdown-toggle {
  color: inherit;
}
.panel-title {
  margin-top: 0;
  margin-bottom: 0;
  font-size: 15px;
  color: inherit;
}
.panel-title > a,
.panel-title > small,
.panel-title > .small,
.panel-title > small > a,
.panel-title > .small > a {
  color: inherit;
}
.panel-footer {
  padding: 10px 15px;
  background-color: #f5f5f5;
  border-top: 1px solid #ddd;
  border-bottom-right-radius: 1px;
  border-bottom-left-radius: 1px;
}
.panel > .list-group,
.panel > .panel-collapse > .list-group {
  margin-bottom: 0;
}
.panel > .list-group .list-group-item,
.panel > .panel-collapse > .list-group .list-group-item {
  border-width: 1px 0;
  border-radius: 0;
}
.panel > .list-group:first-child .list-group-item:first-child,
.panel > .panel-collapse > .list-group:first-child .list-group-item:first-child {
  border-top: 0;
  border-top-right-radius: 1px;
  border-top-left-radius: 1px;
}
.panel > .list-group:last-child .list-group-item:last-child,
.panel > .panel-collapse > .list-group:last-child .list-group-item:last-child {
  border-bottom: 0;
  border-bottom-right-radius: 1px;
  border-bottom-left-radius: 1px;
}
.panel > .panel-heading + .panel-collapse > .list-group .list-group-item:first-child {
  border-top-right-radius: 0;
  border-top-left-radius: 0;
}
.panel-heading + .list-group .list-group-item:first-child {
  border-top-width: 0;
}
.list-group + .panel-footer {
  border-top-width: 0;
}
.panel > .table,
.panel > .table-responsive > .table,
.panel > .panel-collapse > .table {
  margin-bottom: 0;
}
.panel > .table caption,
.panel > .table-responsive > .table caption,
.panel > .panel-collapse > .table caption {
  padding-left: 15px;
  padding-right: 15px;
}
.panel > .table:first-child,
.panel > .table-responsive:first-child > .table:first-child {
  border-top-right-radius: 1px;
  border-top-left-radius: 1px;
}
.panel > .table:first-child > thead:first-child > tr:first-child,
.panel > .table-responsive:first-child > .table:first-child > thead:first-child > tr:first-child,
.panel > .table:first-child > tbody:first-child > tr:first-child,
.panel > .table-responsive:first-child > .table:first-child > tbody:first-child > tr:first-child {
  border-top-left-radius: 1px;
  border-top-right-radius: 1px;
}
.panel > .table:first-child > thead:first-child > tr:first-child td:first-child,
.panel > .table-responsive:first-child > .table:first-child > thead:first-child > tr:first-child td:first-child,
.panel > .table:first-child > tbody:first-child > tr:first-child td:first-child,
.panel > .table-responsive:first-child > .table:first-child > tbody:first-child > tr:first-child td:first-child,
.panel > .table:first-child > thead:first-child > tr:first-child th:first-child,
.panel > .table-responsive:first-child > .table:first-child > thead:first-child > tr:first-child th:first-child,
.panel > .table:first-child > tbody:first-child > tr:first-child th:first-child,
.panel > .table-responsive:first-child > .table:first-child > tbody:first-child > tr:first-child th:first-child {
  border-top-left-radius: 1px;
}
.panel > .table:first-child > thead:first-child > tr:first-child td:last-child,
.panel > .table-responsive:first-child > .table:first-child > thead:first-child > tr:first-child td:last-child,
.panel > .table:first-child > tbody:first-child > tr:first-child td:last-child,
.panel > .table-responsive:first-child > .table:first-child > tbody:first-child > tr:first-child td:last-child,
.panel > .table:first-child > thead:first-child > tr:first-child th:last-child,
.panel > .table-responsive:first-child > .table:first-child > thead:first-child > tr:first-child th:last-child,
.panel > .table:first-child > tbody:first-child > tr:first-child th:last-child,
.panel > .table-responsive:first-child > .table:first-child > tbody:first-child > tr:first-child th:last-child {
  border-top-right-radius: 1px;
}
.panel > .table:last-child,
.panel > .table-responsive:last-child > .table:last-child {
  border-bottom-right-radius: 1px;
  border-bottom-left-radius: 1px;
}
.panel > .table:last-child > tbody:last-child > tr:last-child,
.panel > .table-responsive:last-child > .table:last-child > tbody:last-child > tr:last-child,
.panel > .table:last-child > tfoot:last-child > tr:last-child,
.panel > .table-responsive:last-child > .table:last-child > tfoot:last-child > tr:last-child {
  border-bottom-left-radius: 1px;
  border-bottom-right-radius: 1px;
}
.panel > .table:last-child > tbody:last-child > tr:last-child td:first-child,
.panel > .table-responsive:last-child > .table:last-child > tbody:last-child > tr:last-child td:first-child,
.panel > .table:last-child > tfoot:last-child > tr:last-child td:first-child,
.panel > .table-responsive:last-child > .table:last-child > tfoot:last-child > tr:last-child td:first-child,
.panel > .table:last-child > tbody:last-child > tr:last-child th:first-child,
.panel > .table-responsive:last-child > .table:last-child > tbody:last-child > tr:last-child th:first-child,
.panel > .table:last-child > tfoot:last-child > tr:last-child th:first-child,
.panel > .table-responsive:last-child > .table:last-child > tfoot:last-child > tr:last-child th:first-child {
  border-bottom-left-radius: 1px;
}
.panel > .table:last-child > tbody:last-child > tr:last-child td:last-child,
.panel > .table-responsive:last-child > .table:last-child > tbody:last-child > tr:last-child td:last-child,
.panel > .table:last-child > tfoot:last-child > tr:last-child td:last-child,
.panel > .table-responsive:last-child > .table:last-child > tfoot:last-child > tr:last-child td:last-child,
.panel > .table:last-child > tbody:last-child > tr:last-child th:last-child,
.panel > .table-responsive:last-child > .table:last-child > tbody:last-child > tr:last-child th:last-child,
.panel > .table:last-child > tfoot:last-child > tr:last-child th:last-child,
.panel > .table-responsive:last-child > .table:last-child > tfoot:last-child > tr:last-child th:last-child {
  border-bottom-right-radius: 1px;
}
.panel > .panel-body + .table,
.panel > .panel-body + .table-responsive,
.panel > .table + .panel-body,
.panel > .table-responsive + .panel-body {
  border-top: 1px solid #ddd;
}
.panel > .table > tbody:first-child > tr:first-child th,
.panel > .table > tbody:first-child > tr:first-child td {
  border-top: 0;
}
.panel > .table-bordered,
.panel > .table-responsive > .table-bordered {
  border: 0;
}
.panel > .table-bordered > thead > tr > th:first-child,
.panel > .table-responsive > .table-bordered > thead > tr > th:first-child,
.panel > .table-bordered > tbody > tr > th:first-child,
.panel > .table-responsive > .table-bordered > tbody > tr > th:first-child,
.panel > .table-bordered > tfoot > tr > th:first-child,
.panel > .table-responsive > .table-bordered > tfoot > tr > th:first-child,
.panel > .table-bordered > thead > tr > td:first-child,
.panel > .table-responsive > .table-bordered > thead > tr > td:first-child,
.panel > .table-bordered > tbody > tr > td:first-child,
.panel > .table-responsive > .table-bordered > tbody > tr > td:first-child,
.panel > .table-bordered > tfoot > tr > td:first-child,
.panel > .table-responsive > .table-bordered > tfoot > tr > td:first-child {
  border-left: 0;
}
.panel > .table-bordered > thead > tr > th:last-child,
.panel > .table-responsive > .table-bordered > thead > tr > th:last-child,
.panel > .table-bordered > tbody > tr > th:last-child,
.panel > .table-responsive > .table-bordered > tbody > tr > th:last-child,
.panel > .table-bordered > tfoot > tr > th:last-child,
.panel > .table-responsive > .table-bordered > tfoot > tr > th:last-child,
.panel > .table-bordered > thead > tr > td:last-child,
.panel > .table-responsive > .table-bordered > thead > tr > td:last-child,
.panel > .table-bordered > tbody > tr > td:last-child,
.panel > .table-responsive > .table-bordered > tbody > tr > td:last-child,
.panel > .table-bordered > tfoot > tr > td:last-child,
.panel > .table-responsive > .table-bordered > tfoot > tr > td:last-child {
  border-right: 0;
}
.panel > .table-bordered > thead > tr:first-child > td,
.panel > .table-responsive > .table-bordered > thead > tr:first-child > td,
.panel > .table-bordered > tbody > tr:first-child > td,
.panel > .table-responsive > .table-bordered > tbody > tr:first-child > td,
.panel > .table-bordered > thead > tr:first-child > th,
.panel > .table-responsive > .table-bordered > thead > tr:first-child > th,
.panel > .table-bordered > tbody > tr:first-child > th,
.panel > .table-responsive > .table-bordered > tbody > tr:first-child > th {
  border-bottom: 0;
}
.panel > .table-bordered > tbody > tr:last-child > td,
.panel > .table-responsive > .table-bordered > tbody > tr:last-child > td,
.panel > .table-bordered > tfoot > tr:last-child > td,
.panel > .table-responsive > .table-bordered > tfoot > tr:last-child > td,
.panel > .table-bordered > tbody > tr:last-child > th,
.panel > .table-responsive > .table-bordered > tbody > tr:last-child > th,
.panel > .table-bordered > tfoot > tr:last-child > th,
.panel > .table-responsive > .table-bordered > tfoot > tr:last-child > th {
  border-bottom: 0;
}
.panel > .table-responsive {
  border: 0;
  margin-bottom: 0;
}
.panel-group {
  margin-bottom: 18px;
}
.panel-group .panel {
  margin-bottom: 0;
  border-radius: 2px;
}
.panel-group .panel + .panel {
  margin-top: 5px;
}
.panel-group .panel-heading {
  border-bottom: 0;
}
.panel-group .panel-heading + .panel-collapse > .panel-body,
.panel-group .panel-heading + .panel-collapse > .list-group {
  border-top: 1px solid #ddd;
}
.panel-group .panel-footer {
  border-top: 0;
}
.panel-group .panel-footer + .panel-collapse .panel-body {
  border-bottom: 1px solid #ddd;
}
.panel-default {
  border-color: #ddd;
}
.panel-default > .panel-heading {
  color: #333333;
  background-color: #f5f5f5;
  border-color: #ddd;
}
.panel-default > .panel-heading + .panel-collapse > .panel-body {
  border-top-color: #ddd;
}
.panel-default > .panel-heading .badge {
  color: #f5f5f5;
  background-color: #333333;
}
.panel-default > .panel-footer + .panel-collapse > .panel-body {
  border-bottom-color: #ddd;
}
.panel-primary {
  border-color: #337ab7;
}
.panel-primary > .panel-heading {
  color: #fff;
  background-color: #337ab7;
  border-color: #337ab7;
}
.panel-primary > .panel-heading + .panel-collapse > .panel-body {
  border-top-color: #337ab7;
}
.panel-primary > .panel-heading .badge {
  color: #337ab7;
  background-color: #fff;
}
.panel-primary > .panel-footer + .panel-collapse > .panel-body {
  border-bottom-color: #337ab7;
}
.panel-success {
  border-color: #d6e9c6;
}
.panel-success > .panel-heading {
  color: #3c763d;
  background-color: #dff0d8;
  border-color: #d6e9c6;
}
.panel-success > .panel-heading + .panel-collapse > .panel-body {
  border-top-color: #d6e9c6;
}
.panel-success > .panel-heading .badge {
  color: #dff0d8;
  background-color: #3c763d;
}
.panel-success > .panel-footer + .panel-collapse > .panel-body {
  border-bottom-color: #d6e9c6;
}
.panel-info {
  border-color: #bce8f1;
}
.panel-info > .panel-heading {
  color: #31708f;
  background-color: #d9edf7;
  border-color: #bce8f1;
}
.panel-info > .panel-heading + .panel-collapse > .panel-body {
  border-top-color: #bce8f1;
}
.panel-info > .panel-heading .badge {
  color: #d9edf7;
  background-color: #31708f;
}
.panel-info > .panel-footer + .panel-collapse > .panel-body {
  border-bottom-color: #bce8f1;
}
.panel-warning {
  border-color: #faebcc;
}
.panel-warning > .panel-heading {
  color: #8a6d3b;
  background-color: #fcf8e3;
  border-color: #faebcc;
}
.panel-warning > .panel-heading + .panel-collapse > .panel-body {
  border-top-color: #faebcc;
}
.panel-warning > .panel-heading .badge {
  color: #fcf8e3;
  background-color: #8a6d3b;
}
.panel-warning > .panel-footer + .panel-collapse > .panel-body {
  border-bottom-color: #faebcc;
}
.panel-danger {
  border-color: #ebccd1;
}
.panel-danger > .panel-heading {
  color: #a94442;
  background-color: #f2dede;
  border-color: #ebccd1;
}
.panel-danger > .panel-heading + .panel-collapse > .panel-body {
  border-top-color: #ebccd1;
}
.panel-danger > .panel-heading .badge {
  color: #f2dede;
  background-color: #a94442;
}
.panel-danger > .panel-footer + .panel-collapse > .panel-body {
  border-bottom-color: #ebccd1;
}
.embed-responsive {
  position: relative;
  display: block;
  height: 0;
  padding: 0;
  overflow: hidden;
}
.embed-responsive .embed-responsive-item,
.embed-responsive iframe,
.embed-responsive embed,
.embed-responsive object,
.embed-responsive video {
  position: absolute;
  top: 0;
  left: 0;
  bottom: 0;
  height: 100%;
  width: 100%;
  border: 0;
}
.embed-responsive-16by9 {
  padding-bottom: 56.25%;
}
.embed-responsive-4by3 {
  padding-bottom: 75%;
}
.well {
  min-height: 20px;
  padding: 19px;
  margin-bottom: 20px;
  background-color: #f5f5f5;
  border: 1px solid #e3e3e3;
  border-radius: 2px;
  -webkit-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.05);
  box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.05);
}
.well blockquote {
  border-color: #ddd;
  border-color: rgba(0, 0, 0, 0.15);
}
.well-lg {
  padding: 24px;
  border-radius: 3px;
}
.well-sm {
  padding: 9px;
  border-radius: 1px;
}
.close {
  float: right;
  font-size: 19.5px;
  font-weight: bold;
  line-height: 1;
  color: #000;
  text-shadow: 0 1px 0 #fff;
  opacity: 0.2;
  filter: alpha(opacity=20);
}
.close:hover,
.close:focus {
  color: #000;
  text-decoration: none;
  cursor: pointer;
  opacity: 0.5;
  filter: alpha(opacity=50);
}
button.close {
  padding: 0;
  cursor: pointer;
  background: transparent;
  border: 0;
  -webkit-appearance: none;
}
.modal-open {
  overflow: hidden;
}
.modal {
  display: none;
  overflow: hidden;
  position: fixed;
  top: 0;
  right: 0;
  bottom: 0;
  left: 0;
  z-index: 1050;
  -webkit-overflow-scrolling: touch;
  outline: 0;
}
.modal.fade .modal-dialog {
  -webkit-transform: translate(0, -25%);
  -ms-transform: translate(0, -25%);
  -o-transform: translate(0, -25%);
  transform: translate(0, -25%);
  -webkit-transition: -webkit-transform 0.3s ease-out;
  -moz-transition: -moz-transform 0.3s ease-out;
  -o-transition: -o-transform 0.3s ease-out;
  transition: transform 0.3s ease-out;
}
.modal.in .modal-dialog {
  -webkit-transform: translate(0, 0);
  -ms-transform: translate(0, 0);
  -o-transform: translate(0, 0);
  transform: translate(0, 0);
}
.modal-open .modal {
  overflow-x: hidden;
  overflow-y: auto;
}
.modal-dialog {
  position: relative;
  width: auto;
  margin: 10px;
}
.modal-content {
  position: relative;
  background-color: #fff;
  border: 1px solid #999;
  border: 1px solid rgba(0, 0, 0, 0.2);
  border-radius: 3px;
  -webkit-box-shadow: 0 3px 9px rgba(0, 0, 0, 0.5);
  box-shadow: 0 3px 9px rgba(0, 0, 0, 0.5);
  background-clip: padding-box;
  outline: 0;
}
.modal-backdrop {
  position: fixed;
  top: 0;
  right: 0;
  bottom: 0;
  left: 0;
  z-index: 1040;
  background-color: #000;
}
.modal-backdrop.fade {
  opacity: 0;
  filter: alpha(opacity=0);
}
.modal-backdrop.in {
  opacity: 0.5;
  filter: alpha(opacity=50);
}
.modal-header {
  padding: 15px;
  border-bottom: 1px solid #e5e5e5;
}
.modal-header .close {
  margin-top: -2px;
}
.modal-title {
  margin: 0;
  line-height: 1.42857143;
}
.modal-body {
  position: relative;
  padding: 15px;
}
.modal-footer {
  padding: 15px;
  text-align: right;
  border-top: 1px solid #e5e5e5;
}
.modal-footer .btn + .btn {
  margin-left: 5px;
  margin-bottom: 0;
}
.modal-footer .btn-group .btn + .btn {
  margin-left: -1px;
}
.modal-footer .btn-block + .btn-block {
  margin-left: 0;
}
.modal-scrollbar-measure {
  position: absolute;
  top: -9999px;
  width: 50px;
  height: 50px;
  overflow: scroll;
}
@media (min-width: 768px) {
  .modal-dialog {
    width: 600px;
    margin: 30px auto;
  }
  .modal-content {
    -webkit-box-shadow: 0 5px 15px rgba(0, 0, 0, 0.5);
    box-shadow: 0 5px 15px rgba(0, 0, 0, 0.5);
  }
  .modal-sm {
    width: 300px;
  }
}
@media (min-width: 992px) {
  .modal-lg {
    width: 900px;
  }
}
.tooltip {
  position: absolute;
  z-index: 1070;
  display: block;
  font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
  font-style: normal;
  font-weight: normal;
  letter-spacing: normal;
  line-break: auto;
  line-height: 1.42857143;
  text-align: left;
  text-align: start;
  text-decoration: none;
  text-shadow: none;
  text-transform: none;
  white-space: normal;
  word-break: normal;
  word-spacing: normal;
  word-wrap: normal;
  font-size: 12px;
  opacity: 0;
  filter: alpha(opacity=0);
}
.tooltip.in {
  opacity: 0.9;
  filter: alpha(opacity=90);
}
.tooltip.top {
  margin-top: -3px;
  padding: 5px 0;
}
.tooltip.right {
  margin-left: 3px;
  padding: 0 5px;
}
.tooltip.bottom {
  margin-top: 3px;
  padding: 5px 0;
}
.tooltip.left {
  margin-left: -3px;
  padding: 0 5px;
}
.tooltip-inner {
  max-width: 200px;
  padding: 3px 8px;
  color: #fff;
  text-align: center;
  background-color: #000;
  border-radius: 2px;
}
.tooltip-arrow {
  position: absolute;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
}
.tooltip.top .tooltip-arrow {
  bottom: 0;
  left: 50%;
  margin-left: -5px;
  border-width: 5px 5px 0;
  border-top-color: #000;
}
.tooltip.top-left .tooltip-arrow {
  bottom: 0;
  right: 5px;
  margin-bottom: -5px;
  border-width: 5px 5px 0;
  border-top-color: #000;
}
.tooltip.top-right .tooltip-arrow {
  bottom: 0;
  left: 5px;
  margin-bottom: -5px;
  border-width: 5px 5px 0;
  border-top-color: #000;
}
.tooltip.right .tooltip-arrow {
  top: 50%;
  left: 0;
  margin-top: -5px;
  border-width: 5px 5px 5px 0;
  border-right-color: #000;
}
.tooltip.left .tooltip-arrow {
  top: 50%;
  right: 0;
  margin-top: -5px;
  border-width: 5px 0 5px 5px;
  border-left-color: #000;
}
.tooltip.bottom .tooltip-arrow {
  top: 0;
  left: 50%;
  margin-left: -5px;
  border-width: 0 5px 5px;
  border-bottom-color: #000;
}
.tooltip.bottom-left .tooltip-arrow {
  top: 0;
  right: 5px;
  margin-top: -5px;
  border-width: 0 5px 5px;
  border-bottom-color: #000;
}
.tooltip.bottom-right .tooltip-arrow {
  top: 0;
  left: 5px;
  margin-top: -5px;
  border-width: 0 5px 5px;
  border-bottom-color: #000;
}
.popover {
  position: absolute;
  top: 0;
  left: 0;
  z-index: 1060;
  display: none;
  max-width: 276px;
  padding: 1px;
  font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
  font-style: normal;
  font-weight: normal;
  letter-spacing: normal;
  line-break: auto;
  line-height: 1.42857143;
  text-align: left;
  text-align: start;
  text-decoration: none;
  text-shadow: none;
  text-transform: none;
  white-space: normal;
  word-break: normal;
  word-spacing: normal;
  word-wrap: normal;
  font-size: 13px;
  background-color: #fff;
  background-clip: padding-box;
  border: 1px solid #ccc;
  border: 1px solid rgba(0, 0, 0, 0.2);
  border-radius: 3px;
  -webkit-box-shadow: 0 5px 10px rgba(0, 0, 0, 0.2);
  box-shadow: 0 5px 10px rgba(0, 0, 0, 0.2);
}
.popover.top {
  margin-top: -10px;
}
.popover.right {
  margin-left: 10px;
}
.popover.bottom {
  margin-top: 10px;
}
.popover.left {
  margin-left: -10px;
}
.popover-title {
  margin: 0;
  padding: 8px 14px;
  font-size: 13px;
  background-color: #f7f7f7;
  border-bottom: 1px solid #ebebeb;
  border-radius: 2px 2px 0 0;
}
.popover-content {
  padding: 9px 14px;
}
.popover > .arrow,
.popover > .arrow:after {
  position: absolute;
  display: block;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
}
.popover > .arrow {
  border-width: 11px;
}
.popover > .arrow:after {
  border-width: 10px;
  content: "";
}
.popover.top > .arrow {
  left: 50%;
  margin-left: -11px;
  border-bottom-width: 0;
  border-top-color: #999999;
  border-top-color: rgba(0, 0, 0, 0.25);
  bottom: -11px;
}
.popover.top > .arrow:after {
  content: " ";
  bottom: 1px;
  margin-left: -10px;
  border-bottom-width: 0;
  border-top-color: #fff;
}
.popover.right > .arrow {
  top: 50%;
  left: -11px;
  margin-top: -11px;
  border-left-width: 0;
  border-right-color: #999999;
  border-right-color: rgba(0, 0, 0, 0.25);
}
.popover.right > .arrow:after {
  content: " ";
  left: 1px;
  bottom: -10px;
  border-left-width: 0;
  border-right-color: #fff;
}
.popover.bottom > .arrow {
  left: 50%;
  margin-left: -11px;
  border-top-width: 0;
  border-bottom-color: #999999;
  border-bottom-color: rgba(0, 0, 0, 0.25);
  top: -11px;
}
.popover.bottom > .arrow:after {
  content: " ";
  top: 1px;
  margin-left: -10px;
  border-top-width: 0;
  border-bottom-color: #fff;
}
.popover.left > .arrow {
  top: 50%;
  right: -11px;
  margin-top: -11px;
  border-right-width: 0;
  border-left-color: #999999;
  border-left-color: rgba(0, 0, 0, 0.25);
}
.popover.left > .arrow:after {
  content: " ";
  right: 1px;
  border-right-width: 0;
  border-left-color: #fff;
  bottom: -10px;
}
.carousel {
  position: relative;
}
.carousel-inner {
  position: relative;
  overflow: hidden;
  width: 100%;
}
.carousel-inner > .item {
  display: none;
  position: relative;
  -webkit-transition: 0.6s ease-in-out left;
  -o-transition: 0.6s ease-in-out left;
  transition: 0.6s ease-in-out left;
}
.carousel-inner > .item > img,
.carousel-inner > .item > a > img {
  line-height: 1;
}
@media all and (transform-3d), (-webkit-transform-3d) {
  .carousel-inner > .item {
    -webkit-transition: -webkit-transform 0.6s ease-in-out;
    -moz-transition: -moz-transform 0.6s ease-in-out;
    -o-transition: -o-transform 0.6s ease-in-out;
    transition: transform 0.6s ease-in-out;
    -webkit-backface-visibility: hidden;
    -moz-backface-visibility: hidden;
    backface-visibility: hidden;
    -webkit-perspective: 1000px;
    -moz-perspective: 1000px;
    perspective: 1000px;
  }
  .carousel-inner > .item.next,
  .carousel-inner > .item.active.right {
    -webkit-transform: translate3d(100%, 0, 0);
    transform: translate3d(100%, 0, 0);
    left: 0;
  }
  .carousel-inner > .item.prev,
  .carousel-inner > .item.active.left {
    -webkit-transform: translate3d(-100%, 0, 0);
    transform: translate3d(-100%, 0, 0);
    left: 0;
  }
  .carousel-inner > .item.next.left,
  .carousel-inner > .item.prev.right,
  .carousel-inner > .item.active {
    -webkit-transform: translate3d(0, 0, 0);
    transform: translate3d(0, 0, 0);
    left: 0;
  }
}
.carousel-inner > .active,
.carousel-inner > .next,
.carousel-inner > .prev {
  display: block;
}
.carousel-inner > .active {
  left: 0;
}
.carousel-inner > .next,
.carousel-inner > .prev {
  position: absolute;
  top: 0;
  width: 100%;
}
.carousel-inner > .next {
  left: 100%;
}
.carousel-inner > .prev {
  left: -100%;
}
.carousel-inner > .next.left,
.carousel-inner > .prev.right {
  left: 0;
}
.carousel-inner > .active.left {
  left: -100%;
}
.carousel-inner > .active.right {
  left: 100%;
}
.carousel-control {
  position: absolute;
  top: 0;
  left: 0;
  bottom: 0;
  width: 15%;
  opacity: 0.5;
  filter: alpha(opacity=50);
  font-size: 20px;
  color: #fff;
  text-align: center;
  text-shadow: 0 1px 2px rgba(0, 0, 0, 0.6);
  background-color: rgba(0, 0, 0, 0);
}
.carousel-control.left {
  background-image: -webkit-linear-gradient(left, rgba(0, 0, 0, 0.5) 0%, rgba(0, 0, 0, 0.0001) 100%);
  background-image: -o-linear-gradient(left, rgba(0, 0, 0, 0.5) 0%, rgba(0, 0, 0, 0.0001) 100%);
  background-image: linear-gradient(to right, rgba(0, 0, 0, 0.5) 0%, rgba(0, 0, 0, 0.0001) 100%);
  background-repeat: repeat-x;
  filter: progid:DXImageTransform.Microsoft.gradient(startColorstr='#80000000', endColorstr='#00000000', GradientType=1);
}
.carousel-control.right {
  left: auto;
  right: 0;
  background-image: -webkit-linear-gradient(left, rgba(0, 0, 0, 0.0001) 0%, rgba(0, 0, 0, 0.5) 100%);
  background-image: -o-linear-gradient(left, rgba(0, 0, 0, 0.0001) 0%, rgba(0, 0, 0, 0.5) 100%);
  background-image: linear-gradient(to right, rgba(0, 0, 0, 0.0001) 0%, rgba(0, 0, 0, 0.5) 100%);
  background-repeat: repeat-x;
  filter: progid:DXImageTransform.Microsoft.gradient(startColorstr='#00000000', endColorstr='#80000000', GradientType=1);
}
.carousel-control:hover,
.carousel-control:focus {
  outline: 0;
  color: #fff;
  text-decoration: none;
  opacity: 0.9;
  filter: alpha(opacity=90);
}
.carousel-control .icon-prev,
.carousel-control .icon-next,
.carousel-control .glyphicon-chevron-left,
.carousel-control .glyphicon-chevron-right {
  position: absolute;
  top: 50%;
  margin-top: -10px;
  z-index: 5;
  display: inline-block;
}
.carousel-control .icon-prev,
.carousel-control .glyphicon-chevron-left {
  left: 50%;
  margin-left: -10px;
}
.carousel-control .icon-next,
.carousel-control .glyphicon-chevron-right {
  right: 50%;
  margin-right: -10px;
}
.carousel-control .icon-prev,
.carousel-control .icon-next {
  width: 20px;
  height: 20px;
  line-height: 1;
  font-family: serif;
}
.carousel-control .icon-prev:before {
  content: '\2039';
}
.carousel-control .icon-next:before {
  content: '\203a';
}
.carousel-indicators {
  position: absolute;
  bottom: 10px;
  left: 50%;
  z-index: 15;
  width: 60%;
  margin-left: -30%;
  padding-left: 0;
  list-style: none;
  text-align: center;
}
.carousel-indicators li {
  display: inline-block;
  width: 10px;
  height: 10px;
  margin: 1px;
  text-indent: -999px;
  border: 1px solid #fff;
  border-radius: 10px;
  cursor: pointer;
  background-color: #000 \9;
  background-color: rgba(0, 0, 0, 0);
}
.carousel-indicators .active {
  margin: 0;
  width: 12px;
  height: 12px;
  background-color: #fff;
}
.carousel-caption {
  position: absolute;
  left: 15%;
  right: 15%;
  bottom: 20px;
  z-index: 10;
  padding-top: 20px;
  padding-bottom: 20px;
  color: #fff;
  text-align: center;
  text-shadow: 0 1px 2px rgba(0, 0, 0, 0.6);
}
.carousel-caption .btn {
  text-shadow: none;
}
@media screen and (min-width: 768px) {
  .carousel-control .glyphicon-chevron-left,
  .carousel-control .glyphicon-chevron-right,
  .carousel-control .icon-prev,
  .carousel-control .icon-next {
    width: 30px;
    height: 30px;
    margin-top: -10px;
    font-size: 30px;
  }
  .carousel-control .glyphicon-chevron-left,
  .carousel-control .icon-prev {
    margin-left: -10px;
  }
  .carousel-control .glyphicon-chevron-right,
  .carousel-control .icon-next {
    margin-right: -10px;
  }
  .carousel-caption {
    left: 20%;
    right: 20%;
    padding-bottom: 30px;
  }
  .carousel-indicators {
    bottom: 20px;
  }
}
.clearfix:before,
.clearfix:after,
.dl-horizontal dd:before,
.dl-horizontal dd:after,
.container:before,
.container:after,
.container-fluid:before,
.container-fluid:after,
.row:before,
.row:after,
.form-horizontal .form-group:before,
.form-horizontal .form-group:after,
.btn-toolbar:before,
.btn-toolbar:after,
.btn-group-vertical > .btn-group:before,
.btn-group-vertical > .btn-group:after,
.nav:before,
.nav:after,
.navbar:before,
.navbar:after,
.navbar-header:before,
.navbar-header:after,
.navbar-collapse:before,
.navbar-collapse:after,
.pager:before,
.pager:after,
.panel-body:before,
.panel-body:after,
.modal-header:before,
.modal-header:after,
.modal-footer:before,
.modal-footer:after,
.item_buttons:before,
.item_buttons:after {
  content: " ";
  display: table;
}
.clearfix:after,
.dl-horizontal dd:after,
.container:after,
.container-fluid:after,
.row:after,
.form-horizontal .form-group:after,
.btn-toolbar:after,
.btn-group-vertical > .btn-group:after,
.nav:after,
.navbar:after,
.navbar-header:after,
.navbar-collapse:after,
.pager:after,
.panel-body:after,
.modal-header:after,
.modal-footer:after,
.item_buttons:after {
  clear: both;
}
.center-block {
  display: block;
  margin-left: auto;
  margin-right: auto;
}
.pull-right {
  float: right !important;
}
.pull-left {
  float: left !important;
}
.hide {
  display: none !important;
}
.show {
  display: block !important;
}
.invisible {
  visibility: hidden;
}
.text-hide {
  font: 0/0 a;
  color: transparent;
  text-shadow: none;
  background-color: transparent;
  border: 0;
}
.hidden {
  display: none !important;
}
.affix {
  position: fixed;
}
@-ms-viewport {
  width: device-width;
}
.visible-xs,
.visible-sm,
.visible-md,
.visible-lg {
  display: none !important;
}
.visible-xs-block,
.visible-xs-inline,
.visible-xs-inline-block,
.visible-sm-block,
.visible-sm-inline,
.visible-sm-inline-block,
.visible-md-block,
.visible-md-inline,
.visible-md-inline-block,
.visible-lg-block,
.visible-lg-inline,
.visible-lg-inline-block {
  display: none !important;
}
@media (max-width: 767px) {
  .visible-xs {
    display: block !important;
  }
  table.visible-xs {
    display: table !important;
  }
  tr.visible-xs {
    display: table-row !important;
  }
  th.visible-xs,
  td.visible-xs {
    display: table-cell !important;
  }
}
@media (max-width: 767px) {
  .visible-xs-block {
    display: block !important;
  }
}
@media (max-width: 767px) {
  .visible-xs-inline {
    display: inline !important;
  }
}
@media (max-width: 767px) {
  .visible-xs-inline-block {
    display: inline-block !important;
  }
}
@media (min-width: 768px) and (max-width: 991px) {
  .visible-sm {
    display: block !important;
  }
  table.visible-sm {
    display: table !important;
  }
  tr.visible-sm {
    display: table-row !important;
  }
  th.visible-sm,
  td.visible-sm {
    display: table-cell !important;
  }
}
@media (min-width: 768px) and (max-width: 991px) {
  .visible-sm-block {
    display: block !important;
  }
}
@media (min-width: 768px) and (max-width: 991px) {
  .visible-sm-inline {
    display: inline !important;
  }
}
@media (min-width: 768px) and (max-width: 991px) {
  .visible-sm-inline-block {
    display: inline-block !important;
  }
}
@media (min-width: 992px) and (max-width: 1199px) {
  .visible-md {
    display: block !important;
  }
  table.visible-md {
    display: table !important;
  }
  tr.visible-md {
    display: table-row !important;
  }
  th.visible-md,
  td.visible-md {
    display: table-cell !important;
  }
}
@media (min-width: 992px) and (max-width: 1199px) {
  .visible-md-block {
    display: block !important;
  }
}
@media (min-width: 992px) and (max-width: 1199px) {
  .visible-md-inline {
    display: inline !important;
  }
}
@media (min-width: 992px) and (max-width: 1199px) {
  .visible-md-inline-block {
    display: inline-block !important;
  }
}
@media (min-width: 1200px) {
  .visible-lg {
    display: block !important;
  }
  table.visible-lg {
    display: table !important;
  }
  tr.visible-lg {
    display: table-row !important;
  }
  th.visible-lg,
  td.visible-lg {
    display: table-cell !important;
  }
}
@media (min-width: 1200px) {
  .visible-lg-block {
    display: block !important;
  }
}
@media (min-width: 1200px) {
  .visible-lg-inline {
    display: inline !important;
  }
}
@media (min-width: 1200px) {
  .visible-lg-inline-block {
    display: inline-block !important;
  }
}
@media (max-width: 767px) {
  .hidden-xs {
    display: none !important;
  }
}
@media (min-width: 768px) and (max-width: 991px) {
  .hidden-sm {
    display: none !important;
  }
}
@media (min-width: 992px) and (max-width: 1199px) {
  .hidden-md {
    display: none !important;
  }
}
@media (min-width: 1200px) {
  .hidden-lg {
    display: none !important;
  }
}
.visible-print {
  display: none !important;
}
@media print {
  .visible-print {
    display: block !important;
  }
  table.visible-print {
    display: table !important;
  }
  tr.visible-print {
    display: table-row !important;
  }
  th.visible-print,
  td.visible-print {
    display: table-cell !important;
  }
}
.visible-print-block {
  display: none !important;
}
@media print {
  .visible-print-block {
    display: block !important;
  }
}
.visible-print-inline {
  display: none !important;
}
@media print {
  .visible-print-inline {
    display: inline !important;
  }
}
.visible-print-inline-block {
  display: none !important;
}
@media print {
  .visible-print-inline-block {
    display: inline-block !important;
  }
}
@media print {
  .hidden-print {
    display: none !important;
  }
}
/*!
*
* Font Awesome
*
*/
/*!
 *  Font Awesome 4.2.0 by @davegandy - http://fontawesome.io - @fontawesome
 *  License - http://fontawesome.io/license (Font: SIL OFL 1.1, CSS: MIT License)
 */
/* FONT PATH
 * -------------------------- */
@font-face {
  font-family: 'FontAwesome';
  src: url('../components/font-awesome/fonts/fontawesome-webfont.eot?v=4.2.0');
  src: url('../components/font-awesome/fonts/fontawesome-webfont.eot?#iefix&v=4.2.0') format('embedded-opentype'), url('../components/font-awesome/fonts/fontawesome-webfont.woff?v=4.2.0') format('woff'), url('../components/font-awesome/fonts/fontawesome-webfont.ttf?v=4.2.0') format('truetype'), url('../components/font-awesome/fonts/fontawesome-webfont.svg?v=4.2.0#fontawesomeregular') format('svg');
  font-weight: normal;
  font-style: normal;
}
.fa {
  display: inline-block;
  font: normal normal normal 14px/1 FontAwesome;
  font-size: inherit;
  text-rendering: auto;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}
/* makes the font 33% larger relative to the icon container */
.fa-lg {
  font-size: 1.33333333em;
  line-height: 0.75em;
  vertical-align: -15%;
}
.fa-2x {
  font-size: 2em;
}
.fa-3x {
  font-size: 3em;
}
.fa-4x {
  font-size: 4em;
}
.fa-5x {
  font-size: 5em;
}
.fa-fw {
  width: 1.28571429em;
  text-align: center;
}
.fa-ul {
  padding-left: 0;
  margin-left: 2.14285714em;
  list-style-type: none;
}
.fa-ul > li {
  position: relative;
}
.fa-li {
  position: absolute;
  left: -2.14285714em;
  width: 2.14285714em;
  top: 0.14285714em;
  text-align: center;
}
.fa-li.fa-lg {
  left: -1.85714286em;
}
.fa-border {
  padding: .2em .25em .15em;
  border: solid 0.08em #eee;
  border-radius: .1em;
}
.pull-right {
  float: right;
}
.pull-left {
  float: left;
}
.fa.pull-left {
  margin-right: .3em;
}
.fa.pull-right {
  margin-left: .3em;
}
.fa-spin {
  -webkit-animation: fa-spin 2s infinite linear;
  animation: fa-spin 2s infinite linear;
}
@-webkit-keyframes fa-spin {
  0% {
    -webkit-transform: rotate(0deg);
    transform: rotate(0deg);
  }
  100% {
    -webkit-transform: rotate(359deg);
    transform: rotate(359deg);
  }
}
@keyframes fa-spin {
  0% {
    -webkit-transform: rotate(0deg);
    transform: rotate(0deg);
  }
  100% {
    -webkit-transform: rotate(359deg);
    transform: rotate(359deg);
  }
}
.fa-rotate-90 {
  filter: progid:DXImageTransform.Microsoft.BasicImage(rotation=1);
  -webkit-transform: rotate(90deg);
  -ms-transform: rotate(90deg);
  transform: rotate(90deg);
}
.fa-rotate-180 {
  filter: progid:DXImageTransform.Microsoft.BasicImage(rotation=2);
  -webkit-transform: rotate(180deg);
  -ms-transform: rotate(180deg);
  transform: rotate(180deg);
}
.fa-rotate-270 {
  filter: progid:DXImageTransform.Microsoft.BasicImage(rotation=3);
  -webkit-transform: rotate(270deg);
  -ms-transform: rotate(270deg);
  transform: rotate(270deg);
}
.fa-flip-horizontal {
  filter: progid:DXImageTransform.Microsoft.BasicImage(rotation=0, mirror=1);
  -webkit-transform: scale(-1, 1);
  -ms-transform: scale(-1, 1);
  transform: scale(-1, 1);
}
.fa-flip-vertical {
  filter: progid:DXImageTransform.Microsoft.BasicImage(rotation=2, mirror=1);
  -webkit-transform: scale(1, -1);
  -ms-transform: scale(1, -1);
  transform: scale(1, -1);
}
:root .fa-rotate-90,
:root .fa-rotate-180,
:root .fa-rotate-270,
:root .fa-flip-horizontal,
:root .fa-flip-vertical {
  filter: none;
}
.fa-stack {
  position: relative;
  display: inline-block;
  width: 2em;
  height: 2em;
  line-height: 2em;
  vertical-align: middle;
}
.fa-stack-1x,
.fa-stack-2x {
  position: absolute;
  left: 0;
  width: 100%;
  text-align: center;
}
.fa-stack-1x {
  line-height: inherit;
}
.fa-stack-2x {
  font-size: 2em;
}
.fa-inverse {
  color: #fff;
}
/* Font Awesome uses the Unicode Private Use Area (PUA) to ensure screen
   readers do not read off random characters that represent icons */
.fa-glass:before {
  content: "\f000";
}
.fa-music:before {
  content: "\f001";
}
.fa-search:before {
  content: "\f002";
}
.fa-envelope-o:before {
  content: "\f003";
}
.fa-heart:before {
  content: "\f004";
}
.fa-star:before {
  content: "\f005";
}
.fa-star-o:before {
  content: "\f006";
}
.fa-user:before {
  content: "\f007";
}
.fa-film:before {
  content: "\f008";
}
.fa-th-large:before {
  content: "\f009";
}
.fa-th:before {
  content: "\f00a";
}
.fa-th-list:before {
  content: "\f00b";
}
.fa-check:before {
  content: "\f00c";
}
.fa-remove:before,
.fa-close:before,
.fa-times:before {
  content: "\f00d";
}
.fa-search-plus:before {
  content: "\f00e";
}
.fa-search-minus:before {
  content: "\f010";
}
.fa-power-off:before {
  content: "\f011";
}
.fa-signal:before {
  content: "\f012";
}
.fa-gear:before,
.fa-cog:before {
  content: "\f013";
}
.fa-trash-o:before {
  content: "\f014";
}
.fa-home:before {
  content: "\f015";
}
.fa-file-o:before {
  content: "\f016";
}
.fa-clock-o:before {
  content: "\f017";
}
.fa-road:before {
  content: "\f018";
}
.fa-download:before {
  content: "\f019";
}
.fa-arrow-circle-o-down:before {
  content: "\f01a";
}
.fa-arrow-circle-o-up:before {
  content: "\f01b";
}
.fa-inbox:before {
  content: "\f01c";
}
.fa-play-circle-o:before {
  content: "\f01d";
}
.fa-rotate-right:before,
.fa-repeat:before {
  content: "\f01e";
}
.fa-refresh:before {
  content: "\f021";
}
.fa-list-alt:before {
  content: "\f022";
}
.fa-lock:before {
  content: "\f023";
}
.fa-flag:before {
  content: "\f024";
}
.fa-headphones:before {
  content: "\f025";
}
.fa-volume-off:before {
  content: "\f026";
}
.fa-volume-down:before {
  content: "\f027";
}
.fa-volume-up:before {
  content: "\f028";
}
.fa-qrcode:before {
  content: "\f029";
}
.fa-barcode:before {
  content: "\f02a";
}
.fa-tag:before {
  content: "\f02b";
}
.fa-tags:before {
  content: "\f02c";
}
.fa-book:before {
  content: "\f02d";
}
.fa-bookmark:before {
  content: "\f02e";
}
.fa-print:before {
  content: "\f02f";
}
.fa-camera:before {
  content: "\f030";
}
.fa-font:before {
  content: "\f031";
}
.fa-bold:before {
  content: "\f032";
}
.fa-italic:before {
  content: "\f033";
}
.fa-text-height:before {
  content: "\f034";
}
.fa-text-width:before {
  content: "\f035";
}
.fa-align-left:before {
  content: "\f036";
}
.fa-align-center:before {
  content: "\f037";
}
.fa-align-right:before {
  content: "\f038";
}
.fa-align-justify:before {
  content: "\f039";
}
.fa-list:before {
  content: "\f03a";
}
.fa-dedent:before,
.fa-outdent:before {
  content: "\f03b";
}
.fa-indent:before {
  content: "\f03c";
}
.fa-video-camera:before {
  content: "\f03d";
}
.fa-photo:before,
.fa-image:before,
.fa-picture-o:before {
  content: "\f03e";
}
.fa-pencil:before {
  content: "\f040";
}
.fa-map-marker:before {
  content: "\f041";
}
.fa-adjust:before {
  content: "\f042";
}
.fa-tint:before {
  content: "\f043";
}
.fa-edit:before,
.fa-pencil-square-o:before {
  content: "\f044";
}
.fa-share-square-o:before {
  content: "\f045";
}
.fa-check-square-o:before {
  content: "\f046";
}
.fa-arrows:before {
  content: "\f047";
}
.fa-step-backward:before {
  content: "\f048";
}
.fa-fast-backward:before {
  content: "\f049";
}
.fa-backward:before {
  content: "\f04a";
}
.fa-play:before {
  content: "\f04b";
}
.fa-pause:before {
  content: "\f04c";
}
.fa-stop:before {
  content: "\f04d";
}
.fa-forward:before {
  content: "\f04e";
}
.fa-fast-forward:before {
  content: "\f050";
}
.fa-step-forward:before {
  content: "\f051";
}
.fa-eject:before {
  content: "\f052";
}
.fa-chevron-left:before {
  content: "\f053";
}
.fa-chevron-right:before {
  content: "\f054";
}
.fa-plus-circle:before {
  content: "\f055";
}
.fa-minus-circle:before {
  content: "\f056";
}
.fa-times-circle:before {
  content: "\f057";
}
.fa-check-circle:before {
  content: "\f058";
}
.fa-question-circle:before {
  content: "\f059";
}
.fa-info-circle:before {
  content: "\f05a";
}
.fa-crosshairs:before {
  content: "\f05b";
}
.fa-times-circle-o:before {
  content: "\f05c";
}
.fa-check-circle-o:before {
  content: "\f05d";
}
.fa-ban:before {
  content: "\f05e";
}
.fa-arrow-left:before {
  content: "\f060";
}
.fa-arrow-right:before {
  content: "\f061";
}
.fa-arrow-up:before {
  content: "\f062";
}
.fa-arrow-down:before {
  content: "\f063";
}
.fa-mail-forward:before,
.fa-share:before {
  content: "\f064";
}
.fa-expand:before {
  content: "\f065";
}
.fa-compress:before {
  content: "\f066";
}
.fa-plus:before {
  content: "\f067";
}
.fa-minus:before {
  content: "\f068";
}
.fa-asterisk:before {
  content: "\f069";
}
.fa-exclamation-circle:before {
  content: "\f06a";
}
.fa-gift:before {
  content: "\f06b";
}
.fa-leaf:before {
  content: "\f06c";
}
.fa-fire:before {
  content: "\f06d";
}
.fa-eye:before {
  content: "\f06e";
}
.fa-eye-slash:before {
  content: "\f070";
}
.fa-warning:before,
.fa-exclamation-triangle:before {
  content: "\f071";
}
.fa-plane:before {
  content: "\f072";
}
.fa-calendar:before {
  content: "\f073";
}
.fa-random:before {
  content: "\f074";
}
.fa-comment:before {
  content: "\f075";
}
.fa-magnet:before {
  content: "\f076";
}
.fa-chevron-up:before {
  content: "\f077";
}
.fa-chevron-down:before {
  content: "\f078";
}
.fa-retweet:before {
  content: "\f079";
}
.fa-shopping-cart:before {
  content: "\f07a";
}
.fa-folder:before {
  content: "\f07b";
}
.fa-folder-open:before {
  content: "\f07c";
}
.fa-arrows-v:before {
  content: "\f07d";
}
.fa-arrows-h:before {
  content: "\f07e";
}
.fa-bar-chart-o:before,
.fa-bar-chart:before {
  content: "\f080";
}
.fa-twitter-square:before {
  content: "\f081";
}
.fa-facebook-square:before {
  content: "\f082";
}
.fa-camera-retro:before {
  content: "\f083";
}
.fa-key:before {
  content: "\f084";
}
.fa-gears:before,
.fa-cogs:before {
  content: "\f085";
}
.fa-comments:before {
  content: "\f086";
}
.fa-thumbs-o-up:before {
  content: "\f087";
}
.fa-thumbs-o-down:before {
  content: "\f088";
}
.fa-star-half:before {
  content: "\f089";
}
.fa-heart-o:before {
  content: "\f08a";
}
.fa-sign-out:before {
  content: "\f08b";
}
.fa-linkedin-square:before {
  content: "\f08c";
}
.fa-thumb-tack:before {
  content: "\f08d";
}
.fa-external-link:before {
  content: "\f08e";
}
.fa-sign-in:before {
  content: "\f090";
}
.fa-trophy:before {
  content: "\f091";
}
.fa-github-square:before {
  content: "\f092";
}
.fa-upload:before {
  content: "\f093";
}
.fa-lemon-o:before {
  content: "\f094";
}
.fa-phone:before {
  content: "\f095";
}
.fa-square-o:before {
  content: "\f096";
}
.fa-bookmark-o:before {
  content: "\f097";
}
.fa-phone-square:before {
  content: "\f098";
}
.fa-twitter:before {
  content: "\f099";
}
.fa-facebook:before {
  content: "\f09a";
}
.fa-github:before {
  content: "\f09b";
}
.fa-unlock:before {
  content: "\f09c";
}
.fa-credit-card:before {
  content: "\f09d";
}
.fa-rss:before {
  content: "\f09e";
}
.fa-hdd-o:before {
  content: "\f0a0";
}
.fa-bullhorn:before {
  content: "\f0a1";
}
.fa-bell:before {
  content: "\f0f3";
}
.fa-certificate:before {
  content: "\f0a3";
}
.fa-hand-o-right:before {
  content: "\f0a4";
}
.fa-hand-o-left:before {
  content: "\f0a5";
}
.fa-hand-o-up:before {
  content: "\f0a6";
}
.fa-hand-o-down:before {
  content: "\f0a7";
}
.fa-arrow-circle-left:before {
  content: "\f0a8";
}
.fa-arrow-circle-right:before {
  content: "\f0a9";
}
.fa-arrow-circle-up:before {
  content: "\f0aa";
}
.fa-arrow-circle-down:before {
  content: "\f0ab";
}
.fa-globe:before {
  content: "\f0ac";
}
.fa-wrench:before {
  content: "\f0ad";
}
.fa-tasks:before {
  content: "\f0ae";
}
.fa-filter:before {
  content: "\f0b0";
}
.fa-briefcase:before {
  content: "\f0b1";
}
.fa-arrows-alt:before {
  content: "\f0b2";
}
.fa-group:before,
.fa-users:before {
  content: "\f0c0";
}
.fa-chain:before,
.fa-link:before {
  content: "\f0c1";
}
.fa-cloud:before {
  content: "\f0c2";
}
.fa-flask:before {
  content: "\f0c3";
}
.fa-cut:before,
.fa-scissors:before {
  content: "\f0c4";
}
.fa-copy:before,
.fa-files-o:before {
  content: "\f0c5";
}
.fa-paperclip:before {
  content: "\f0c6";
}
.fa-save:before,
.fa-floppy-o:before {
  content: "\f0c7";
}
.fa-square:before {
  content: "\f0c8";
}
.fa-navicon:before,
.fa-reorder:before,
.fa-bars:before {
  content: "\f0c9";
}
.fa-list-ul:before {
  content: "\f0ca";
}
.fa-list-ol:before {
  content: "\f0cb";
}
.fa-strikethrough:before {
  content: "\f0cc";
}
.fa-underline:before {
  content: "\f0cd";
}
.fa-table:before {
  content: "\f0ce";
}
.fa-magic:before {
  content: "\f0d0";
}
.fa-truck:before {
  content: "\f0d1";
}
.fa-pinterest:before {
  content: "\f0d2";
}
.fa-pinterest-square:before {
  content: "\f0d3";
}
.fa-google-plus-square:before {
  content: "\f0d4";
}
.fa-google-plus:before {
  content: "\f0d5";
}
.fa-money:before {
  content: "\f0d6";
}
.fa-caret-down:before {
  content: "\f0d7";
}
.fa-caret-up:before {
  content: "\f0d8";
}
.fa-caret-left:before {
  content: "\f0d9";
}
.fa-caret-right:before {
  content: "\f0da";
}
.fa-columns:before {
  content: "\f0db";
}
.fa-unsorted:before,
.fa-sort:before {
  content: "\f0dc";
}
.fa-sort-down:before,
.fa-sort-desc:before {
  content: "\f0dd";
}
.fa-sort-up:before,
.fa-sort-asc:before {
  content: "\f0de";
}
.fa-envelope:before {
  content: "\f0e0";
}
.fa-linkedin:before {
  content: "\f0e1";
}
.fa-rotate-left:before,
.fa-undo:before {
  content: "\f0e2";
}
.fa-legal:before,
.fa-gavel:before {
  content: "\f0e3";
}
.fa-dashboard:before,
.fa-tachometer:before {
  content: "\f0e4";
}
.fa-comment-o:before {
  content: "\f0e5";
}
.fa-comments-o:before {
  content: "\f0e6";
}
.fa-flash:before,
.fa-bolt:before {
  content: "\f0e7";
}
.fa-sitemap:before {
  content: "\f0e8";
}
.fa-umbrella:before {
  content: "\f0e9";
}
.fa-paste:before,
.fa-clipboard:before {
  content: "\f0ea";
}
.fa-lightbulb-o:before {
  content: "\f0eb";
}
.fa-exchange:before {
  content: "\f0ec";
}
.fa-cloud-download:before {
  content: "\f0ed";
}
.fa-cloud-upload:before {
  content: "\f0ee";
}
.fa-user-md:before {
  content: "\f0f0";
}
.fa-stethoscope:before {
  content: "\f0f1";
}
.fa-suitcase:before {
  content: "\f0f2";
}
.fa-bell-o:before {
  content: "\f0a2";
}
.fa-coffee:before {
  content: "\f0f4";
}
.fa-cutlery:before {
  content: "\f0f5";
}
.fa-file-text-o:before {
  content: "\f0f6";
}
.fa-building-o:before {
  content: "\f0f7";
}
.fa-hospital-o:before {
  content: "\f0f8";
}
.fa-ambulance:before {
  content: "\f0f9";
}
.fa-medkit:before {
  content: "\f0fa";
}
.fa-fighter-jet:before {
  content: "\f0fb";
}
.fa-beer:before {
  content: "\f0fc";
}
.fa-h-square:before {
  content: "\f0fd";
}
.fa-plus-square:before {
  content: "\f0fe";
}
.fa-angle-double-left:before {
  content: "\f100";
}
.fa-angle-double-right:before {
  content: "\f101";
}
.fa-angle-double-up:before {
  content: "\f102";
}
.fa-angle-double-down:before {
  content: "\f103";
}
.fa-angle-left:before {
  content: "\f104";
}
.fa-angle-right:before {
  content: "\f105";
}
.fa-angle-up:before {
  content: "\f106";
}
.fa-angle-down:before {
  content: "\f107";
}
.fa-desktop:before {
  content: "\f108";
}
.fa-laptop:before {
  content: "\f109";
}
.fa-tablet:before {
  content: "\f10a";
}
.fa-mobile-phone:before,
.fa-mobile:before {
  content: "\f10b";
}
.fa-circle-o:before {
  content: "\f10c";
}
.fa-quote-left:before {
  content: "\f10d";
}
.fa-quote-right:before {
  content: "\f10e";
}
.fa-spinner:before {
  content: "\f110";
}
.fa-circle:before {
  content: "\f111";
}
.fa-mail-reply:before,
.fa-reply:before {
  content: "\f112";
}
.fa-github-alt:before {
  content: "\f113";
}
.fa-folder-o:before {
  content: "\f114";
}
.fa-folder-open-o:before {
  content: "\f115";
}
.fa-smile-o:before {
  content: "\f118";
}
.fa-frown-o:before {
  content: "\f119";
}
.fa-meh-o:before {
  content: "\f11a";
}
.fa-gamepad:before {
  content: "\f11b";
}
.fa-keyboard-o:before {
  content: "\f11c";
}
.fa-flag-o:before {
  content: "\f11d";
}
.fa-flag-checkered:before {
  content: "\f11e";
}
.fa-terminal:before {
  content: "\f120";
}
.fa-code:before {
  content: "\f121";
}
.fa-mail-reply-all:before,
.fa-reply-all:before {
  content: "\f122";
}
.fa-star-half-empty:before,
.fa-star-half-full:before,
.fa-star-half-o:before {
  content: "\f123";
}
.fa-location-arrow:before {
  content: "\f124";
}
.fa-crop:before {
  content: "\f125";
}
.fa-code-fork:before {
  content: "\f126";
}
.fa-unlink:before,
.fa-chain-broken:before {
  content: "\f127";
}
.fa-question:before {
  content: "\f128";
}
.fa-info:before {
  content: "\f129";
}
.fa-exclamation:before {
  content: "\f12a";
}
.fa-superscript:before {
  content: "\f12b";
}
.fa-subscript:before {
  content: "\f12c";
}
.fa-eraser:before {
  content: "\f12d";
}
.fa-puzzle-piece:before {
  content: "\f12e";
}
.fa-microphone:before {
  content: "\f130";
}
.fa-microphone-slash:before {
  content: "\f131";
}
.fa-shield:before {
  content: "\f132";
}
.fa-calendar-o:before {
  content: "\f133";
}
.fa-fire-extinguisher:before {
  content: "\f134";
}
.fa-rocket:before {
  content: "\f135";
}
.fa-maxcdn:before {
  content: "\f136";
}
.fa-chevron-circle-left:before {
  content: "\f137";
}
.fa-chevron-circle-right:before {
  content: "\f138";
}
.fa-chevron-circle-up:before {
  content: "\f139";
}
.fa-chevron-circle-down:before {
  content: "\f13a";
}
.fa-html5:before {
  content: "\f13b";
}
.fa-css3:before {
  content: "\f13c";
}
.fa-anchor:before {
  content: "\f13d";
}
.fa-unlock-alt:before {
  content: "\f13e";
}
.fa-bullseye:before {
  content: "\f140";
}
.fa-ellipsis-h:before {
  content: "\f141";
}
.fa-ellipsis-v:before {
  content: "\f142";
}
.fa-rss-square:before {
  content: "\f143";
}
.fa-play-circle:before {
  content: "\f144";
}
.fa-ticket:before {
  content: "\f145";
}
.fa-minus-square:before {
  content: "\f146";
}
.fa-minus-square-o:before {
  content: "\f147";
}
.fa-level-up:before {
  content: "\f148";
}
.fa-level-down:before {
  content: "\f149";
}
.fa-check-square:before {
  content: "\f14a";
}
.fa-pencil-square:before {
  content: "\f14b";
}
.fa-external-link-square:before {
  content: "\f14c";
}
.fa-share-square:before {
  content: "\f14d";
}
.fa-compass:before {
  content: "\f14e";
}
.fa-toggle-down:before,
.fa-caret-square-o-down:before {
  content: "\f150";
}
.fa-toggle-up:before,
.fa-caret-square-o-up:before {
  content: "\f151";
}
.fa-toggle-right:before,
.fa-caret-square-o-right:before {
  content: "\f152";
}
.fa-euro:before,
.fa-eur:before {
  content: "\f153";
}
.fa-gbp:before {
  content: "\f154";
}
.fa-dollar:before,
.fa-usd:before {
  content: "\f155";
}
.fa-rupee:before,
.fa-inr:before {
  content: "\f156";
}
.fa-cny:before,
.fa-rmb:before,
.fa-yen:before,
.fa-jpy:before {
  content: "\f157";
}
.fa-ruble:before,
.fa-rouble:before,
.fa-rub:before {
  content: "\f158";
}
.fa-won:before,
.fa-krw:before {
  content: "\f159";
}
.fa-bitcoin:before,
.fa-btc:before {
  content: "\f15a";
}
.fa-file:before {
  content: "\f15b";
}
.fa-file-text:before {
  content: "\f15c";
}
.fa-sort-alpha-asc:before {
  content: "\f15d";
}
.fa-sort-alpha-desc:before {
  content: "\f15e";
}
.fa-sort-amount-asc:before {
  content: "\f160";
}
.fa-sort-amount-desc:before {
  content: "\f161";
}
.fa-sort-numeric-asc:before {
  content: "\f162";
}
.fa-sort-numeric-desc:before {
  content: "\f163";
}
.fa-thumbs-up:before {
  content: "\f164";
}
.fa-thumbs-down:before {
  content: "\f165";
}
.fa-youtube-square:before {
  content: "\f166";
}
.fa-youtube:before {
  content: "\f167";
}
.fa-xing:before {
  content: "\f168";
}
.fa-xing-square:before {
  content: "\f169";
}
.fa-youtube-play:before {
  content: "\f16a";
}
.fa-dropbox:before {
  content: "\f16b";
}
.fa-stack-overflow:before {
  content: "\f16c";
}
.fa-instagram:before {
  content: "\f16d";
}
.fa-flickr:before {
  content: "\f16e";
}
.fa-adn:before {
  content: "\f170";
}
.fa-bitbucket:before {
  content: "\f171";
}
.fa-bitbucket-square:before {
  content: "\f172";
}
.fa-tumblr:before {
  content: "\f173";
}
.fa-tumblr-square:before {
  content: "\f174";
}
.fa-long-arrow-down:before {
  content: "\f175";
}
.fa-long-arrow-up:before {
  content: "\f176";
}
.fa-long-arrow-left:before {
  content: "\f177";
}
.fa-long-arrow-right:before {
  content: "\f178";
}
.fa-apple:before {
  content: "\f179";
}
.fa-windows:before {
  content: "\f17a";
}
.fa-android:before {
  content: "\f17b";
}
.fa-linux:before {
  content: "\f17c";
}
.fa-dribbble:before {
  content: "\f17d";
}
.fa-skype:before {
  content: "\f17e";
}
.fa-foursquare:before {
  content: "\f180";
}
.fa-trello:before {
  content: "\f181";
}
.fa-female:before {
  content: "\f182";
}
.fa-male:before {
  content: "\f183";
}
.fa-gittip:before {
  content: "\f184";
}
.fa-sun-o:before {
  content: "\f185";
}
.fa-moon-o:before {
  content: "\f186";
}
.fa-archive:before {
  content: "\f187";
}
.fa-bug:before {
  content: "\f188";
}
.fa-vk:before {
  content: "\f189";
}
.fa-weibo:before {
  content: "\f18a";
}
.fa-renren:before {
  content: "\f18b";
}
.fa-pagelines:before {
  content: "\f18c";
}
.fa-stack-exchange:before {
  content: "\f18d";
}
.fa-arrow-circle-o-right:before {
  content: "\f18e";
}
.fa-arrow-circle-o-left:before {
  content: "\f190";
}
.fa-toggle-left:before,
.fa-caret-square-o-left:before {
  content: "\f191";
}
.fa-dot-circle-o:before {
  content: "\f192";
}
.fa-wheelchair:before {
  content: "\f193";
}
.fa-vimeo-square:before {
  content: "\f194";
}
.fa-turkish-lira:before,
.fa-try:before {
  content: "\f195";
}
.fa-plus-square-o:before {
  content: "\f196";
}
.fa-space-shuttle:before {
  content: "\f197";
}
.fa-slack:before {
  content: "\f198";
}
.fa-envelope-square:before {
  content: "\f199";
}
.fa-wordpress:before {
  content: "\f19a";
}
.fa-openid:before {
  content: "\f19b";
}
.fa-institution:before,
.fa-bank:before,
.fa-university:before {
  content: "\f19c";
}
.fa-mortar-board:before,
.fa-graduation-cap:before {
  content: "\f19d";
}
.fa-yahoo:before {
  content: "\f19e";
}
.fa-google:before {
  content: "\f1a0";
}
.fa-reddit:before {
  content: "\f1a1";
}
.fa-reddit-square:before {
  content: "\f1a2";
}
.fa-stumbleupon-circle:before {
  content: "\f1a3";
}
.fa-stumbleupon:before {
  content: "\f1a4";
}
.fa-delicious:before {
  content: "\f1a5";
}
.fa-digg:before {
  content: "\f1a6";
}
.fa-pied-piper:before {
  content: "\f1a7";
}
.fa-pied-piper-alt:before {
  content: "\f1a8";
}
.fa-drupal:before {
  content: "\f1a9";
}
.fa-joomla:before {
  content: "\f1aa";
}
.fa-language:before {
  content: "\f1ab";
}
.fa-fax:before {
  content: "\f1ac";
}
.fa-building:before {
  content: "\f1ad";
}
.fa-child:before {
  content: "\f1ae";
}
.fa-paw:before {
  content: "\f1b0";
}
.fa-spoon:before {
  content: "\f1b1";
}
.fa-cube:before {
  content: "\f1b2";
}
.fa-cubes:before {
  content: "\f1b3";
}
.fa-behance:before {
  content: "\f1b4";
}
.fa-behance-square:before {
  content: "\f1b5";
}
.fa-steam:before {
  content: "\f1b6";
}
.fa-steam-square:before {
  content: "\f1b7";
}
.fa-recycle:before {
  content: "\f1b8";
}
.fa-automobile:before,
.fa-car:before {
  content: "\f1b9";
}
.fa-cab:before,
.fa-taxi:before {
  content: "\f1ba";
}
.fa-tree:before {
  content: "\f1bb";
}
.fa-spotify:before {
  content: "\f1bc";
}
.fa-deviantart:before {
  content: "\f1bd";
}
.fa-soundcloud:before {
  content: "\f1be";
}
.fa-database:before {
  content: "\f1c0";
}
.fa-file-pdf-o:before {
  content: "\f1c1";
}
.fa-file-word-o:before {
  content: "\f1c2";
}
.fa-file-excel-o:before {
  content: "\f1c3";
}
.fa-file-powerpoint-o:before {
  content: "\f1c4";
}
.fa-file-photo-o:before,
.fa-file-picture-o:before,
.fa-file-image-o:before {
  content: "\f1c5";
}
.fa-file-zip-o:before,
.fa-file-archive-o:before {
  content: "\f1c6";
}
.fa-file-sound-o:before,
.fa-file-audio-o:before {
  content: "\f1c7";
}
.fa-file-movie-o:before,
.fa-file-video-o:before {
  content: "\f1c8";
}
.fa-file-code-o:before {
  content: "\f1c9";
}
.fa-vine:before {
  content: "\f1ca";
}
.fa-codepen:before {
  content: "\f1cb";
}
.fa-jsfiddle:before {
  content: "\f1cc";
}
.fa-life-bouy:before,
.fa-life-buoy:before,
.fa-life-saver:before,
.fa-support:before,
.fa-life-ring:before {
  content: "\f1cd";
}
.fa-circle-o-notch:before {
  content: "\f1ce";
}
.fa-ra:before,
.fa-rebel:before {
  content: "\f1d0";
}
.fa-ge:before,
.fa-empire:before {
  content: "\f1d1";
}
.fa-git-square:before {
  content: "\f1d2";
}
.fa-git:before {
  content: "\f1d3";
}
.fa-hacker-news:before {
  content: "\f1d4";
}
.fa-tencent-weibo:before {
  content: "\f1d5";
}
.fa-qq:before {
  content: "\f1d6";
}
.fa-wechat:before,
.fa-weixin:before {
  content: "\f1d7";
}
.fa-send:before,
.fa-paper-plane:before {
  content: "\f1d8";
}
.fa-send-o:before,
.fa-paper-plane-o:before {
  content: "\f1d9";
}
.fa-history:before {
  content: "\f1da";
}
.fa-circle-thin:before {
  content: "\f1db";
}
.fa-header:before {
  content: "\f1dc";
}
.fa-paragraph:before {
  content: "\f1dd";
}
.fa-sliders:before {
  content: "\f1de";
}
.fa-share-alt:before {
  content: "\f1e0";
}
.fa-share-alt-square:before {
  content: "\f1e1";
}
.fa-bomb:before {
  content: "\f1e2";
}
.fa-soccer-ball-o:before,
.fa-futbol-o:before {
  content: "\f1e3";
}
.fa-tty:before {
  content: "\f1e4";
}
.fa-binoculars:before {
  content: "\f1e5";
}
.fa-plug:before {
  content: "\f1e6";
}
.fa-slideshare:before {
  content: "\f1e7";
}
.fa-twitch:before {
  content: "\f1e8";
}
.fa-yelp:before {
  content: "\f1e9";
}
.fa-newspaper-o:before {
  content: "\f1ea";
}
.fa-wifi:before {
  content: "\f1eb";
}
.fa-calculator:before {
  content: "\f1ec";
}
.fa-paypal:before {
  content: "\f1ed";
}
.fa-google-wallet:before {
  content: "\f1ee";
}
.fa-cc-visa:before {
  content: "\f1f0";
}
.fa-cc-mastercard:before {
  content: "\f1f1";
}
.fa-cc-discover:before {
  content: "\f1f2";
}
.fa-cc-amex:before {
  content: "\f1f3";
}
.fa-cc-paypal:before {
  content: "\f1f4";
}
.fa-cc-stripe:before {
  content: "\f1f5";
}
.fa-bell-slash:before {
  content: "\f1f6";
}
.fa-bell-slash-o:before {
  content: "\f1f7";
}
.fa-trash:before {
  content: "\f1f8";
}
.fa-copyright:before {
  content: "\f1f9";
}
.fa-at:before {
  content: "\f1fa";
}
.fa-eyedropper:before {
  content: "\f1fb";
}
.fa-paint-brush:before {
  content: "\f1fc";
}
.fa-birthday-cake:before {
  content: "\f1fd";
}
.fa-area-chart:before {
  content: "\f1fe";
}
.fa-pie-chart:before {
  content: "\f200";
}
.fa-line-chart:before {
  content: "\f201";
}
.fa-lastfm:before {
  content: "\f202";
}
.fa-lastfm-square:before {
  content: "\f203";
}
.fa-toggle-off:before {
  content: "\f204";
}
.fa-toggle-on:before {
  content: "\f205";
}
.fa-bicycle:before {
  content: "\f206";
}
.fa-bus:before {
  content: "\f207";
}
.fa-ioxhost:before {
  content: "\f208";
}
.fa-angellist:before {
  content: "\f209";
}
.fa-cc:before {
  content: "\f20a";
}
.fa-shekel:before,
.fa-sheqel:before,
.fa-ils:before {
  content: "\f20b";
}
.fa-meanpath:before {
  content: "\f20c";
}
/*!
*
* IPython base
*
*/
.modal.fade .modal-dialog {
  -webkit-transform: translate(0, 0);
  -ms-transform: translate(0, 0);
  -o-transform: translate(0, 0);
  transform: translate(0, 0);
}
code {
  color: #000;
}
pre {
  font-size: inherit;
  line-height: inherit;
}
label {
  font-weight: normal;
}
/* Make the page background atleast 100% the height of the view port */
/* Make the page itself atleast 70% the height of the view port */
.border-box-sizing {
  box-sizing: border-box;
  -moz-box-sizing: border-box;
  -webkit-box-sizing: border-box;
}
.corner-all {
  border-radius: 2px;
}
.no-padding {
  padding: 0px;
}
/* Flexible box model classes */
/* Taken from Alex Russell http://infrequently.org/2009/08/css-3-progress/ */
/* This file is a compatability layer.  It allows the usage of flexible box 
model layouts accross multiple browsers, including older browsers.  The newest,
universal implementation of the flexible box model is used when available (see
`Modern browsers` comments below).  Browsers that are known to implement this 
new spec completely include:

    Firefox 28.0+
    Chrome 29.0+
    Internet Explorer 11+ 
    Opera 17.0+

Browsers not listed, including Safari, are supported via the styling under the
`Old browsers` comments below.
*/
.hbox {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
.hbox > * {
  /* Old browsers */
  -webkit-box-flex: 0;
  -moz-box-flex: 0;
  box-flex: 0;
  /* Modern browsers */
  flex: none;
}
.vbox {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
}
.vbox > * {
  /* Old browsers */
  -webkit-box-flex: 0;
  -moz-box-flex: 0;
  box-flex: 0;
  /* Modern browsers */
  flex: none;
}
.hbox.reverse,
.vbox.reverse,
.reverse {
  /* Old browsers */
  -webkit-box-direction: reverse;
  -moz-box-direction: reverse;
  box-direction: reverse;
  /* Modern browsers */
  flex-direction: row-reverse;
}
.hbox.box-flex0,
.vbox.box-flex0,
.box-flex0 {
  /* Old browsers */
  -webkit-box-flex: 0;
  -moz-box-flex: 0;
  box-flex: 0;
  /* Modern browsers */
  flex: none;
  width: auto;
}
.hbox.box-flex1,
.vbox.box-flex1,
.box-flex1 {
  /* Old browsers */
  -webkit-box-flex: 1;
  -moz-box-flex: 1;
  box-flex: 1;
  /* Modern browsers */
  flex: 1;
}
.hbox.box-flex,
.vbox.box-flex,
.box-flex {
  /* Old browsers */
  /* Old browsers */
  -webkit-box-flex: 1;
  -moz-box-flex: 1;
  box-flex: 1;
  /* Modern browsers */
  flex: 1;
}
.hbox.box-flex2,
.vbox.box-flex2,
.box-flex2 {
  /* Old browsers */
  -webkit-box-flex: 2;
  -moz-box-flex: 2;
  box-flex: 2;
  /* Modern browsers */
  flex: 2;
}
.box-group1 {
  /*  Deprecated */
  -webkit-box-flex-group: 1;
  -moz-box-flex-group: 1;
  box-flex-group: 1;
}
.box-group2 {
  /* Deprecated */
  -webkit-box-flex-group: 2;
  -moz-box-flex-group: 2;
  box-flex-group: 2;
}
.hbox.start,
.vbox.start,
.start {
  /* Old browsers */
  -webkit-box-pack: start;
  -moz-box-pack: start;
  box-pack: start;
  /* Modern browsers */
  justify-content: flex-start;
}
.hbox.end,
.vbox.end,
.end {
  /* Old browsers */
  -webkit-box-pack: end;
  -moz-box-pack: end;
  box-pack: end;
  /* Modern browsers */
  justify-content: flex-end;
}
.hbox.center,
.vbox.center,
.center {
  /* Old browsers */
  -webkit-box-pack: center;
  -moz-box-pack: center;
  box-pack: center;
  /* Modern browsers */
  justify-content: center;
}
.hbox.baseline,
.vbox.baseline,
.baseline {
  /* Old browsers */
  -webkit-box-pack: baseline;
  -moz-box-pack: baseline;
  box-pack: baseline;
  /* Modern browsers */
  justify-content: baseline;
}
.hbox.stretch,
.vbox.stretch,
.stretch {
  /* Old browsers */
  -webkit-box-pack: stretch;
  -moz-box-pack: stretch;
  box-pack: stretch;
  /* Modern browsers */
  justify-content: stretch;
}
.hbox.align-start,
.vbox.align-start,
.align-start {
  /* Old browsers */
  -webkit-box-align: start;
  -moz-box-align: start;
  box-align: start;
  /* Modern browsers */
  align-items: flex-start;
}
.hbox.align-end,
.vbox.align-end,
.align-end {
  /* Old browsers */
  -webkit-box-align: end;
  -moz-box-align: end;
  box-align: end;
  /* Modern browsers */
  align-items: flex-end;
}
.hbox.align-center,
.vbox.align-center,
.align-center {
  /* Old browsers */
  -webkit-box-align: center;
  -moz-box-align: center;
  box-align: center;
  /* Modern browsers */
  align-items: center;
}
.hbox.align-baseline,
.vbox.align-baseline,
.align-baseline {
  /* Old browsers */
  -webkit-box-align: baseline;
  -moz-box-align: baseline;
  box-align: baseline;
  /* Modern browsers */
  align-items: baseline;
}
.hbox.align-stretch,
.vbox.align-stretch,
.align-stretch {
  /* Old browsers */
  -webkit-box-align: stretch;
  -moz-box-align: stretch;
  box-align: stretch;
  /* Modern browsers */
  align-items: stretch;
}
div.error {
  margin: 2em;
  text-align: center;
}
div.error > h1 {
  font-size: 500%;
  line-height: normal;
}
div.error > p {
  font-size: 200%;
  line-height: normal;
}
div.traceback-wrapper {
  text-align: left;
  max-width: 800px;
  margin: auto;
}
/**
 * Primary styles
 *
 * Author: Jupyter Development Team
 */
body {
  background-color: #fff;
  /* This makes sure that the body covers the entire window and needs to
       be in a different element than the display: box in wrapper below */
  position: absolute;
  left: 0px;
  right: 0px;
  top: 0px;
  bottom: 0px;
  overflow: visible;
}
body > #header {
  /* Initially hidden to prevent FLOUC */
  display: none;
  background-color: #fff;
  /* Display over codemirror */
  position: relative;
  z-index: 100;
}
body > #header #header-container {
  padding-bottom: 5px;
  padding-top: 5px;
  box-sizing: border-box;
  -moz-box-sizing: border-box;
  -webkit-box-sizing: border-box;
}
body > #header .header-bar {
  width: 100%;
  height: 1px;
  background: #e7e7e7;
  margin-bottom: -1px;
}
@media print {
  body > #header {
    display: none !important;
  }
}
#header-spacer {
  width: 100%;
  visibility: hidden;
}
@media print {
  #header-spacer {
    display: none;
  }
}
#ipython_notebook {
  padding-left: 0px;
  padding-top: 1px;
  padding-bottom: 1px;
}
@media (max-width: 991px) {
  #ipython_notebook {
    margin-left: 10px;
  }
}
[dir="rtl"] #ipython_notebook {
  float: right !important;
}
#noscript {
  width: auto;
  padding-top: 16px;
  padding-bottom: 16px;
  text-align: center;
  font-size: 22px;
  color: red;
  font-weight: bold;
}
#ipython_notebook img {
  height: 28px;
}
#site {
  width: 100%;
  display: none;
  box-sizing: border-box;
  -moz-box-sizing: border-box;
  -webkit-box-sizing: border-box;
  overflow: auto;
}
@media print {
  #site {
    height: auto !important;
  }
}
/* Smaller buttons */
.ui-button .ui-button-text {
  padding: 0.2em 0.8em;
  font-size: 77%;
}
input.ui-button {
  padding: 0.3em 0.9em;
}
span#login_widget {
  float: right;
}
span#login_widget > .button,
#logout {
  color: #333;
  background-color: #fff;
  border-color: #ccc;
}
span#login_widget > .button:focus,
#logout:focus,
span#login_widget > .button.focus,
#logout.focus {
  color: #333;
  background-color: #e6e6e6;
  border-color: #8c8c8c;
}
span#login_widget > .button:hover,
#logout:hover {
  color: #333;
  background-color: #e6e6e6;
  border-color: #adadad;
}
span#login_widget > .button:active,
#logout:active,
span#login_widget > .button.active,
#logout.active,
.open > .dropdown-togglespan#login_widget > .button,
.open > .dropdown-toggle#logout {
  color: #333;
  background-color: #e6e6e6;
  border-color: #adadad;
}
span#login_widget > .button:active:hover,
#logout:active:hover,
span#login_widget > .button.active:hover,
#logout.active:hover,
.open > .dropdown-togglespan#login_widget > .button:hover,
.open > .dropdown-toggle#logout:hover,
span#login_widget > .button:active:focus,
#logout:active:focus,
span#login_widget > .button.active:focus,
#logout.active:focus,
.open > .dropdown-togglespan#login_widget > .button:focus,
.open > .dropdown-toggle#logout:focus,
span#login_widget > .button:active.focus,
#logout:active.focus,
span#login_widget > .button.active.focus,
#logout.active.focus,
.open > .dropdown-togglespan#login_widget > .button.focus,
.open > .dropdown-toggle#logout.focus {
  color: #333;
  background-color: #d4d4d4;
  border-color: #8c8c8c;
}
span#login_widget > .button:active,
#logout:active,
span#login_widget > .button.active,
#logout.active,
.open > .dropdown-togglespan#login_widget > .button,
.open > .dropdown-toggle#logout {
  background-image: none;
}
span#login_widget > .button.disabled:hover,
#logout.disabled:hover,
span#login_widget > .button[disabled]:hover,
#logout[disabled]:hover,
fieldset[disabled] span#login_widget > .button:hover,
fieldset[disabled] #logout:hover,
span#login_widget > .button.disabled:focus,
#logout.disabled:focus,
span#login_widget > .button[disabled]:focus,
#logout[disabled]:focus,
fieldset[disabled] span#login_widget > .button:focus,
fieldset[disabled] #logout:focus,
span#login_widget > .button.disabled.focus,
#logout.disabled.focus,
span#login_widget > .button[disabled].focus,
#logout[disabled].focus,
fieldset[disabled] span#login_widget > .button.focus,
fieldset[disabled] #logout.focus {
  background-color: #fff;
  border-color: #ccc;
}
span#login_widget > .button .badge,
#logout .badge {
  color: #fff;
  background-color: #333;
}
.nav-header {
  text-transform: none;
}
#header > span {
  margin-top: 10px;
}
.modal_stretch .modal-dialog {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
  min-height: 80vh;
}
.modal_stretch .modal-dialog .modal-body {
  max-height: calc(100vh - 200px);
  overflow: auto;
  flex: 1;
}
@media (min-width: 768px) {
  .modal .modal-dialog {
    width: 700px;
  }
}
@media (min-width: 768px) {
  select.form-control {
    margin-left: 12px;
    margin-right: 12px;
  }
}
/*!
*
* IPython auth
*
*/
.center-nav {
  display: inline-block;
  margin-bottom: -4px;
}
/*!
*
* IPython tree view
*
*/
/* We need an invisible input field on top of the sentense*/
/* "Drag file onto the list ..." */
.alternate_upload {
  background-color: none;
  display: inline;
}
.alternate_upload.form {
  padding: 0;
  margin: 0;
}
.alternate_upload input.fileinput {
  text-align: center;
  vertical-align: middle;
  display: inline;
  opacity: 0;
  z-index: 2;
  width: 12ex;
  margin-right: -12ex;
}
.alternate_upload .btn-upload {
  height: 22px;
}
/**
 * Primary styles
 *
 * Author: Jupyter Development Team
 */
[dir="rtl"] #tabs li {
  float: right;
}
ul#tabs {
  margin-bottom: 4px;
}
[dir="rtl"] ul#tabs {
  margin-right: 0px;
}
ul#tabs a {
  padding-top: 6px;
  padding-bottom: 4px;
}
ul.breadcrumb a:focus,
ul.breadcrumb a:hover {
  text-decoration: none;
}
ul.breadcrumb i.icon-home {
  font-size: 16px;
  margin-right: 4px;
}
ul.breadcrumb span {
  color: #5e5e5e;
}
.list_toolbar {
  padding: 4px 0 4px 0;
  vertical-align: middle;
}
.list_toolbar .tree-buttons {
  padding-top: 1px;
}
[dir="rtl"] .list_toolbar .tree-buttons {
  float: left !important;
}
[dir="rtl"] .list_toolbar .pull-right {
  padding-top: 1px;
  float: left !important;
}
[dir="rtl"] .list_toolbar .pull-left {
  float: right !important;
}
.dynamic-buttons {
  padding-top: 3px;
  display: inline-block;
}
.list_toolbar [class*="span"] {
  min-height: 24px;
}
.list_header {
  font-weight: bold;
  background-color: #EEE;
}
.list_placeholder {
  font-weight: bold;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 7px;
  padding-right: 7px;
}
.list_container {
  margin-top: 4px;
  margin-bottom: 20px;
  border: 1px solid #ddd;
  border-radius: 2px;
}
.list_container > div {
  border-bottom: 1px solid #ddd;
}
.list_container > div:hover .list-item {
  background-color: red;
}
.list_container > div:last-child {
  border: none;
}
.list_item:hover .list_item {
  background-color: #ddd;
}
.list_item a {
  text-decoration: none;
}
.list_item:hover {
  background-color: #fafafa;
}
.list_header > div,
.list_item > div {
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 7px;
  padding-right: 7px;
  line-height: 22px;
}
.list_header > div input,
.list_item > div input {
  margin-right: 7px;
  margin-left: 14px;
  vertical-align: baseline;
  line-height: 22px;
  position: relative;
  top: -1px;
}
.list_header > div .item_link,
.list_item > div .item_link {
  margin-left: -1px;
  vertical-align: baseline;
  line-height: 22px;
}
.new-file input[type=checkbox] {
  visibility: hidden;
}
.item_name {
  line-height: 22px;
  height: 24px;
}
.item_icon {
  font-size: 14px;
  color: #5e5e5e;
  margin-right: 7px;
  margin-left: 7px;
  line-height: 22px;
  vertical-align: baseline;
}
.item_buttons {
  line-height: 1em;
  margin-left: -5px;
}
.item_buttons .btn,
.item_buttons .btn-group,
.item_buttons .input-group {
  float: left;
}
.item_buttons > .btn,
.item_buttons > .btn-group,
.item_buttons > .input-group {
  margin-left: 5px;
}
.item_buttons .btn {
  min-width: 13ex;
}
.item_buttons .running-indicator {
  padding-top: 4px;
  color: #5cb85c;
}
.item_buttons .kernel-name {
  padding-top: 4px;
  color: #5bc0de;
  margin-right: 7px;
  float: left;
}
.toolbar_info {
  height: 24px;
  line-height: 24px;
}
.list_item input:not([type=checkbox]) {
  padding-top: 3px;
  padding-bottom: 3px;
  height: 22px;
  line-height: 14px;
  margin: 0px;
}
.highlight_text {
  color: blue;
}
#project_name {
  display: inline-block;
  padding-left: 7px;
  margin-left: -2px;
}
#project_name > .breadcrumb {
  padding: 0px;
  margin-bottom: 0px;
  background-color: transparent;
  font-weight: bold;
}
#tree-selector {
  padding-right: 0px;
}
[dir="rtl"] #tree-selector a {
  float: right;
}
#button-select-all {
  min-width: 50px;
}
#select-all {
  margin-left: 7px;
  margin-right: 2px;
}
.menu_icon {
  margin-right: 2px;
}
.tab-content .row {
  margin-left: 0px;
  margin-right: 0px;
}
.folder_icon:before {
  display: inline-block;
  font: normal normal normal 14px/1 FontAwesome;
  font-size: inherit;
  text-rendering: auto;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  content: "\f114";
}
.folder_icon:before.pull-left {
  margin-right: .3em;
}
.folder_icon:before.pull-right {
  margin-left: .3em;
}
.notebook_icon:before {
  display: inline-block;
  font: normal normal normal 14px/1 FontAwesome;
  font-size: inherit;
  text-rendering: auto;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  content: "\f02d";
  position: relative;
  top: -1px;
}
.notebook_icon:before.pull-left {
  margin-right: .3em;
}
.notebook_icon:before.pull-right {
  margin-left: .3em;
}
.running_notebook_icon:before {
  display: inline-block;
  font: normal normal normal 14px/1 FontAwesome;
  font-size: inherit;
  text-rendering: auto;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  content: "\f02d";
  position: relative;
  top: -1px;
  color: #5cb85c;
}
.running_notebook_icon:before.pull-left {
  margin-right: .3em;
}
.running_notebook_icon:before.pull-right {
  margin-left: .3em;
}
.file_icon:before {
  display: inline-block;
  font: normal normal normal 14px/1 FontAwesome;
  font-size: inherit;
  text-rendering: auto;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  content: "\f016";
  position: relative;
  top: -2px;
}
.file_icon:before.pull-left {
  margin-right: .3em;
}
.file_icon:before.pull-right {
  margin-left: .3em;
}
#notebook_toolbar .pull-right {
  padding-top: 0px;
  margin-right: -1px;
}
ul#new-menu {
  left: auto;
  right: 0;
}
[dir="rtl"] #new-menu {
  text-align: right;
}
.kernel-menu-icon {
  padding-right: 12px;
  width: 24px;
  content: "\f096";
}
.kernel-menu-icon:before {
  content: "\f096";
}
.kernel-menu-icon-current:before {
  content: "\f00c";
}
#tab_content {
  padding-top: 20px;
}
#running .panel-group .panel {
  margin-top: 3px;
  margin-bottom: 1em;
}
#running .panel-group .panel .panel-heading {
  background-color: #EEE;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 7px;
  padding-right: 7px;
  line-height: 22px;
}
#running .panel-group .panel .panel-heading a:focus,
#running .panel-group .panel .panel-heading a:hover {
  text-decoration: none;
}
#running .panel-group .panel .panel-body {
  padding: 0px;
}
#running .panel-group .panel .panel-body .list_container {
  margin-top: 0px;
  margin-bottom: 0px;
  border: 0px;
  border-radius: 0px;
}
#running .panel-group .panel .panel-body .list_container .list_item {
  border-bottom: 1px solid #ddd;
}
#running .panel-group .panel .panel-body .list_container .list_item:last-child {
  border-bottom: 0px;
}
[dir="rtl"] #running .col-sm-8 {
  float: right !important;
}
.delete-button {
  display: none;
}
.duplicate-button {
  display: none;
}
.rename-button {
  display: none;
}
.shutdown-button {
  display: none;
}
.dynamic-instructions {
  display: inline-block;
  padding-top: 4px;
}
/*!
*
* IPython text editor webapp
*
*/
.selected-keymap i.fa {
  padding: 0px 5px;
}
.selected-keymap i.fa:before {
  content: "\f00c";
}
#mode-menu {
  overflow: auto;
  max-height: 20em;
}
.edit_app #header {
  -webkit-box-shadow: 0px 0px 12px 1px rgba(87, 87, 87, 0.2);
  box-shadow: 0px 0px 12px 1px rgba(87, 87, 87, 0.2);
}
.edit_app #menubar .navbar {
  /* Use a negative 1 bottom margin, so the border overlaps the border of the
    header */
  margin-bottom: -1px;
}
.dirty-indicator {
  display: inline-block;
  font: normal normal normal 14px/1 FontAwesome;
  font-size: inherit;
  text-rendering: auto;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  width: 20px;
}
.dirty-indicator.pull-left {
  margin-right: .3em;
}
.dirty-indicator.pull-right {
  margin-left: .3em;
}
.dirty-indicator-dirty {
  display: inline-block;
  font: normal normal normal 14px/1 FontAwesome;
  font-size: inherit;
  text-rendering: auto;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  width: 20px;
}
.dirty-indicator-dirty.pull-left {
  margin-right: .3em;
}
.dirty-indicator-dirty.pull-right {
  margin-left: .3em;
}
.dirty-indicator-clean {
  display: inline-block;
  font: normal normal normal 14px/1 FontAwesome;
  font-size: inherit;
  text-rendering: auto;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  width: 20px;
}
.dirty-indicator-clean.pull-left {
  margin-right: .3em;
}
.dirty-indicator-clean.pull-right {
  margin-left: .3em;
}
.dirty-indicator-clean:before {
  display: inline-block;
  font: normal normal normal 14px/1 FontAwesome;
  font-size: inherit;
  text-rendering: auto;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  content: "\f00c";
}
.dirty-indicator-clean:before.pull-left {
  margin-right: .3em;
}
.dirty-indicator-clean:before.pull-right {
  margin-left: .3em;
}
#filename {
  font-size: 16pt;
  display: table;
  padding: 0px 5px;
}
#current-mode {
  padding-left: 5px;
  padding-right: 5px;
}
#texteditor-backdrop {
  padding-top: 20px;
  padding-bottom: 20px;
}
@media not print {
  #texteditor-backdrop {
    background-color: #EEE;
  }
}
@media print {
  #texteditor-backdrop #texteditor-container .CodeMirror-gutter,
  #texteditor-backdrop #texteditor-container .CodeMirror-gutters {
    background-color: #fff;
  }
}
@media not print {
  #texteditor-backdrop #texteditor-container .CodeMirror-gutter,
  #texteditor-backdrop #texteditor-container .CodeMirror-gutters {
    background-color: #fff;
  }
}
@media not print {
  #texteditor-backdrop #texteditor-container {
    padding: 0px;
    background-color: #fff;
    -webkit-box-shadow: 0px 0px 12px 1px rgba(87, 87, 87, 0.2);
    box-shadow: 0px 0px 12px 1px rgba(87, 87, 87, 0.2);
  }
}
/*!
*
* IPython notebook
*
*/
/* CSS font colors for translated ANSI colors. */
.ansibold {
  font-weight: bold;
}
/* use dark versions for foreground, to improve visibility */
.ansiblack {
  color: black;
}
.ansired {
  color: darkred;
}
.ansigreen {
  color: darkgreen;
}
.ansiyellow {
  color: #c4a000;
}
.ansiblue {
  color: darkblue;
}
.ansipurple {
  color: darkviolet;
}
.ansicyan {
  color: steelblue;
}
.ansigray {
  color: gray;
}
/* and light for background, for the same reason */
.ansibgblack {
  background-color: black;
}
.ansibgred {
  background-color: red;
}
.ansibggreen {
  background-color: green;
}
.ansibgyellow {
  background-color: yellow;
}
.ansibgblue {
  background-color: blue;
}
.ansibgpurple {
  background-color: magenta;
}
.ansibgcyan {
  background-color: cyan;
}
.ansibggray {
  background-color: gray;
}
div.cell {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
  border-radius: 2px;
  box-sizing: border-box;
  -moz-box-sizing: border-box;
  -webkit-box-sizing: border-box;
  border-width: 1px;
  border-style: solid;
  border-color: transparent;
  width: 100%;
  padding: 5px;
  /* This acts as a spacer between cells, that is outside the border */
  margin: 0px;
  outline: none;
  border-left-width: 1px;
  padding-left: 5px;
  background: linear-gradient(to right, transparent -40px, transparent 1px, transparent 1px, transparent 100%);
}
div.cell.jupyter-soft-selected {
  border-left-color: #90CAF9;
  border-left-color: #E3F2FD;
  border-left-width: 1px;
  padding-left: 5px;
  border-right-color: #E3F2FD;
  border-right-width: 1px;
  background: #E3F2FD;
}
@media print {
  div.cell.jupyter-soft-selected {
    border-color: transparent;
  }
}
div.cell.selected {
  border-color: #ababab;
  border-left-width: 0px;
  padding-left: 6px;
  background: linear-gradient(to right, #42A5F5 -40px, #42A5F5 5px, transparent 5px, transparent 100%);
}
@media print {
  div.cell.selected {
    border-color: transparent;
  }
}
div.cell.selected.jupyter-soft-selected {
  border-left-width: 0;
  padding-left: 6px;
  background: linear-gradient(to right, #42A5F5 -40px, #42A5F5 7px, #E3F2FD 7px, #E3F2FD 100%);
}
.edit_mode div.cell.selected {
  border-color: #66BB6A;
  border-left-width: 0px;
  padding-left: 6px;
  background: linear-gradient(to right, #66BB6A -40px, #66BB6A 5px, transparent 5px, transparent 100%);
}
@media print {
  .edit_mode div.cell.selected {
    border-color: transparent;
  }
}
.prompt {
  /* This needs to be wide enough for 3 digit prompt numbers: In[100]: */
  min-width: 14ex;
  /* This padding is tuned to match the padding on the CodeMirror editor. */
  padding: 0.4em;
  margin: 0px;
  font-family: monospace;
  text-align: right;
  /* This has to match that of the the CodeMirror class line-height below */
  line-height: 1.21429em;
  /* Don't highlight prompt number selection */
  -webkit-touch-callout: none;
  -webkit-user-select: none;
  -khtml-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
  /* Use default cursor */
  cursor: default;
}
@media (max-width: 540px) {
  .prompt {
    text-align: left;
  }
}
div.inner_cell {
  min-width: 0;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
  /* Old browsers */
  -webkit-box-flex: 1;
  -moz-box-flex: 1;
  box-flex: 1;
  /* Modern browsers */
  flex: 1;
}
/* input_area and input_prompt must match in top border and margin for alignment */
div.input_area {
  border: 1px solid #cfcfcf;
  border-radius: 2px;
  background: #f7f7f7;
  line-height: 1.21429em;
}
/* This is needed so that empty prompt areas can collapse to zero height when there
   is no content in the output_subarea and the prompt. The main purpose of this is
   to make sure that empty JavaScript output_subareas have no height. */
div.prompt:empty {
  padding-top: 0;
  padding-bottom: 0;
}
div.unrecognized_cell {
  padding: 5px 5px 5px 0px;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
div.unrecognized_cell .inner_cell {
  border-radius: 2px;
  padding: 5px;
  font-weight: bold;
  color: red;
  border: 1px solid #cfcfcf;
  background: #eaeaea;
}
div.unrecognized_cell .inner_cell a {
  color: inherit;
  text-decoration: none;
}
div.unrecognized_cell .inner_cell a:hover {
  color: inherit;
  text-decoration: none;
}
@media (max-width: 540px) {
  div.unrecognized_cell > div.prompt {
    display: none;
  }
}
div.code_cell {
  /* avoid page breaking on code cells when printing */
}
@media print {
  div.code_cell {
    page-break-inside: avoid;
  }
}
/* any special styling for code cells that are currently running goes here */
div.input {
  page-break-inside: avoid;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
@media (max-width: 540px) {
  div.input {
    /* Old browsers */
    display: -webkit-box;
    -webkit-box-orient: vertical;
    -webkit-box-align: stretch;
    display: -moz-box;
    -moz-box-orient: vertical;
    -moz-box-align: stretch;
    display: box;
    box-orient: vertical;
    box-align: stretch;
    /* Modern browsers */
    display: flex;
    flex-direction: column;
    align-items: stretch;
  }
}
/* input_area and input_prompt must match in top border and margin for alignment */
div.input_prompt {
  color: #303F9F;
  border-top: 1px solid transparent;
}
div.input_area > div.highlight {
  margin: 0.4em;
  border: none;
  padding: 0px;
  background-color: transparent;
}
div.input_area > div.highlight > pre {
  margin: 0px;
  border: none;
  padding: 0px;
  background-color: transparent;
}
/* The following gets added to the <head> if it is detected that the user has a
 * monospace font with inconsistent normal/bold/italic height.  See
 * notebookmain.js.  Such fonts will have keywords vertically offset with
 * respect to the rest of the text.  The user should select a better font.
 * See: https://github.com/ipython/ipython/issues/1503
 *
 * .CodeMirror span {
 *      vertical-align: bottom;
 * }
 */
.CodeMirror {
  line-height: 1.21429em;
  /* Changed from 1em to our global default */
  font-size: 14px;
  height: auto;
  /* Changed to auto to autogrow */
  background: none;
  /* Changed from white to allow our bg to show through */
}
.CodeMirror-scroll {
  /*  The CodeMirror docs are a bit fuzzy on if overflow-y should be hidden or visible.*/
  /*  We have found that if it is visible, vertical scrollbars appear with font size changes.*/
  overflow-y: hidden;
  overflow-x: auto;
}
.CodeMirror-lines {
  /* In CM2, this used to be 0.4em, but in CM3 it went to 4px. We need the em value because */
  /* we have set a different line-height and want this to scale with that. */
  padding: 0.4em;
}
.CodeMirror-linenumber {
  padding: 0 8px 0 4px;
}
.CodeMirror-gutters {
  border-bottom-left-radius: 2px;
  border-top-left-radius: 2px;
}
.CodeMirror pre {
  /* In CM3 this went to 4px from 0 in CM2. We need the 0 value because of how we size */
  /* .CodeMirror-lines */
  padding: 0;
  border: 0;
  border-radius: 0;
}
/*

Original style from softwaremaniacs.org (c) Ivan Sagalaev <Maniac@SoftwareManiacs.Org>
Adapted from GitHub theme

*/
.highlight-base {
  color: #000;
}
.highlight-variable {
  color: #000;
}
.highlight-variable-2 {
  color: #1a1a1a;
}
.highlight-variable-3 {
  color: #333333;
}
.highlight-string {
  color: #BA2121;
}
.highlight-comment {
  color: #408080;
  font-style: italic;
}
.highlight-number {
  color: #080;
}
.highlight-atom {
  color: #88F;
}
.highlight-keyword {
  color: #008000;
  font-weight: bold;
}
.highlight-builtin {
  color: #008000;
}
.highlight-error {
  color: #f00;
}
.highlight-operator {
  color: #AA22FF;
  font-weight: bold;
}
.highlight-meta {
  color: #AA22FF;
}
/* previously not defined, copying from default codemirror */
.highlight-def {
  color: #00f;
}
.highlight-string-2 {
  color: #f50;
}
.highlight-qualifier {
  color: #555;
}
.highlight-bracket {
  color: #997;
}
.highlight-tag {
  color: #170;
}
.highlight-attribute {
  color: #00c;
}
.highlight-header {
  color: blue;
}
.highlight-quote {
  color: #090;
}
.highlight-link {
  color: #00c;
}
/* apply the same style to codemirror */
.cm-s-ipython span.cm-keyword {
  color: #008000;
  font-weight: bold;
}
.cm-s-ipython span.cm-atom {
  color: #88F;
}
.cm-s-ipython span.cm-number {
  color: #080;
}
.cm-s-ipython span.cm-def {
  color: #00f;
}
.cm-s-ipython span.cm-variable {
  color: #000;
}
.cm-s-ipython span.cm-operator {
  color: #AA22FF;
  font-weight: bold;
}
.cm-s-ipython span.cm-variable-2 {
  color: #1a1a1a;
}
.cm-s-ipython span.cm-variable-3 {
  color: #333333;
}
.cm-s-ipython span.cm-comment {
  color: #408080;
  font-style: italic;
}
.cm-s-ipython span.cm-string {
  color: #BA2121;
}
.cm-s-ipython span.cm-string-2 {
  color: #f50;
}
.cm-s-ipython span.cm-meta {
  color: #AA22FF;
}
.cm-s-ipython span.cm-qualifier {
  color: #555;
}
.cm-s-ipython span.cm-builtin {
  color: #008000;
}
.cm-s-ipython span.cm-bracket {
  color: #997;
}
.cm-s-ipython span.cm-tag {
  color: #170;
}
.cm-s-ipython span.cm-attribute {
  color: #00c;
}
.cm-s-ipython span.cm-header {
  color: blue;
}
.cm-s-ipython span.cm-quote {
  color: #090;
}
.cm-s-ipython span.cm-link {
  color: #00c;
}
.cm-s-ipython span.cm-error {
  color: #f00;
}
.cm-s-ipython span.cm-tab {
  background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAMCAYAAAAkuj5RAAAAAXNSR0IArs4c6QAAAGFJREFUSMft1LsRQFAQheHPowAKoACx3IgEKtaEHujDjORSgWTH/ZOdnZOcM/sgk/kFFWY0qV8foQwS4MKBCS3qR6ixBJvElOobYAtivseIE120FaowJPN75GMu8j/LfMwNjh4HUpwg4LUAAAAASUVORK5CYII=);
  background-position: right;
  background-repeat: no-repeat;
}
div.output_wrapper {
  /* this position must be relative to enable descendents to be absolute within it */
  position: relative;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
  z-index: 1;
}
/* class for the output area when it should be height-limited */
div.output_scroll {
  /* ideally, this would be max-height, but FF barfs all over that */
  height: 24em;
  /* FF needs this *and the wrapper* to specify full width, or it will shrinkwrap */
  width: 100%;
  overflow: auto;
  border-radius: 2px;
  -webkit-box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8);
  box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8);
  display: block;
}
/* output div while it is collapsed */
div.output_collapsed {
  margin: 0px;
  padding: 0px;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
}
div.out_prompt_overlay {
  height: 100%;
  padding: 0px 0.4em;
  position: absolute;
  border-radius: 2px;
}
div.out_prompt_overlay:hover {
  /* use inner shadow to get border that is computed the same on WebKit/FF */
  -webkit-box-shadow: inset 0 0 1px #000;
  box-shadow: inset 0 0 1px #000;
  background: rgba(240, 240, 240, 0.5);
}
div.output_prompt {
  color: #D84315;
}
/* This class is the outer container of all output sections. */
div.output_area {
  padding: 0px;
  page-break-inside: avoid;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
div.output_area .MathJax_Display {
  text-align: left !important;
}
div.output_area .rendered_html table {
  margin-left: 0;
  margin-right: 0;
}
div.output_area .rendered_html img {
  margin-left: 0;
  margin-right: 0;
}
div.output_area img,
div.output_area svg {
  max-width: 100%;
  height: auto;
}
div.output_area img.unconfined,
div.output_area svg.unconfined {
  max-width: none;
}
/* This is needed to protect the pre formating from global settings such
   as that of bootstrap */
.output {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
}
@media (max-width: 540px) {
  div.output_area {
    /* Old browsers */
    display: -webkit-box;
    -webkit-box-orient: vertical;
    -webkit-box-align: stretch;
    display: -moz-box;
    -moz-box-orient: vertical;
    -moz-box-align: stretch;
    display: box;
    box-orient: vertical;
    box-align: stretch;
    /* Modern browsers */
    display: flex;
    flex-direction: column;
    align-items: stretch;
  }
}
div.output_area pre {
  margin: 0;
  padding: 0;
  border: 0;
  vertical-align: baseline;
  color: black;
  background-color: transparent;
  border-radius: 0;
}
/* This class is for the output subarea inside the output_area and after
   the prompt div. */
div.output_subarea {
  overflow-x: auto;
  padding: 0.4em;
  /* Old browsers */
  -webkit-box-flex: 1;
  -moz-box-flex: 1;
  box-flex: 1;
  /* Modern browsers */
  flex: 1;
  max-width: calc(100% - 14ex);
}
div.output_scroll div.output_subarea {
  overflow-x: visible;
}
/* The rest of the output_* classes are for special styling of the different
   output types */
/* all text output has this class: */
div.output_text {
  text-align: left;
  color: #000;
  /* This has to match that of the the CodeMirror class line-height below */
  line-height: 1.21429em;
}
/* stdout/stderr are 'text' as well as 'stream', but execute_result/error are *not* streams */
div.output_stderr {
  background: #fdd;
  /* very light red background for stderr */
}
div.output_latex {
  text-align: left;
}
/* Empty output_javascript divs should have no height */
div.output_javascript:empty {
  padding: 0;
}
.js-error {
  color: darkred;
}
/* raw_input styles */
div.raw_input_container {
  line-height: 1.21429em;
  padding-top: 5px;
}
pre.raw_input_prompt {
  /* nothing needed here. */
}
input.raw_input {
  font-family: monospace;
  font-size: inherit;
  color: inherit;
  width: auto;
  /* make sure input baseline aligns with prompt */
  vertical-align: baseline;
  /* padding + margin = 0.5em between prompt and cursor */
  padding: 0em 0.25em;
  margin: 0em 0.25em;
}
input.raw_input:focus {
  box-shadow: none;
}
p.p-space {
  margin-bottom: 10px;
}
div.output_unrecognized {
  padding: 5px;
  font-weight: bold;
  color: red;
}
div.output_unrecognized a {
  color: inherit;
  text-decoration: none;
}
div.output_unrecognized a:hover {
  color: inherit;
  text-decoration: none;
}
.rendered_html {
  color: #000;
  /* any extras will just be numbers: */
}
.rendered_html em {
  font-style: italic;
}
.rendered_html strong {
  font-weight: bold;
}
.rendered_html u {
  text-decoration: underline;
}
.rendered_html :link {
  text-decoration: underline;
}
.rendered_html :visited {
  text-decoration: underline;
}
.rendered_html h1 {
  font-size: 185.7%;
  margin: 1.08em 0 0 0;
  font-weight: bold;
  line-height: 1.0;
}
.rendered_html h2 {
  font-size: 157.1%;
  margin: 1.27em 0 0 0;
  font-weight: bold;
  line-height: 1.0;
}
.rendered_html h3 {
  font-size: 128.6%;
  margin: 1.55em 0 0 0;
  font-weight: bold;
  line-height: 1.0;
}
.rendered_html h4 {
  font-size: 100%;
  margin: 2em 0 0 0;
  font-weight: bold;
  line-height: 1.0;
}
.rendered_html h5 {
  font-size: 100%;
  margin: 2em 0 0 0;
  font-weight: bold;
  line-height: 1.0;
  font-style: italic;
}
.rendered_html h6 {
  font-size: 100%;
  margin: 2em 0 0 0;
  font-weight: bold;
  line-height: 1.0;
  font-style: italic;
}
.rendered_html h1:first-child {
  margin-top: 0.538em;
}
.rendered_html h2:first-child {
  margin-top: 0.636em;
}
.rendered_html h3:first-child {
  margin-top: 0.777em;
}
.rendered_html h4:first-child {
  margin-top: 1em;
}
.rendered_html h5:first-child {
  margin-top: 1em;
}
.rendered_html h6:first-child {
  margin-top: 1em;
}
.rendered_html ul {
  list-style: disc;
  margin: 0em 2em;
  padding-left: 0px;
}
.rendered_html ul ul {
  list-style: square;
  margin: 0em 2em;
}
.rendered_html ul ul ul {
  list-style: circle;
  margin: 0em 2em;
}
.rendered_html ol {
  list-style: decimal;
  margin: 0em 2em;
  padding-left: 0px;
}
.rendered_html ol ol {
  list-style: upper-alpha;
  margin: 0em 2em;
}
.rendered_html ol ol ol {
  list-style: lower-alpha;
  margin: 0em 2em;
}
.rendered_html ol ol ol ol {
  list-style: lower-roman;
  margin: 0em 2em;
}
.rendered_html ol ol ol ol ol {
  list-style: decimal;
  margin: 0em 2em;
}
.rendered_html * + ul {
  margin-top: 1em;
}
.rendered_html * + ol {
  margin-top: 1em;
}
.rendered_html hr {
  color: black;
  background-color: black;
}
.rendered_html pre {
  margin: 1em 2em;
}
.rendered_html pre,
.rendered_html code {
  border: 0;
  background-color: #fff;
  color: #000;
  font-size: 100%;
  padding: 0px;
}
.rendered_html blockquote {
  margin: 1em 2em;
}
.rendered_html table {
  margin-left: auto;
  margin-right: auto;
  border: 1px solid black;
  border-collapse: collapse;
}
.rendered_html tr,
.rendered_html th,
.rendered_html td {
  border: 1px solid black;
  border-collapse: collapse;
  margin: 1em 2em;
}
.rendered_html td,
.rendered_html th {
  text-align: left;
  vertical-align: middle;
  padding: 4px;
}
.rendered_html th {
  font-weight: bold;
}
.rendered_html * + table {
  margin-top: 1em;
}
.rendered_html p {
  text-align: left;
}
.rendered_html * + p {
  margin-top: 1em;
}
.rendered_html img {
  display: block;
  margin-left: auto;
  margin-right: auto;
}
.rendered_html * + img {
  margin-top: 1em;
}
.rendered_html img,
.rendered_html svg {
  max-width: 100%;
  height: auto;
}
.rendered_html img.unconfined,
.rendered_html svg.unconfined {
  max-width: none;
}
div.text_cell {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
@media (max-width: 540px) {
  div.text_cell > div.prompt {
    display: none;
  }
}
div.text_cell_render {
  /*font-family: "Helvetica Neue", Arial, Helvetica, Geneva, sans-serif;*/
  outline: none;
  resize: none;
  width: inherit;
  border-style: none;
  padding: 0.5em 0.5em 0.5em 0.4em;
  color: #000;
  box-sizing: border-box;
  -moz-box-sizing: border-box;
  -webkit-box-sizing: border-box;
}
a.anchor-link:link {
  text-decoration: none;
  padding: 0px 20px;
  visibility: hidden;
}
h1:hover .anchor-link,
h2:hover .anchor-link,
h3:hover .anchor-link,
h4:hover .anchor-link,
h5:hover .anchor-link,
h6:hover .anchor-link {
  visibility: visible;
}
.text_cell.rendered .input_area {
  display: none;
}
.text_cell.rendered .rendered_html {
  overflow-x: auto;
  overflow-y: hidden;
}
.text_cell.unrendered .text_cell_render {
  display: none;
}
.cm-header-1,
.cm-header-2,
.cm-header-3,
.cm-header-4,
.cm-header-5,
.cm-header-6 {
  font-weight: bold;
  font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
}
.cm-header-1 {
  font-size: 185.7%;
}
.cm-header-2 {
  font-size: 157.1%;
}
.cm-header-3 {
  font-size: 128.6%;
}
.cm-header-4 {
  font-size: 110%;
}
.cm-header-5 {
  font-size: 100%;
  font-style: italic;
}
.cm-header-6 {
  font-size: 100%;
  font-style: italic;
}
/*!
*
* IPython notebook webapp
*
*/
@media (max-width: 767px) {
  .notebook_app {
    padding-left: 0px;
    padding-right: 0px;
  }
}
#ipython-main-app {
  box-sizing: border-box;
  -moz-box-sizing: border-box;
  -webkit-box-sizing: border-box;
  height: 100%;
}
div#notebook_panel {
  margin: 0px;
  padding: 0px;
  box-sizing: border-box;
  -moz-box-sizing: border-box;
  -webkit-box-sizing: border-box;
  height: 100%;
}
div#notebook {
  font-size: 14px;
  line-height: 20px;
  overflow-y: hidden;
  overflow-x: auto;
  width: 100%;
  /* This spaces the page away from the edge of the notebook area */
  padding-top: 20px;
  margin: 0px;
  outline: none;
  box-sizing: border-box;
  -moz-box-sizing: border-box;
  -webkit-box-sizing: border-box;
  min-height: 100%;
}
@media not print {
  #notebook-container {
    padding: 15px;
    background-color: #fff;
    min-height: 0;
    -webkit-box-shadow: 0px 0px 12px 1px rgba(87, 87, 87, 0.2);
    box-shadow: 0px 0px 12px 1px rgba(87, 87, 87, 0.2);
  }
}
@media print {
  #notebook-container {
    width: 100%;
  }
}
div.ui-widget-content {
  border: 1px solid #ababab;
  outline: none;
}
pre.dialog {
  background-color: #f7f7f7;
  border: 1px solid #ddd;
  border-radius: 2px;
  padding: 0.4em;
  padding-left: 2em;
}
p.dialog {
  padding: 0.2em;
}
/* Word-wrap output correctly.  This is the CSS3 spelling, though Firefox seems
   to not honor it correctly.  Webkit browsers (Chrome, rekonq, Safari) do.
 */
pre,
code,
kbd,
samp {
  white-space: pre-wrap;
}
#fonttest {
  font-family: monospace;
}
p {
  margin-bottom: 0;
}
.end_space {
  min-height: 100px;
  transition: height .2s ease;
}
.notebook_app > #header {
  -webkit-box-shadow: 0px 0px 12px 1px rgba(87, 87, 87, 0.2);
  box-shadow: 0px 0px 12px 1px rgba(87, 87, 87, 0.2);
}
@media not print {
  .notebook_app {
    background-color: #EEE;
  }
}
kbd {
  border-style: solid;
  border-width: 1px;
  box-shadow: none;
  margin: 2px;
  padding-left: 2px;
  padding-right: 2px;
  padding-top: 1px;
  padding-bottom: 1px;
}
/* CSS for the cell toolbar */
.celltoolbar {
  border: thin solid #CFCFCF;
  border-bottom: none;
  background: #EEE;
  border-radius: 2px 2px 0px 0px;
  width: 100%;
  height: 29px;
  padding-right: 4px;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
  /* Old browsers */
  -webkit-box-pack: end;
  -moz-box-pack: end;
  box-pack: end;
  /* Modern browsers */
  justify-content: flex-end;
  display: -webkit-flex;
}
@media print {
  .celltoolbar {
    display: none;
  }
}
.ctb_hideshow {
  display: none;
  vertical-align: bottom;
}
/* ctb_show is added to the ctb_hideshow div to show the cell toolbar.
   Cell toolbars are only shown when the ctb_global_show class is also set.
*/
.ctb_global_show .ctb_show.ctb_hideshow {
  display: block;
}
.ctb_global_show .ctb_show + .input_area,
.ctb_global_show .ctb_show + div.text_cell_input,
.ctb_global_show .ctb_show ~ div.text_cell_render {
  border-top-right-radius: 0px;
  border-top-left-radius: 0px;
}
.ctb_global_show .ctb_show ~ div.text_cell_render {
  border: 1px solid #cfcfcf;
}
.celltoolbar {
  font-size: 87%;
  padding-top: 3px;
}
.celltoolbar select {
  display: block;
  width: 100%;
  height: 32px;
  padding: 6px 12px;
  font-size: 13px;
  line-height: 1.42857143;
  color: #555555;
  background-color: #fff;
  background-image: none;
  border: 1px solid #ccc;
  border-radius: 2px;
  -webkit-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075);
  box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075);
  -webkit-transition: border-color ease-in-out .15s, box-shadow ease-in-out .15s;
  -o-transition: border-color ease-in-out .15s, box-shadow ease-in-out .15s;
  transition: border-color ease-in-out .15s, box-shadow ease-in-out .15s;
  height: 30px;
  padding: 5px 10px;
  font-size: 12px;
  line-height: 1.5;
  border-radius: 1px;
  width: inherit;
  font-size: inherit;
  height: 22px;
  padding: 0px;
  display: inline-block;
}
.celltoolbar select:focus {
  border-color: #66afe9;
  outline: 0;
  -webkit-box-shadow: inset 0 1px 1px rgba(0,0,0,.075), 0 0 8px rgba(102, 175, 233, 0.6);
  box-shadow: inset 0 1px 1px rgba(0,0,0,.075), 0 0 8px rgba(102, 175, 233, 0.6);
}
.celltoolbar select::-moz-placeholder {
  color: #999;
  opacity: 1;
}
.celltoolbar select:-ms-input-placeholder {
  color: #999;
}
.celltoolbar select::-webkit-input-placeholder {
  color: #999;
}
.celltoolbar select::-ms-expand {
  border: 0;
  background-color: transparent;
}
.celltoolbar select[disabled],
.celltoolbar select[readonly],
fieldset[disabled] .celltoolbar select {
  background-color: #eeeeee;
  opacity: 1;
}
.celltoolbar select[disabled],
fieldset[disabled] .celltoolbar select {
  cursor: not-allowed;
}
textarea.celltoolbar select {
  height: auto;
}
select.celltoolbar select {
  height: 30px;
  line-height: 30px;
}
textarea.celltoolbar select,
select[multiple].celltoolbar select {
  height: auto;
}
.celltoolbar label {
  margin-left: 5px;
  margin-right: 5px;
}
.completions {
  position: absolute;
  z-index: 110;
  overflow: hidden;
  border: 1px solid #ababab;
  border-radius: 2px;
  -webkit-box-shadow: 0px 6px 10px -1px #adadad;
  box-shadow: 0px 6px 10px -1px #adadad;
  line-height: 1;
}
.completions select {
  background: white;
  outline: none;
  border: none;
  padding: 0px;
  margin: 0px;
  overflow: auto;
  font-family: monospace;
  font-size: 110%;
  color: #000;
  width: auto;
}
.completions select option.context {
  color: #286090;
}
#kernel_logo_widget {
  float: right !important;
  float: right;
}
#kernel_logo_widget .current_kernel_logo {
  display: none;
  margin-top: -1px;
  margin-bottom: -1px;
  width: 32px;
  height: 32px;
}
#menubar {
  box-sizing: border-box;
  -moz-box-sizing: border-box;
  -webkit-box-sizing: border-box;
  margin-top: 1px;
}
#menubar .navbar {
  border-top: 1px;
  border-radius: 0px 0px 2px 2px;
  margin-bottom: 0px;
}
#menubar .navbar-toggle {
  float: left;
  padding-top: 7px;
  padding-bottom: 7px;
  border: none;
}
#menubar .navbar-collapse {
  clear: left;
}
.nav-wrapper {
  border-bottom: 1px solid #e7e7e7;
}
i.menu-icon {
  padding-top: 4px;
}
ul#help_menu li a {
  overflow: hidden;
  padding-right: 2.2em;
}
ul#help_menu li a i {
  margin-right: -1.2em;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu > .dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
}
.dropdown-submenu:hover > .dropdown-menu {
  display: block;
}
.dropdown-submenu > a:after {
  display: inline-block;
  font: normal normal normal 14px/1 FontAwesome;
  font-size: inherit;
  text-rendering: auto;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  display: block;
  content: "\f0da";
  float: right;
  color: #333333;
  margin-top: 2px;
  margin-right: -10px;
}
.dropdown-submenu > a:after.pull-left {
  margin-right: .3em;
}
.dropdown-submenu > a:after.pull-right {
  margin-left: .3em;
}
.dropdown-submenu:hover > a:after {
  color: #262626;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left > .dropdown-menu {
  left: -100%;
  margin-left: 10px;
}
#notification_area {
  float: right !important;
  float: right;
  z-index: 10;
}
.indicator_area {
  float: right !important;
  float: right;
  color: #777;
  margin-left: 5px;
  margin-right: 5px;
  width: 11px;
  z-index: 10;
  text-align: center;
  width: auto;
}
#kernel_indicator {
  float: right !important;
  float: right;
  color: #777;
  margin-left: 5px;
  margin-right: 5px;
  width: 11px;
  z-index: 10;
  text-align: center;
  width: auto;
  border-left: 1px solid;
}
#kernel_indicator .kernel_indicator_name {
  padding-left: 5px;
  padding-right: 5px;
}
#modal_indicator {
  float: right !important;
  float: right;
  color: #777;
  margin-left: 5px;
  margin-right: 5px;
  width: 11px;
  z-index: 10;
  text-align: center;
  width: auto;
}
#readonly-indicator {
  float: right !important;
  float: right;
  color: #777;
  margin-left: 5px;
  margin-right: 5px;
  width: 11px;
  z-index: 10;
  text-align: center;
  width: auto;
  margin-top: 2px;
  margin-bottom: 0px;
  margin-left: 0px;
  margin-right: 0px;
  display: none;
}
.modal_indicator:before {
  width: 1.28571429em;
  text-align: center;
}
.edit_mode .modal_indicator:before {
  display: inline-block;
  font: normal normal normal 14px/1 FontAwesome;
  font-size: inherit;
  text-rendering: auto;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  content: "\f040";
}
.edit_mode .modal_indicator:before.pull-left {
  margin-right: .3em;
}
.edit_mode .modal_indicator:before.pull-right {
  margin-left: .3em;
}
.command_mode .modal_indicator:before {
  display: inline-block;
  font: normal normal normal 14px/1 FontAwesome;
  font-size: inherit;
  text-rendering: auto;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  content: ' ';
}
.command_mode .modal_indicator:before.pull-left {
  margin-right: .3em;
}
.command_mode .modal_indicator:before.pull-right {
  margin-left: .3em;
}
.kernel_idle_icon:before {
  display: inline-block;
  font: normal normal normal 14px/1 FontAwesome;
  font-size: inherit;
  text-rendering: auto;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  content: "\f10c";
}
.kernel_idle_icon:before.pull-left {
  margin-right: .3em;
}
.kernel_idle_icon:before.pull-right {
  margin-left: .3em;
}
.kernel_busy_icon:before {
  display: inline-block;
  font: normal normal normal 14px/1 FontAwesome;
  font-size: inherit;
  text-rendering: auto;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  content: "\f111";
}
.kernel_busy_icon:before.pull-left {
  margin-right: .3em;
}
.kernel_busy_icon:before.pull-right {
  margin-left: .3em;
}
.kernel_dead_icon:before {
  display: inline-block;
  font: normal normal normal 14px/1 FontAwesome;
  font-size: inherit;
  text-rendering: auto;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  content: "\f1e2";
}
.kernel_dead_icon:before.pull-left {
  margin-right: .3em;
}
.kernel_dead_icon:before.pull-right {
  margin-left: .3em;
}
.kernel_disconnected_icon:before {
  display: inline-block;
  font: normal normal normal 14px/1 FontAwesome;
  font-size: inherit;
  text-rendering: auto;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  content: "\f127";
}
.kernel_disconnected_icon:before.pull-left {
  margin-right: .3em;
}
.kernel_disconnected_icon:before.pull-right {
  margin-left: .3em;
}
.notification_widget {
  color: #777;
  z-index: 10;
  background: rgba(240, 240, 240, 0.5);
  margin-right: 4px;
  color: #333;
  background-color: #fff;
  border-color: #ccc;
}
.notification_widget:focus,
.notification_widget.focus {
  color: #333;
  background-color: #e6e6e6;
  border-color: #8c8c8c;
}
.notification_widget:hover {
  color: #333;
  background-color: #e6e6e6;
  border-color: #adadad;
}
.notification_widget:active,
.notification_widget.active,
.open > .dropdown-toggle.notification_widget {
  color: #333;
  background-color: #e6e6e6;
  border-color: #adadad;
}
.notification_widget:active:hover,
.notification_widget.active:hover,
.open > .dropdown-toggle.notification_widget:hover,
.notification_widget:active:focus,
.notification_widget.active:focus,
.open > .dropdown-toggle.notification_widget:focus,
.notification_widget:active.focus,
.notification_widget.active.focus,
.open > .dropdown-toggle.notification_widget.focus {
  color: #333;
  background-color: #d4d4d4;
  border-color: #8c8c8c;
}
.notification_widget:active,
.notification_widget.active,
.open > .dropdown-toggle.notification_widget {
  background-image: none;
}
.notification_widget.disabled:hover,
.notification_widget[disabled]:hover,
fieldset[disabled] .notification_widget:hover,
.notification_widget.disabled:focus,
.notification_widget[disabled]:focus,
fieldset[disabled] .notification_widget:focus,
.notification_widget.disabled.focus,
.notification_widget[disabled].focus,
fieldset[disabled] .notification_widget.focus {
  background-color: #fff;
  border-color: #ccc;
}
.notification_widget .badge {
  color: #fff;
  background-color: #333;
}
.notification_widget.warning {
  color: #fff;
  background-color: #f0ad4e;
  border-color: #eea236;
}
.notification_widget.warning:focus,
.notification_widget.warning.focus {
  color: #fff;
  background-color: #ec971f;
  border-color: #985f0d;
}
.notification_widget.warning:hover {
  color: #fff;
  background-color: #ec971f;
  border-color: #d58512;
}
.notification_widget.warning:active,
.notification_widget.warning.active,
.open > .dropdown-toggle.notification_widget.warning {
  color: #fff;
  background-color: #ec971f;
  border-color: #d58512;
}
.notification_widget.warning:active:hover,
.notification_widget.warning.active:hover,
.open > .dropdown-toggle.notification_widget.warning:hover,
.notification_widget.warning:active:focus,
.notification_widget.warning.active:focus,
.open > .dropdown-toggle.notification_widget.warning:focus,
.notification_widget.warning:active.focus,
.notification_widget.warning.active.focus,
.open > .dropdown-toggle.notification_widget.warning.focus {
  color: #fff;
  background-color: #d58512;
  border-color: #985f0d;
}
.notification_widget.warning:active,
.notification_widget.warning.active,
.open > .dropdown-toggle.notification_widget.warning {
  background-image: none;
}
.notification_widget.warning.disabled:hover,
.notification_widget.warning[disabled]:hover,
fieldset[disabled] .notification_widget.warning:hover,
.notification_widget.warning.disabled:focus,
.notification_widget.warning[disabled]:focus,
fieldset[disabled] .notification_widget.warning:focus,
.notification_widget.warning.disabled.focus,
.notification_widget.warning[disabled].focus,
fieldset[disabled] .notification_widget.warning.focus {
  background-color: #f0ad4e;
  border-color: #eea236;
}
.notification_widget.warning .badge {
  color: #f0ad4e;
  background-color: #fff;
}
.notification_widget.success {
  color: #fff;
  background-color: #5cb85c;
  border-color: #4cae4c;
}
.notification_widget.success:focus,
.notification_widget.success.focus {
  color: #fff;
  background-color: #449d44;
  border-color: #255625;
}
.notification_widget.success:hover {
  color: #fff;
  background-color: #449d44;
  border-color: #398439;
}
.notification_widget.success:active,
.notification_widget.success.active,
.open > .dropdown-toggle.notification_widget.success {
  color: #fff;
  background-color: #449d44;
  border-color: #398439;
}
.notification_widget.success:active:hover,
.notification_widget.success.active:hover,
.open > .dropdown-toggle.notification_widget.success:hover,
.notification_widget.success:active:focus,
.notification_widget.success.active:focus,
.open > .dropdown-toggle.notification_widget.success:focus,
.notification_widget.success:active.focus,
.notification_widget.success.active.focus,
.open > .dropdown-toggle.notification_widget.success.focus {
  color: #fff;
  background-color: #398439;
  border-color: #255625;
}
.notification_widget.success:active,
.notification_widget.success.active,
.open > .dropdown-toggle.notification_widget.success {
  background-image: none;
}
.notification_widget.success.disabled:hover,
.notification_widget.success[disabled]:hover,
fieldset[disabled] .notification_widget.success:hover,
.notification_widget.success.disabled:focus,
.notification_widget.success[disabled]:focus,
fieldset[disabled] .notification_widget.success:focus,
.notification_widget.success.disabled.focus,
.notification_widget.success[disabled].focus,
fieldset[disabled] .notification_widget.success.focus {
  background-color: #5cb85c;
  border-color: #4cae4c;
}
.notification_widget.success .badge {
  color: #5cb85c;
  background-color: #fff;
}
.notification_widget.info {
  color: #fff;
  background-color: #5bc0de;
  border-color: #46b8da;
}
.notification_widget.info:focus,
.notification_widget.info.focus {
  color: #fff;
  background-color: #31b0d5;
  border-color: #1b6d85;
}
.notification_widget.info:hover {
  color: #fff;
  background-color: #31b0d5;
  border-color: #269abc;
}
.notification_widget.info:active,
.notification_widget.info.active,
.open > .dropdown-toggle.notification_widget.info {
  color: #fff;
  background-color: #31b0d5;
  border-color: #269abc;
}
.notification_widget.info:active:hover,
.notification_widget.info.active:hover,
.open > .dropdown-toggle.notification_widget.info:hover,
.notification_widget.info:active:focus,
.notification_widget.info.active:focus,
.open > .dropdown-toggle.notification_widget.info:focus,
.notification_widget.info:active.focus,
.notification_widget.info.active.focus,
.open > .dropdown-toggle.notification_widget.info.focus {
  color: #fff;
  background-color: #269abc;
  border-color: #1b6d85;
}
.notification_widget.info:active,
.notification_widget.info.active,
.open > .dropdown-toggle.notification_widget.info {
  background-image: none;
}
.notification_widget.info.disabled:hover,
.notification_widget.info[disabled]:hover,
fieldset[disabled] .notification_widget.info:hover,
.notification_widget.info.disabled:focus,
.notification_widget.info[disabled]:focus,
fieldset[disabled] .notification_widget.info:focus,
.notification_widget.info.disabled.focus,
.notification_widget.info[disabled].focus,
fieldset[disabled] .notification_widget.info.focus {
  background-color: #5bc0de;
  border-color: #46b8da;
}
.notification_widget.info .badge {
  color: #5bc0de;
  background-color: #fff;
}
.notification_widget.danger {
  color: #fff;
  background-color: #d9534f;
  border-color: #d43f3a;
}
.notification_widget.danger:focus,
.notification_widget.danger.focus {
  color: #fff;
  background-color: #c9302c;
  border-color: #761c19;
}
.notification_widget.danger:hover {
  color: #fff;
  background-color: #c9302c;
  border-color: #ac2925;
}
.notification_widget.danger:active,
.notification_widget.danger.active,
.open > .dropdown-toggle.notification_widget.danger {
  color: #fff;
  background-color: #c9302c;
  border-color: #ac2925;
}
.notification_widget.danger:active:hover,
.notification_widget.danger.active:hover,
.open > .dropdown-toggle.notification_widget.danger:hover,
.notification_widget.danger:active:focus,
.notification_widget.danger.active:focus,
.open > .dropdown-toggle.notification_widget.danger:focus,
.notification_widget.danger:active.focus,
.notification_widget.danger.active.focus,
.open > .dropdown-toggle.notification_widget.danger.focus {
  color: #fff;
  background-color: #ac2925;
  border-color: #761c19;
}
.notification_widget.danger:active,
.notification_widget.danger.active,
.open > .dropdown-toggle.notification_widget.danger {
  background-image: none;
}
.notification_widget.danger.disabled:hover,
.notification_widget.danger[disabled]:hover,
fieldset[disabled] .notification_widget.danger:hover,
.notification_widget.danger.disabled:focus,
.notification_widget.danger[disabled]:focus,
fieldset[disabled] .notification_widget.danger:focus,
.notification_widget.danger.disabled.focus,
.notification_widget.danger[disabled].focus,
fieldset[disabled] .notification_widget.danger.focus {
  background-color: #d9534f;
  border-color: #d43f3a;
}
.notification_widget.danger .badge {
  color: #d9534f;
  background-color: #fff;
}
div#pager {
  background-color: #fff;
  font-size: 14px;
  line-height: 20px;
  overflow: hidden;
  display: none;
  position: fixed;
  bottom: 0px;
  width: 100%;
  max-height: 50%;
  padding-top: 8px;
  -webkit-box-shadow: 0px 0px 12px 1px rgba(87, 87, 87, 0.2);
  box-shadow: 0px 0px 12px 1px rgba(87, 87, 87, 0.2);
  /* Display over codemirror */
  z-index: 100;
  /* Hack which prevents jquery ui resizable from changing top. */
  top: auto !important;
}
div#pager pre {
  line-height: 1.21429em;
  color: #000;
  background-color: #f7f7f7;
  padding: 0.4em;
}
div#pager #pager-button-area {
  position: absolute;
  top: 8px;
  right: 20px;
}
div#pager #pager-contents {
  position: relative;
  overflow: auto;
  width: 100%;
  height: 100%;
}
div#pager #pager-contents #pager-container {
  position: relative;
  padding: 15px 0px;
  box-sizing: border-box;
  -moz-box-sizing: border-box;
  -webkit-box-sizing: border-box;
}
div#pager .ui-resizable-handle {
  top: 0px;
  height: 8px;
  background: #f7f7f7;
  border-top: 1px solid #cfcfcf;
  border-bottom: 1px solid #cfcfcf;
  /* This injects handle bars (a short, wide = symbol) for 
        the resize handle. */
}
div#pager .ui-resizable-handle::after {
  content: '';
  top: 2px;
  left: 50%;
  height: 3px;
  width: 30px;
  margin-left: -15px;
  position: absolute;
  border-top: 1px solid #cfcfcf;
}
.quickhelp {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
  line-height: 1.8em;
}
.shortcut_key {
  display: inline-block;
  width: 21ex;
  text-align: right;
  font-family: monospace;
}
.shortcut_descr {
  display: inline-block;
  /* Old browsers */
  -webkit-box-flex: 1;
  -moz-box-flex: 1;
  box-flex: 1;
  /* Modern browsers */
  flex: 1;
}
span.save_widget {
  margin-top: 6px;
}
span.save_widget span.filename {
  height: 1em;
  line-height: 1em;
  padding: 3px;
  margin-left: 16px;
  border: none;
  font-size: 146.5%;
  border-radius: 2px;
}
span.save_widget span.filename:hover {
  background-color: #e6e6e6;
}
span.checkpoint_status,
span.autosave_status {
  font-size: small;
}
@media (max-width: 767px) {
  span.save_widget {
    font-size: small;
  }
  span.checkpoint_status,
  span.autosave_status {
    display: none;
  }
}
@media (min-width: 768px) and (max-width: 991px) {
  span.checkpoint_status {
    display: none;
  }
  span.autosave_status {
    font-size: x-small;
  }
}
.toolbar {
  padding: 0px;
  margin-left: -5px;
  margin-top: 2px;
  margin-bottom: 5px;
  box-sizing: border-box;
  -moz-box-sizing: border-box;
  -webkit-box-sizing: border-box;
}
.toolbar select,
.toolbar label {
  width: auto;
  vertical-align: middle;
  margin-right: 2px;
  margin-bottom: 0px;
  display: inline;
  font-size: 92%;
  margin-left: 0.3em;
  margin-right: 0.3em;
  padding: 0px;
  padding-top: 3px;
}
.toolbar .btn {
  padding: 2px 8px;
}
.toolbar .btn-group {
  margin-top: 0px;
  margin-left: 5px;
}
#maintoolbar {
  margin-bottom: -3px;
  margin-top: -8px;
  border: 0px;
  min-height: 27px;
  margin-left: 0px;
  padding-top: 11px;
  padding-bottom: 3px;
}
#maintoolbar .navbar-text {
  float: none;
  vertical-align: middle;
  text-align: right;
  margin-left: 5px;
  margin-right: 0px;
  margin-top: 0px;
}
.select-xs {
  height: 24px;
}
.pulse,
.dropdown-menu > li > a.pulse,
li.pulse > a.dropdown-toggle,
li.pulse.open > a.dropdown-toggle {
  background-color: #F37626;
  color: white;
}
/**
 * Primary styles
 *
 * Author: Jupyter Development Team
 */
/** WARNING IF YOU ARE EDITTING THIS FILE, if this is a .css file, It has a lot
 * of chance of beeing generated from the ../less/[samename].less file, you can
 * try to get back the less file by reverting somme commit in history
 **/
/*
 * We'll try to get something pretty, so we
 * have some strange css to have the scroll bar on
 * the left with fix button on the top right of the tooltip
 */
@-moz-keyframes fadeOut {
  from {
    opacity: 1;
  }
  to {
    opacity: 0;
  }
}
@-webkit-keyframes fadeOut {
  from {
    opacity: 1;
  }
  to {
    opacity: 0;
  }
}
@-moz-keyframes fadeIn {
  from {
    opacity: 0;
  }
  to {
    opacity: 1;
  }
}
@-webkit-keyframes fadeIn {
  from {
    opacity: 0;
  }
  to {
    opacity: 1;
  }
}
/*properties of tooltip after "expand"*/
.bigtooltip {
  overflow: auto;
  height: 200px;
  -webkit-transition-property: height;
  -webkit-transition-duration: 500ms;
  -moz-transition-property: height;
  -moz-transition-duration: 500ms;
  transition-property: height;
  transition-duration: 500ms;
}
/*properties of tooltip before "expand"*/
.smalltooltip {
  -webkit-transition-property: height;
  -webkit-transition-duration: 500ms;
  -moz-transition-property: height;
  -moz-transition-duration: 500ms;
  transition-property: height;
  transition-duration: 500ms;
  text-overflow: ellipsis;
  overflow: hidden;
  height: 80px;
}
.tooltipbuttons {
  position: absolute;
  padding-right: 15px;
  top: 0px;
  right: 0px;
}
.tooltiptext {
  /*avoid the button to overlap on some docstring*/
  padding-right: 30px;
}
.ipython_tooltip {
  max-width: 700px;
  /*fade-in animation when inserted*/
  -webkit-animation: fadeOut 400ms;
  -moz-animation: fadeOut 400ms;
  animation: fadeOut 400ms;
  -webkit-animation: fadeIn 400ms;
  -moz-animation: fadeIn 400ms;
  animation: fadeIn 400ms;
  vertical-align: middle;
  background-color: #f7f7f7;
  overflow: visible;
  border: #ababab 1px solid;
  outline: none;
  padding: 3px;
  margin: 0px;
  padding-left: 7px;
  font-family: monospace;
  min-height: 50px;
  -moz-box-shadow: 0px 6px 10px -1px #adadad;
  -webkit-box-shadow: 0px 6px 10px -1px #adadad;
  box-shadow: 0px 6px 10px -1px #adadad;
  border-radius: 2px;
  position: absolute;
  z-index: 1000;
}
.ipython_tooltip a {
  float: right;
}
.ipython_tooltip .tooltiptext pre {
  border: 0;
  border-radius: 0;
  font-size: 100%;
  background-color: #f7f7f7;
}
.pretooltiparrow {
  left: 0px;
  margin: 0px;
  top: -16px;
  width: 40px;
  height: 16px;
  overflow: hidden;
  position: absolute;
}
.pretooltiparrow:before {
  background-color: #f7f7f7;
  border: 1px #ababab solid;
  z-index: 11;
  content: "";
  position: absolute;
  left: 15px;
  top: 10px;
  width: 25px;
  height: 25px;
  -webkit-transform: rotate(45deg);
  -moz-transform: rotate(45deg);
  -ms-transform: rotate(45deg);
  -o-transform: rotate(45deg);
}
ul.typeahead-list i {
  margin-left: -10px;
  width: 18px;
}
ul.typeahead-list {
  max-height: 80vh;
  overflow: auto;
}
ul.typeahead-list > li > a {
  /** Firefox bug **/
  /* see https://github.com/jupyter/notebook/issues/559 */
  white-space: normal;
}
.cmd-palette .modal-body {
  padding: 7px;
}
.cmd-palette form {
  background: white;
}
.cmd-palette input {
  outline: none;
}
.no-shortcut {
  display: none;
}
.command-shortcut:before {
  content: "(command)";
  padding-right: 3px;
  color: #777777;
}
.edit-shortcut:before {
  content: "(edit)";
  padding-right: 3px;
  color: #777777;
}
#find-and-replace #replace-preview .match,
#find-and-replace #replace-preview .insert {
  background-color: #BBDEFB;
  border-color: #90CAF9;
  border-style: solid;
  border-width: 1px;
  border-radius: 0px;
}
#find-and-replace #replace-preview .replace .match {
  background-color: #FFCDD2;
  border-color: #EF9A9A;
  border-radius: 0px;
}
#find-and-replace #replace-preview .replace .insert {
  background-color: #C8E6C9;
  border-color: #A5D6A7;
  border-radius: 0px;
}
#find-and-replace #replace-preview {
  max-height: 60vh;
  overflow: auto;
}
#find-and-replace #replace-preview pre {
  padding: 5px 10px;
}
.terminal-app {
  background: #EEE;
}
.terminal-app #header {
  background: #fff;
  -webkit-box-shadow: 0px 0px 12px 1px rgba(87, 87, 87, 0.2);
  box-shadow: 0px 0px 12px 1px rgba(87, 87, 87, 0.2);
}
.terminal-app .terminal {
  width: 100%;
  float: left;
  font-family: monospace;
  color: white;
  background: black;
  padding: 0.4em;
  border-radius: 2px;
  -webkit-box-shadow: 0px 0px 12px 1px rgba(87, 87, 87, 0.4);
  box-shadow: 0px 0px 12px 1px rgba(87, 87, 87, 0.4);
}
.terminal-app .terminal,
.terminal-app .terminal dummy-screen {
  line-height: 1em;
  font-size: 14px;
}
.terminal-app .terminal .xterm-rows {
  padding: 10px;
}
.terminal-app .terminal-cursor {
  color: black;
  background: white;
}
.terminal-app #terminado-container {
  margin-top: 20px;
}
/*# sourceMappingURL=style.min.css.map */
    </style>
<style type="text/css">
    .highlight .hll { background-color: #ffffcc }
.highlight  { background: #f8f8f8; }
.highlight .c { color: #408080; font-style: italic } /* Comment */
.highlight .err { border: 1px solid #FF0000 } /* Error */
.highlight .k { color: #008000; font-weight: bold } /* Keyword */
.highlight .o { color: #666666 } /* Operator */
.highlight .ch { color: #408080; font-style: italic } /* Comment.Hashbang */
.highlight .cm { color: #408080; font-style: italic } /* Comment.Multiline */
.highlight .cp { color: #BC7A00 } /* Comment.Preproc */
.highlight .cpf { color: #408080; font-style: italic } /* Comment.PreprocFile */
.highlight .c1 { color: #408080; font-style: italic } /* Comment.Single */
.highlight .cs { color: #408080; font-style: italic } /* Comment.Special */
.highlight .gd { color: #A00000 } /* Generic.Deleted */
.highlight .ge { font-style: italic } /* Generic.Emph */
.highlight .gr { color: #FF0000 } /* Generic.Error */
.highlight .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.highlight .gi { color: #00A000 } /* Generic.Inserted */
.highlight .go { color: #888888 } /* Generic.Output */
.highlight .gp { color: #000080; font-weight: bold } /* Generic.Prompt */
.highlight .gs { font-weight: bold } /* Generic.Strong */
.highlight .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.highlight .gt { color: #0044DD } /* Generic.Traceback */
.highlight .kc { color: #008000; font-weight: bold } /* Keyword.Constant */
.highlight .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
.highlight .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
.highlight .kp { color: #008000 } /* Keyword.Pseudo */
.highlight .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
.highlight .kt { color: #B00040 } /* Keyword.Type */
.highlight .m { color: #666666 } /* Literal.Number */
.highlight .s { color: #BA2121 } /* Literal.String */
.highlight .na { color: #7D9029 } /* Name.Attribute */
.highlight .nb { color: #008000 } /* Name.Builtin */
.highlight .nc { color: #0000FF; font-weight: bold } /* Name.Class */
.highlight .no { color: #880000 } /* Name.Constant */
.highlight .nd { color: #AA22FF } /* Name.Decorator */
.highlight .ni { color: #999999; font-weight: bold } /* Name.Entity */
.highlight .ne { color: #D2413A; font-weight: bold } /* Name.Exception */
.highlight .nf { color: #0000FF } /* Name.Function */
.highlight .nl { color: #A0A000 } /* Name.Label */
.highlight .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
.highlight .nt { color: #008000; font-weight: bold } /* Name.Tag */
.highlight .nv { color: #19177C } /* Name.Variable */
.highlight .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
.highlight .w { color: #bbbbbb } /* Text.Whitespace */
.highlight .mb { color: #666666 } /* Literal.Number.Bin */
.highlight .mf { color: #666666 } /* Literal.Number.Float */
.highlight .mh { color: #666666 } /* Literal.Number.Hex */
.highlight .mi { color: #666666 } /* Literal.Number.Integer */
.highlight .mo { color: #666666 } /* Literal.Number.Oct */
.highlight .sa { color: #BA2121 } /* Literal.String.Affix */
.highlight .sb { color: #BA2121 } /* Literal.String.Backtick */
.highlight .sc { color: #BA2121 } /* Literal.String.Char */
.highlight .dl { color: #BA2121 } /* Literal.String.Delimiter */
.highlight .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
.highlight .s2 { color: #BA2121 } /* Literal.String.Double */
.highlight .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */
.highlight .sh { color: #BA2121 } /* Literal.String.Heredoc */
.highlight .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */
.highlight .sx { color: #008000 } /* Literal.String.Other */
.highlight .sr { color: #BB6688 } /* Literal.String.Regex */
.highlight .s1 { color: #BA2121 } /* Literal.String.Single */
.highlight .ss { color: #19177C } /* Literal.String.Symbol */
.highlight .bp { color: #008000 } /* Name.Builtin.Pseudo */
.highlight .fm { color: #0000FF } /* Name.Function.Magic */
.highlight .vc { color: #19177C } /* Name.Variable.Class */
.highlight .vg { color: #19177C } /* Name.Variable.Global */
.highlight .vi { color: #19177C } /* Name.Variable.Instance */
.highlight .vm { color: #19177C } /* Name.Variable.Magic */
.highlight .il { color: #666666 } /* Literal.Number.Integer.Long */
    </style>
<style type="text/css">
    
/* Temporary definitions which will become obsolete with Notebook release 5.0 */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-bold { font-weight: bold; }

    </style>


<style type="text/css">
/* Overrides of notebook CSS for static HTML export */
body {
  overflow: visible;
  padding: 8px;
}

div#notebook {
  overflow: visible;
  border-top: none;
}@media print {
  div.cell {
    display: block;
    page-break-inside: avoid;
  } 
  div.output_wrapper { 
    display: block;
    page-break-inside: avoid; 
  }
  div.output { 
    display: block;
    page-break-inside: avoid; 
  }
}
</style>

<!-- Custom stylesheet, it must be in the same directory as the html file -->
<link rel="stylesheet" href="custom.css">

<!-- Loading mathjax macro -->
<!-- Load mathjax -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS_HTML"></script>
    <!-- MathJax configuration -->
    <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        tex2jax: {
            inlineMath: [ ['$','$'], ["\\(","\\)"] ],
            displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
            processEscapes: true,
            processEnvironments: true
        },
        // Center justify equations in code and markdown cells. Elsewhere
        // we use CSS to left justify single line equations in code cells.
        displayAlign: 'center',
        "HTML-CSS": {
            styles: {'.MathJax_Display': {"margin": 0}},
            linebreaks: { automatic: true }
        }
    });
    </script>
    <!-- End of mathjax configuration --></head>
<body>
  <div tabindex="-1" id="notebook" class="border-box-sizing">
    <div class="container" id="notebook-container">

<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Multi-agent-planning">Multi-agent planning<a class="anchor-link" href="#Multi-agent-planning">&#182;</a></h4>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[1]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">torch</span>
<span class="kn">from</span> <span class="nn">torch</span> <span class="k">import</span> <span class="n">autograd</span>
<span class="kn">from</span> <span class="nn">torch.utils.data</span> <span class="k">import</span> <span class="n">DataLoader</span>
<span class="kn">from</span> <span class="nn">torch.nn.parameter</span> <span class="k">import</span> <span class="n">Parameter</span>
<span class="kn">import</span> <span class="nn">torch.nn.functional</span> <span class="k">as</span> <span class="nn">F</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[2]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">random</span>
<span class="kn">import</span> <span class="nn">queue</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Dataset">Dataset<a class="anchor-link" href="#Dataset">&#182;</a></h4>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[3]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">train</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">with</span> <span class="n">np</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;dataset/Train_data/train_4_data.npz&#39;</span><span class="p">,</span><span class="n">mmap_mode</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">train</span> <span class="o">=</span> <span class="n">f</span><span class="p">[</span><span class="s1">&#39;arr_0&#39;</span><span class="p">]</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[4]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">train_data</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">train</span><span class="p">:</span>
    <span class="n">env</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="o">*</span><span class="p">(</span><span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mf">0.0</span><span class="p">)</span> <span class="o">+</span> <span class="mf">1.0</span>
    <span class="n">goal</span> <span class="o">=</span> <span class="p">(</span><span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mf">0.5</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.0</span>
    <span class="n">agent</span> <span class="o">=</span> <span class="p">(</span><span class="n">i</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mf">1.0</span><span class="p">)</span> <span class="o">*</span> <span class="o">-</span><span class="mi">1</span>
    <span class="n">agent</span><span class="p">[</span><span class="n">i</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">]][</span><span class="n">i</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">1</span><span class="p">]]</span> <span class="o">=</span> <span class="mf">0.0</span>
    <span class="n">env</span> <span class="o">=</span> <span class="n">env</span> <span class="o">+</span> <span class="n">agent</span>
    <span class="n">agent</span><span class="p">[</span><span class="n">i</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">]][</span><span class="n">i</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">1</span><span class="p">]]</span> <span class="o">=</span> <span class="mf">1.0</span>
    
    <span class="n">domain</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">env</span><span class="p">,</span><span class="n">goal</span><span class="p">,</span><span class="n">agent</span><span class="p">])</span>
    
    <span class="n">token</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">if</span> <span class="n">i</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>
        <span class="n">go</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">goal</span> <span class="o">==</span> <span class="mf">1.0</span><span class="p">)</span>
        <span class="n">Goal</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">column_stack</span><span class="p">([</span><span class="n">go</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">go</span><span class="p">[</span><span class="mi">1</span><span class="p">]])</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">Goal</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">j</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">i</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="ow">and</span> <span class="n">j</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">i</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">1</span><span class="p">]:</span>
                <span class="n">token</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">else</span> <span class="p">:</span>
        <span class="n">token</span> <span class="o">=</span> <span class="mi">1</span>
    
    <span class="k">if</span> <span class="n">token</span><span class="p">:</span>
        <span class="n">train_data</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">domain</span><span class="p">),</span><span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">i</span><span class="p">[</span><span class="mi">2</span><span class="p">]),</span><span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">i</span><span class="p">[</span><span class="mi">3</span><span class="p">])])</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[5]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">train_dl</span> <span class="o">=</span> <span class="n">DataLoader</span><span class="p">(</span><span class="n">train_data</span><span class="p">,</span><span class="n">batch_size</span><span class="o">=</span><span class="mi">128</span><span class="p">,</span><span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Model">Model<a class="anchor-link" href="#Model">&#182;</a></h4>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[6]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">MA_P</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">imsize</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">MA_P</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">k</span> <span class="o">=</span> <span class="n">k</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">imsize</span> <span class="o">=</span> <span class="n">imsize</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">h</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">Conv2d</span><span class="p">(</span>
            <span class="n">in_channels</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
            <span class="n">out_channels</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span>
            <span class="n">kernel_size</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span>
            <span class="n">stride</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
            <span class="n">padding</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
            <span class="n">bias</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">r</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">Conv2d</span><span class="p">(</span>
            <span class="n">in_channels</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span>
            <span class="n">out_channels</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
            <span class="n">kernel_size</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
            <span class="n">stride</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
            <span class="n">padding</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
            <span class="n">bias</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">q</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">Conv2d</span><span class="p">(</span>
            <span class="n">in_channels</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
            <span class="n">out_channels</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
            <span class="n">kernel_size</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span>
            <span class="n">stride</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
            <span class="n">padding</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
            <span class="n">bias</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">w</span> <span class="o">=</span> <span class="n">Parameter</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">requires_grad</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sm</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">Softmax</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">S1</span><span class="p">,</span> <span class="n">S2</span><span class="p">):</span>
        <span class="n">h</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">h</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
        <span class="n">r</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">r</span><span class="p">(</span><span class="n">h</span><span class="p">)</span>
        <span class="n">q</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">q</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
        <span class="n">v</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">keepdim</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">k</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
            <span class="n">q</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">conv2d</span><span class="p">(</span>
                <span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">([</span><span class="n">r</span><span class="p">,</span> <span class="n">v</span><span class="p">],</span> <span class="mi">1</span><span class="p">),</span>
                <span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">q</span><span class="o">.</span><span class="n">weight</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">w</span><span class="p">],</span> <span class="mi">1</span><span class="p">),</span>
                <span class="n">stride</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                <span class="n">padding</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">v</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">keepdim</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="n">q</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">conv2d</span><span class="p">(</span>
            <span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">([</span><span class="n">r</span><span class="p">,</span> <span class="n">v</span><span class="p">],</span> <span class="mi">1</span><span class="p">),</span>
            <span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">q</span><span class="o">.</span><span class="n">weight</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">w</span><span class="p">],</span> <span class="mi">1</span><span class="p">),</span>
            <span class="n">stride</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
            <span class="n">padding</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        
        <span class="n">v_in</span><span class="p">,</span><span class="n">v_out</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">keepdim</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="n">slice_s1</span> <span class="o">=</span> <span class="n">S1</span><span class="o">.</span><span class="n">long</span><span class="p">()</span><span class="o">.</span><span class="n">expand</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">imsize</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="n">q</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
        <span class="n">slice_s1</span> <span class="o">=</span> <span class="n">slice_s1</span><span class="o">.</span><span class="n">permute</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">q_out</span> <span class="o">=</span> <span class="n">q</span><span class="o">.</span><span class="n">gather</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">slice_s1</span><span class="p">)</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>

        <span class="n">slice_s2</span> <span class="o">=</span> <span class="n">S2</span><span class="o">.</span><span class="n">long</span><span class="p">()</span><span class="o">.</span><span class="n">expand</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="n">q</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
        <span class="n">slice_s2</span> <span class="o">=</span> <span class="n">slice_s2</span><span class="o">.</span><span class="n">permute</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">q_out</span> <span class="o">=</span> <span class="n">q_out</span><span class="o">.</span><span class="n">gather</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">slice_s2</span><span class="p">)</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>

        <span class="n">logits</span> <span class="o">=</span> <span class="n">q_out</span>
        
        <span class="k">return</span> <span class="n">logits</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sm</span><span class="p">(</span><span class="n">logits</span><span class="p">),</span><span class="n">v_in</span><span class="p">,</span><span class="n">v_out</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[7]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">MA_P</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">8</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[8]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">model</span><span class="o">.</span><span class="n">load_state_dict</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;./trained/MA_P_2_9_2.pth&#39;</span><span class="p">,</span><span class="n">map_location</span><span class="o">=</span><span class="s1">&#39;cpu&#39;</span><span class="p">))</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Loss">Loss<a class="anchor-link" href="#Loss">&#182;</a></h4>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[9]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">Criterion</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">CrossEntropyLoss</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Optimizer">Optimizer<a class="anchor-link" href="#Optimizer">&#182;</a></h4>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[10]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">optimizer</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">optim</span><span class="o">.</span><span class="n">RMSprop</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="p">(),</span><span class="n">lr</span><span class="o">=</span><span class="mf">0.001</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Training">Training<a class="anchor-link" href="#Training">&#182;</a></h4>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[11]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">N_Epoch</span> <span class="o">=</span> <span class="mi">1</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N_Epoch</span><span class="p">):</span>
    <span class="n">running_loss</span> <span class="o">=</span> <span class="mf">0.0</span>
    <span class="n">correct</span> <span class="o">=</span> <span class="mi">0</span>
    
    <span class="n">model</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>
    
    <span class="n">train_iter</span> <span class="o">=</span> <span class="nb">iter</span><span class="p">(</span><span class="n">train_dl</span><span class="p">)</span>
    
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">273</span><span class="p">):</span>
    
        <span class="n">X</span><span class="p">,</span><span class="n">S</span><span class="p">,</span><span class="n">label</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">train_iter</span><span class="p">)</span>
        
        
        <span class="n">output</span><span class="p">,</span> <span class="n">prediction</span><span class="p">,</span><span class="n">_</span><span class="p">,</span><span class="n">_</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">float</span><span class="p">(),</span><span class="n">S</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span><span class="n">S</span><span class="p">[:,</span><span class="mi">1</span><span class="p">])</span>
        
        <span class="n">loss</span> <span class="o">=</span> <span class="n">Criterion</span><span class="p">(</span><span class="n">output</span><span class="p">,</span><span class="n">label</span><span class="p">)</span>
        
        <span class="n">running_loss</span> <span class="o">+=</span> <span class="n">loss</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>
        
        <span class="n">_</span><span class="p">,</span><span class="n">index</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">output</span><span class="p">,</span><span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        
        <span class="n">correct</span> <span class="o">+=</span> <span class="n">torch</span><span class="o">.</span><span class="n">eq</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">label</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>
    
    <span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;Epoch:</span><span class="si">{i}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;Average_loss :{running_loss / 273}&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;Accuracy : {correct / len(train_data)}&quot;</span><span class="p">)</span>
    
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Epoch:0
Average_loss :0.4020480120029205
Accuracy : 0.8465922107674685
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Check-goal-accuracy-on-5x5-env-size">Check goal accuracy on 5x5 env size<a class="anchor-link" href="#Check-goal-accuracy-on-5x5-env-size">&#182;</a></h4>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[12]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">test</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">with</span> <span class="n">np</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;dataset/Train_data/train_4_0.npz&#39;</span><span class="p">,</span><span class="n">mmap_mode</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">test</span> <span class="o">=</span> <span class="n">f</span><span class="p">[</span><span class="s1">&#39;arr_0&#39;</span><span class="p">]</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[142]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">test_data</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">test</span><span class="p">:</span>
    <span class="n">env</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="o">*</span><span class="p">(</span><span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mf">0.0</span><span class="p">)</span> <span class="o">+</span> <span class="mf">1.0</span>
    <span class="n">goal</span> <span class="o">=</span> <span class="p">(</span><span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mf">0.5</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.0</span>
    <span class="n">agent</span> <span class="o">=</span> <span class="p">(</span><span class="n">i</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mf">1.0</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.0</span>

    
    <span class="n">p_env</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="mi">7</span><span class="p">,</span><span class="mi">7</span><span class="p">])</span>
    <span class="n">p_env</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">6</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="mi">6</span><span class="p">]</span> <span class="o">=</span> <span class="n">env</span>
    <span class="n">p_goal</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="mi">7</span><span class="p">,</span><span class="mi">7</span><span class="p">])</span>
    <span class="n">p_goal</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">6</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="mi">6</span><span class="p">]</span> <span class="o">=</span> <span class="n">goal</span>
    <span class="n">p_agent</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="mi">7</span><span class="p">,</span><span class="mi">7</span><span class="p">])</span>
    <span class="n">p_agent</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">6</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="mi">6</span><span class="p">]</span> <span class="o">=</span> <span class="n">agent</span>
    
    <span class="n">domain</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">p_env</span><span class="p">,</span><span class="n">p_goal</span><span class="p">,</span><span class="n">p_agent</span><span class="p">])</span>
    
   
    <span class="n">test_data</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">domain</span><span class="p">),</span><span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="n">i</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">i</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="p">]),</span><span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">i</span><span class="p">[</span><span class="mi">3</span><span class="p">])])</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[22]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">model_5x5</span> <span class="o">=</span> <span class="n">MA_P</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">7</span><span class="p">)</span>
<span class="n">model_5x5</span><span class="o">.</span><span class="n">load_state_dict</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;./trained/MA_P_2_9_2.pth&#39;</span><span class="p">,</span><span class="n">map_location</span><span class="o">=</span><span class="s1">&#39;cpu&#39;</span><span class="p">))</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[326]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">action</span><span class="p">(</span><span class="n">S</span><span class="p">,</span><span class="n">val</span><span class="p">,</span><span class="n">env</span><span class="p">,</span><span class="n">imsize</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">val</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">S</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">item</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">env</span><span class="p">[</span><span class="n">S</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">item</span><span class="p">()][</span><span class="n">S</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">item</span><span class="p">()</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mf">1.0</span> <span class="p">:</span>
            <span class="k">return</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="n">S</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">item</span><span class="p">(),</span><span class="n">S</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">item</span><span class="p">()</span><span class="o">-</span><span class="mi">1</span><span class="p">]),</span> <span class="kc">False</span>
        <span class="k">else</span> <span class="p">:</span>
            <span class="k">return</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="n">S</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">item</span><span class="p">(),</span><span class="n">S</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">item</span><span class="p">()]),</span> <span class="kc">True</span>
    <span class="k">elif</span> <span class="n">val</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">S</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">item</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">env</span><span class="p">[</span><span class="n">S</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">item</span><span class="p">()</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">S</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">item</span><span class="p">()]</span> <span class="o">==</span> <span class="mf">1.0</span> <span class="p">:</span>
            <span class="k">return</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="n">S</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">item</span><span class="p">()</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">S</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">item</span><span class="p">()]),</span> <span class="kc">False</span>
        <span class="k">else</span> <span class="p">:</span>
            <span class="k">return</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="n">S</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">item</span><span class="p">(),</span><span class="n">S</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">item</span><span class="p">()]),</span> <span class="kc">True</span>
    <span class="k">elif</span> <span class="n">val</span> <span class="o">==</span> <span class="mi">2</span> <span class="ow">and</span> <span class="n">S</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">item</span><span class="p">()</span> <span class="o">&lt;</span> <span class="p">(</span><span class="n">imsize</span> <span class="o">-</span><span class="mi">1</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">env</span><span class="p">[</span><span class="n">S</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">item</span><span class="p">()][</span><span class="n">S</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">item</span><span class="p">()</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mf">1.0</span> <span class="p">:</span>
            <span class="k">return</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="n">S</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">item</span><span class="p">(),</span><span class="n">S</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">item</span><span class="p">()</span><span class="o">+</span><span class="mi">1</span><span class="p">]),</span> <span class="kc">False</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="n">S</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">item</span><span class="p">(),</span><span class="n">S</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">item</span><span class="p">()]),</span> <span class="kc">True</span>
    <span class="k">elif</span> <span class="n">val</span> <span class="o">==</span> <span class="mi">3</span> <span class="ow">and</span> <span class="n">S</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">item</span><span class="p">()</span> <span class="o">&lt;</span> <span class="p">(</span><span class="n">imsize</span> <span class="o">-</span><span class="mi">1</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">env</span><span class="p">[</span><span class="n">S</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">item</span><span class="p">()</span><span class="o">+</span><span class="mi">1</span><span class="p">][</span><span class="n">S</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">item</span><span class="p">()]</span> <span class="o">==</span> <span class="mf">1.0</span> <span class="p">:</span>
            <span class="k">return</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="n">S</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">item</span><span class="p">()</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">S</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">item</span><span class="p">()]),</span> <span class="kc">False</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="n">S</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">item</span><span class="p">(),</span><span class="n">S</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">item</span><span class="p">()]),</span> <span class="kc">True</span>
    <span class="k">else</span> <span class="p">:</span>
        <span class="k">return</span> <span class="n">S</span><span class="p">,</span> <span class="kc">True</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[15]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">rand_play</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">a_s</span><span class="p">,</span><span class="n">imsize</span><span class="p">,</span><span class="n">obst</span><span class="p">):</span>
    <span class="c1">#find possible action</span>
    <span class="n">Action</span> <span class="o">=</span> <span class="p">[]</span>
    
    <span class="k">if</span> <span class="p">(</span><span class="n">a_s</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">X</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">a_s</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="n">a_s</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="ow">and</span> <span class="p">(</span><span class="ow">not</span> <span class="n">X</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="n">a_s</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="n">a_s</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span><span class="p">]):</span>
            <span class="n">Action</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">a_s</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span><span class="mi">1</span> <span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">X</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">a_s</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">a_s</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="ow">and</span> <span class="p">(</span><span class="ow">not</span> <span class="n">X</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="n">a_s</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">a_s</span><span class="p">[</span><span class="mi">1</span><span class="p">]]):</span>
            <span class="n">Action</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">a_s</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span><span class="mi">1</span> <span class="p">)</span> <span class="o">&lt;</span> <span class="n">imsize</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">X</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">a_s</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="n">a_s</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="ow">and</span> <span class="p">(</span><span class="ow">not</span> <span class="n">X</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="n">a_s</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="n">a_s</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="p">]):</span>
            <span class="n">Action</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">a_s</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">imsize</span><span class="p">:</span>    
        <span class="k">if</span> <span class="n">X</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">a_s</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="p">][</span><span class="n">a_s</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="ow">and</span> <span class="p">(</span><span class="ow">not</span> <span class="n">X</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="n">a_s</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="p">][</span><span class="n">a_s</span><span class="p">[</span><span class="mi">1</span><span class="p">]]):</span>
            <span class="n">Action</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">Action</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">act</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">Action</span><span class="p">)</span>
        <span class="n">new_state</span><span class="p">,</span><span class="n">_</span> <span class="o">=</span> <span class="n">action</span><span class="p">(</span><span class="n">a_s</span><span class="p">,</span><span class="n">act</span><span class="p">,</span><span class="n">obst</span><span class="p">,</span><span class="n">imsize</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">new_state</span> <span class="o">=</span> <span class="n">a_s</span>
    
    <span class="k">return</span> <span class="n">new_state</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[16]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">goal_reach_check</span><span class="p">(</span><span class="n">agent_state</span><span class="p">,</span><span class="n">goal</span><span class="p">,</span><span class="n">goal_count</span><span class="p">,</span><span class="n">goal_reached</span><span class="p">):</span>
    <span class="n">token</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">v</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">z</span> <span class="ow">in</span> <span class="n">goal</span><span class="p">:</span>
        <span class="c1">#check goal is already reached</span>
        <span class="k">if</span> <span class="n">goal_reached</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="c1">#if goal is not reached and compare with agent state</span>
            <span class="k">if</span> <span class="n">agent_state</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">item</span><span class="p">()</span> <span class="o">==</span> <span class="n">z</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">and</span> <span class="n">agent_state</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">item</span><span class="p">()</span> <span class="o">==</span> <span class="n">z</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
                <span class="n">goal_reached</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
                <span class="n">goal_count</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="n">token</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">v</span> <span class="o">=</span> <span class="n">v</span><span class="o">+</span><span class="mi">1</span>    
    <span class="k">return</span> <span class="n">token</span><span class="p">,</span><span class="n">goal_count</span><span class="p">,</span><span class="n">goal_reached</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[206]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">agent_env_H</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">agent_state</span><span class="p">,</span><span class="n">imsize</span><span class="p">,</span><span class="n">avoid_goal</span><span class="p">,</span><span class="n">token</span><span class="p">):</span>
    
    <span class="n">Y</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="n">imsize</span><span class="p">,</span><span class="n">imsize</span><span class="p">])</span>
    <span class="n">Y</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,:,:]</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">clone</span><span class="p">()</span>
    <span class="n">Y</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,:,:]</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">clone</span><span class="p">()</span>
    
    <span class="k">if</span> <span class="n">token</span> <span class="p">:</span>
        <span class="n">Y</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,:,:]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span> <span class="o">*</span> <span class="n">X</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">clone</span><span class="p">()</span>
        <span class="n">Y</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">agent_state</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">agent_state</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="n">Y</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,:,:]</span> <span class="o">=</span> <span class="n">Y</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,:,:]</span> <span class="o">+</span> <span class="n">Y</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,:,:]</span>
        <span class="n">Y</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">agent_state</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">agent_state</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="o">=</span> <span class="mf">1.0</span>
    <span class="k">else</span> <span class="p">:</span>
        <span class="n">Y</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,:,:]</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
        <span class="n">Y</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">agent_state</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">agent_state</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="o">=</span> <span class="mf">1.0</span>

        
    <span class="c1">#avoid goal </span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">avoid_goal</span><span class="p">:</span>
        <span class="n">Y</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">i</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="o">=</span> <span class="mf">0.0</span>
    
    <span class="n">Y</span> <span class="o">=</span> <span class="n">Y</span><span class="o">.</span><span class="n">float</span><span class="p">()</span>
   
    <span class="k">return</span> <span class="n">Y</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[18]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">agent_env</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">agent_state</span><span class="p">,</span><span class="n">imsize</span><span class="p">,</span><span class="n">avoid_goal</span><span class="p">,</span><span class="n">token</span><span class="p">):</span>
    
    <span class="n">Y</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="n">imsize</span><span class="p">,</span><span class="n">imsize</span><span class="p">])</span>
    <span class="n">Y</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,:,:]</span> <span class="o">=</span> <span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">Y</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,:,:]</span> <span class="o">=</span> <span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">Y</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,:,:]</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">clone</span><span class="p">()</span>
    
    <span class="n">X</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="n">agent_state</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="n">agent_state</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="o">=</span> <span class="mf">0.0</span>
     
    <span class="k">if</span> <span class="n">token</span> <span class="p">:</span>
        <span class="n">Y</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">,:,:]</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">clone</span><span class="p">()</span>
    <span class="k">else</span> <span class="p">:</span>
        <span class="n">Y</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">,:,:]</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>

        
    <span class="c1">#avoid goal </span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">avoid_goal</span><span class="p">:</span>
        <span class="n">Y</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">i</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="o">=</span> <span class="mf">0.0</span>
    
    
    <span class="n">Y</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,:,:]</span> <span class="o">=</span> <span class="n">Y</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,:,:]</span> <span class="o">-</span> <span class="n">Y</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">,:,:]</span> 
    <span class="n">Y</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,:,:]</span> <span class="o">=</span> <span class="n">Y</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,:,:]</span> <span class="o">+</span> <span class="n">Y</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">,:,:]</span>
      
    <span class="n">Y</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">,:,:]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span> <span class="o">*</span> <span class="n">Y</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">,:,:]</span>
    
    <span class="n">Y</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="n">agent_state</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">agent_state</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="o">=</span> <span class="mf">1.0</span>
    
    
    <span class="n">Y</span> <span class="o">=</span> <span class="n">Y</span><span class="o">.</span><span class="n">float</span><span class="p">()</span>
   
    <span class="k">return</span> <span class="n">Y</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[273]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">agent_prediction</span><span class="p">(</span><span class="n">model</span><span class="p">,</span><span class="n">X</span><span class="p">,</span><span class="n">whole_traj_act</span><span class="p">,</span><span class="n">goal</span><span class="p">,</span><span class="n">imsize</span><span class="p">,</span><span class="n">max_random_play</span><span class="p">):</span>
    <span class="c1">#convert specific domain to generic domains</span>
    <span class="n">X</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
    
    <span class="n">model</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span> 
    <span class="n">correct_goal</span><span class="p">,</span><span class="n">total_goal</span><span class="p">,</span><span class="n">traj_step_error</span><span class="p">,</span><span class="n">goal_count</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span>
    
    <span class="c1">#store agent initial state</span>
    <span class="n">inter</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="mf">1.0</span><span class="p">)</span>
    <span class="n">agent_state</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">column_stack</span><span class="p">([</span><span class="n">inter</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">inter</span><span class="p">[</span><span class="mi">1</span><span class="p">]])</span>
    <span class="n">n_agent</span> <span class="o">=</span> <span class="n">agent_state</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    
    <span class="n">agent_traj</span> <span class="o">=</span> <span class="p">[[</span><span class="n">agent_state</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_agent</span><span class="p">)]</span>
    
    <span class="c1">#store number agent still playing</span>
    <span class="n">current_play_agent</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.0</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_agent</span><span class="p">)]</span>
    
    <span class="n">current_play_agent</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">current_play_agent</span><span class="p">)</span>
    
    <span class="c1">#keep which is reached</span>
    <span class="n">goal_reached</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="n">goal</span><span class="o">.</span><span class="n">size</span><span class="p">])</span>
    
    <span class="c1">#store each agent random play chances</span>
    <span class="n">random_play</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_agent</span><span class="p">)</span>
    <span class="n">max_random_play</span> <span class="o">=</span> <span class="n">max_random_play</span>
    
    <span class="n">play</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">while</span> <span class="n">current_play_agent</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">!=</span> <span class="mf">0.0</span> <span class="ow">and</span> <span class="n">play</span> <span class="o">&lt;</span> <span class="mi">20</span><span class="p">:</span>
        <span class="n">play</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_agent</span><span class="p">):</span>
            
            <span class="k">if</span> <span class="n">current_play_agent</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="mf">1.0</span><span class="p">:</span>  
                <span class="n">Input</span> <span class="o">=</span> <span class="n">agent_env_H</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">clone</span><span class="p">(),</span><span class="n">agent_state</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">imsize</span><span class="p">,[],</span><span class="mi">1</span><span class="p">)</span>
                <span class="n">output</span><span class="p">,</span><span class="n">prediction</span><span class="p">,</span><span class="n">_</span><span class="p">,</span><span class="n">_</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">Input</span><span class="p">,</span><span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">agent_state</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]),</span><span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">agent_state</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]))</span>
                <span class="n">_</span><span class="p">,</span><span class="n">index</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">output</span><span class="p">,</span><span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
              
                <span class="c1">#check agent (index = 4) means stop planning</span>
                <span class="k">if</span> <span class="n">index</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>
                    <span class="c1">#token whether agent reach goal or not</span>
                    <span class="n">token</span><span class="p">,</span><span class="n">goal_count</span><span class="p">,</span><span class="n">goal_reached</span> <span class="o">=</span> <span class="n">goal_reach_check</span><span class="p">(</span><span class="n">agent_state</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">goal</span><span class="p">,</span><span class="n">goal_count</span><span class="p">,</span><span class="n">goal_reached</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">token</span><span class="p">:</span>
                        <span class="n">current_play_agent</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">random_play</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">max_random_play</span><span class="p">:</span>
                            <span class="n">current_play_agent</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">X</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="n">agent_state</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]][</span><span class="n">agent_state</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]]</span> <span class="o">=</span> <span class="mf">0.0</span>
                            <span class="n">agent_state</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span><span class="n">rand_play</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">agent_state</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">(),</span><span class="n">imsize</span><span class="p">)</span>
                            <span class="n">random_play</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
                            <span class="n">X</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="n">agent_state</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]][</span><span class="n">agent_state</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]]</span> <span class="o">=</span> <span class="mf">1.0</span>
                            <span class="n">agent_traj</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">agent_state</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span>
    
                <span class="k">else</span><span class="p">:</span>
                    
                    <span class="n">agent_new_state</span><span class="p">,</span><span class="n">obst</span> <span class="o">=</span> <span class="n">action</span><span class="p">(</span><span class="n">S</span><span class="o">=</span><span class="n">agent_state</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">val</span><span class="o">=</span><span class="n">index</span><span class="p">,</span><span class="n">imsize</span><span class="o">=</span><span class="n">imsize</span><span class="p">,</span><span class="n">env</span><span class="o">=</span><span class="n">Input</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,:,:])</span>
                    
                    <span class="k">if</span> <span class="n">obst</span><span class="p">:</span>
                      <span class="c1">#  print(&#39;s&#39;)</span>
                        <span class="n">current_play_agent</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span>
                        <span class="k">continue</span>
                    <span class="n">X</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="n">agent_state</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]][</span><span class="n">agent_state</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]]</span> <span class="o">=</span> <span class="mf">0.0</span>
                    <span class="n">agent_state</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">agent_new_state</span>
                    <span class="n">X</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="n">agent_state</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]][</span><span class="n">agent_state</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]]</span> <span class="o">=</span> <span class="mf">1.0</span>
                    <span class="n">agent_traj</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">agent_state</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span>
                    
                    <span class="c1">#stop agent which moves back and forward two on the goal</span>
                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">agent_traj</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">3</span> <span class="ow">and</span> <span class="p">(</span><span class="n">agent_traj</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">agent_traj</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="o">-</span><span class="mi">3</span><span class="p">])</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">==</span> <span class="mi">2</span> <span class="ow">and</span> <span class="p">(</span><span class="n">agent_traj</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="n">agent_traj</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="o">-</span><span class="mi">4</span><span class="p">])</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                        
                        <span class="n">inter</span> <span class="o">=</span> <span class="n">agent_traj</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                        <span class="n">token</span><span class="p">,</span><span class="n">goal_count</span><span class="p">,</span><span class="n">goal_reached</span> <span class="o">=</span> <span class="n">goal_reach_check</span><span class="p">(</span><span class="n">inter</span><span class="p">,</span><span class="n">goal</span><span class="p">,</span><span class="n">goal_count</span><span class="p">,</span><span class="n">goal_reached</span><span class="p">)</span>
                        <span class="k">if</span> <span class="n">token</span><span class="p">:</span>
                       <span class="c1">#     print(&#39;d&#39;)</span>
                            <span class="n">current_play_agent</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span>
                        <span class="k">else</span><span class="p">:</span>     
                            <span class="n">inter</span> <span class="o">=</span> <span class="n">agent_traj</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>
                            <span class="n">token</span><span class="p">,</span><span class="n">goal_count</span><span class="p">,</span><span class="n">goal_reached</span> <span class="o">=</span> <span class="n">goal_reach_check</span><span class="p">(</span><span class="n">inter</span><span class="p">,</span><span class="n">goal</span><span class="p">,</span><span class="n">goal_count</span><span class="p">,</span><span class="n">goal_reached</span><span class="p">)</span>
                            <span class="k">if</span> <span class="n">token</span><span class="p">:</span>
                        <span class="c1">#        print(&#39;e&#39;)</span>
                                <span class="n">current_play_agent</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span>
                                <span class="n">agent_traj</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
                            <span class="k">else</span><span class="p">:</span>
                                <span class="k">if</span> <span class="n">random_play</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">max_random_play</span><span class="p">:</span>
                                    <span class="n">X</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="n">agent_state</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]][</span><span class="n">agent_state</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]]</span> <span class="o">=</span> <span class="mf">0.0</span>
                                    
                                    <span class="n">agent_state</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span><span class="n">rand_play</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">agent_state</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">(),</span><span class="n">imsize</span><span class="p">)</span>
                                    <span class="n">random_play</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
                                    <span class="n">X</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="n">agent_state</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]][</span><span class="n">agent_state</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]]</span> <span class="o">=</span> <span class="mf">1.0</span>
                                    <span class="n">agent_traj</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">agent_state</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span>
                                <span class="k">else</span><span class="p">:</span>
                         <span class="c1">#           print(&#39;e&#39;)</span>
                                    <span class="n">current_play_agent</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span>
                    
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">whole_traj_act</span><span class="p">)):</span>
        <span class="n">inter</span> <span class="o">=</span>  <span class="n">whole_traj_act</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span> 
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">agent_traj</span><span class="p">)):</span>
            <span class="k">if</span> <span class="n">inter</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">agent_traj</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="ow">and</span> <span class="n">inter</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">agent_traj</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]:</span>
                <span class="n">actual_len</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">agent_traj</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="n">pred_len</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">whole_traj_act</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
                <span class="n">traj_step_error</span> <span class="o">+=</span> <span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">pred_len</span> <span class="o">-</span> <span class="n">actual_len</span><span class="p">))</span>
    
    
    <span class="n">correct_goal</span> <span class="o">=</span> <span class="n">goal_count</span>
    
    <span class="k">if</span> <span class="n">n_agent</span> <span class="o">&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">goal</span><span class="p">):</span>
        <span class="n">total_goal</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">goal</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">total_goal</span> <span class="o">=</span>  <span class="n">n_agent</span>
        
    <span class="n">traj_step</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1000</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">agent_traj</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">traj_step</span><span class="p">:</span>
            <span class="n">traj_step</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">correct_goal</span><span class="p">,</span><span class="n">total_goal</span><span class="p">,(</span><span class="n">traj_step</span><span class="p">),</span><span class="n">agent_traj</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[261]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">visualization</span><span class="p">(</span><span class="n">dom</span><span class="p">,</span><span class="n">whole_traj_act</span><span class="p">,</span><span class="n">traj</span><span class="p">):</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
    <span class="n">implot</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">dom</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;Greys_r&quot;</span><span class="p">)</span>

    <span class="n">opti</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">whole_traj_act</span><span class="p">:</span>
        <span class="n">opti</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">opti</span><span class="p">:</span>
        <span class="n">opti_arr</span> <span class="o">=</span>  <span class="p">[]</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">i</span><span class="p">:</span>
            <span class="n">opti_arr</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">j</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">item</span><span class="p">(),</span><span class="n">j</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">item</span><span class="p">()])</span>

        <span class="n">opti_ar</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">opti_arr</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">opti_ar</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="n">opti_ar</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>

    <span class="n">start</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">traj</span><span class="p">:</span>
        <span class="n">start</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

    <span class="n">start</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">start</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">start</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">i</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;-s&#39;</span><span class="p">)</span>

    <span class="n">start</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">traj</span><span class="p">:</span>
        <span class="n">path</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">i</span><span class="p">:</span>
            <span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">j</span><span class="p">)</span>

        <span class="n">path</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">path</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">path</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;-X&#39;</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>

 <span class="c1">#   for i in goal:</span>
 <span class="c1">#       ax.plot(i[1], i[0], &#39;-s&#39;)</span>
    <span class="n">legend</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper right&#39;</span><span class="p">,</span> <span class="n">shadow</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="c1">#    for label in legend.get_texts():</span>
<span class="c1">#        label.set_fontsize(&#39;x-small&#39;)  # the legend text size</span>
<span class="c1">#    for label in legend.get_lines():</span>
<span class="c1">#        label.set_linewidth(0.5)  # the legend line width</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[344]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">next_goal</span><span class="p">(</span><span class="n">Input</span><span class="p">,</span><span class="n">v_in</span><span class="p">,</span><span class="n">agent_pose</span><span class="p">,</span><span class="n">imsize</span><span class="p">,</span><span class="n">n_goal</span><span class="p">,</span><span class="n">goal_pose</span><span class="p">,</span><span class="n">avoid_goal</span><span class="p">)</span> <span class="p">:</span>
    <span class="n">visited</span> <span class="o">=</span> <span class="p">(</span><span class="n">Input</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,:,:]</span><span class="o">.</span><span class="n">clone</span><span class="p">()</span> <span class="o">==</span> <span class="mf">0.0</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.0</span>
    <span class="n">distance</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">visited</span><span class="p">)</span>
    <span class="n">parent</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">visited</span><span class="p">)</span> <span class="o">*</span> <span class="o">-</span><span class="mi">1</span>

    <span class="n">v_in</span> <span class="o">=</span> <span class="n">v_in</span><span class="o">.</span><span class="n">squeeze</span><span class="p">()</span>
  
    <span class="n">pose</span> <span class="o">=</span> <span class="n">agent_pose</span>

    <span class="n">visited</span><span class="p">[</span><span class="n">pose</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="n">pose</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="o">=</span> <span class="mf">1.0</span>
    <span class="n">distance</span><span class="p">[</span><span class="n">pose</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="n">pose</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="o">=</span> <span class="mf">0.0</span>
    <span class="n">parent</span><span class="p">[</span><span class="n">pose</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="n">pose</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="o">=</span> <span class="mi">4</span>

    <span class="n">av</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">avoid_goal</span><span class="p">)</span>
    <span class="c1">#valid goal location</span>
    <span class="n">valid</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.0</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_goal</span><span class="p">)]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_goal</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">av</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">avoid_goal</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">goal_pose</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="ow">and</span> <span class="n">avoid_goal</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">goal_pose</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]:</span>
                <span class="n">valid</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span>
                
    <span class="n">S</span> <span class="o">=</span> <span class="n">queue</span><span class="o">.</span><span class="n">Queue</span><span class="p">()</span>
    <span class="n">S</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="n">pose</span><span class="p">)</span>

    <span class="n">dist</span> <span class="o">=</span> <span class="mi">0</span>
    
    <span class="k">while</span> <span class="ow">not</span> <span class="n">S</span><span class="o">.</span><span class="n">empty</span><span class="p">():</span>
     
        <span class="n">node</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>

        <span class="n">node</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
        <span class="n">pose</span> <span class="o">=</span> <span class="n">node</span><span class="o">.</span><span class="n">clone</span><span class="p">()</span>

        <span class="n">token</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">act_store</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">dist</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">traj</span> <span class="o">=</span> <span class="p">[</span><span class="n">pose</span><span class="p">]</span>

        <span class="n">loc</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">path_distance</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="c1">#check for where this node</span>
        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
   
            <span class="n">loc</span> <span class="o">=</span> <span class="n">loc</span> <span class="o">+</span> <span class="mi">1</span>
            <span class="n">path_distance</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">pre_pose</span> <span class="o">=</span> <span class="n">pose</span>
            <span class="n">act</span> <span class="o">=</span> <span class="n">v_in</span><span class="p">[</span><span class="n">pose</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="n">pose</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>

            <span class="n">act_store</span><span class="p">[</span><span class="n">loc</span> <span class="o">%</span> <span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">act</span>

            <span class="c1">#check for goal </span>
            <span class="n">goal_position</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_goal</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">valid</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">==</span> <span class="mf">1.0</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">pose</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">goal_pose</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="ow">and</span> <span class="n">pose</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">goal_pose</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="mi">1</span><span class="p">]:</span>
                        <span class="n">goal_position</span> <span class="o">=</span> <span class="n">j</span>
            <span class="k">if</span> <span class="n">goal_position</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                <span class="k">break</span>
            <span class="c1">#repeat same two action</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">act_store</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">act_store</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">3</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">act_store</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">3</span> <span class="ow">and</span> <span class="n">act_store</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">):</span>
                <span class="n">token</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="k">break</span>

            <span class="k">if</span> <span class="p">(</span><span class="n">act_store</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">act_store</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">act_store</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">2</span> <span class="ow">and</span> <span class="n">act_store</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">):</span>
                <span class="n">token</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="k">break</span>   

            <span class="k">if</span> <span class="n">act</span><span class="o">.</span><span class="n">item</span><span class="p">()</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>
                <span class="n">goal_position</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
                <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_goal</span><span class="p">):</span>
                    <span class="k">if</span> <span class="n">pose</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">goal_pose</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="ow">and</span> <span class="n">pose</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">goal_pose</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="mi">1</span><span class="p">]:</span>
                        <span class="n">goal_position</span> <span class="o">=</span> <span class="n">j</span>
                <span class="k">if</span> <span class="n">goal_position</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                    <span class="k">break</span>
                <span class="k">else</span> <span class="p">:</span>
                    <span class="n">token</span> <span class="o">=</span> <span class="mi">0</span>
                    <span class="k">break</span>

            <span class="n">pose</span><span class="p">,</span><span class="n">obst</span> <span class="o">=</span> <span class="n">action</span><span class="p">(</span><span class="n">pose</span><span class="p">,</span><span class="n">act</span><span class="p">,</span><span class="n">Input</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,:,:]</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(),</span><span class="n">imsize</span><span class="p">)</span>   

            <span class="n">traj</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pose</span><span class="p">)</span>

            <span class="c1">#Hitting obstacle</span>
            <span class="k">if</span> <span class="n">obst</span><span class="p">:</span>
                <span class="n">token</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="k">break</span>
            <span class="c1">#repeat same position    </span>
            <span class="k">if</span> <span class="n">pose</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">pre_pose</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">and</span> <span class="n">pose</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">pre_pose</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
                <span class="n">token</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="k">break</span>

        <span class="k">if</span> <span class="n">token</span> <span class="p">:</span>
            <span class="n">pose</span> <span class="o">=</span> <span class="n">traj</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

            <span class="n">traj1</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>

                <span class="n">act</span> <span class="o">=</span> <span class="n">parent</span><span class="p">[</span><span class="n">pose</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="n">pose</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
                <span class="k">if</span> <span class="n">act</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>
                    <span class="k">break</span>
                <span class="n">pose</span><span class="p">,</span><span class="n">obst</span> <span class="o">=</span> <span class="n">action</span><span class="p">(</span><span class="n">pose</span><span class="p">,</span><span class="n">act</span><span class="p">,</span><span class="n">Input</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,:,:]</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(),</span><span class="n">imsize</span><span class="p">)</span>  
                <span class="n">traj1</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pose</span><span class="p">)</span>
                <span class="n">path_distance</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">traj1</span><span class="o">.</span><span class="n">reverse</span><span class="p">()</span>
            <span class="n">traj1</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">traj</span><span class="p">)</span>
            
            <span class="k">return</span> <span class="n">goal_position</span><span class="p">,</span><span class="n">path_distance</span><span class="p">,</span><span class="n">traj1</span>
        <span class="k">else</span> <span class="p">:</span>
            <span class="n">pose</span> <span class="o">=</span> <span class="n">node</span><span class="o">.</span><span class="n">clone</span><span class="p">()</span>
            
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
                <span class="n">new_pose</span><span class="p">,</span><span class="n">obst</span> <span class="o">=</span> <span class="n">action</span><span class="p">(</span><span class="n">S</span><span class="o">=</span><span class="n">pose</span><span class="p">,</span><span class="n">val</span><span class="o">=</span><span class="n">i</span><span class="p">,</span><span class="n">env</span><span class="o">=</span><span class="n">Input</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,:,:],</span><span class="n">imsize</span><span class="o">=</span><span class="n">imsize</span><span class="p">)</span> 
               
                <span class="k">if</span> <span class="ow">not</span> <span class="n">obst</span><span class="p">:</span>
                   
                    <span class="k">if</span> <span class="n">visited</span><span class="p">[</span><span class="n">new_pose</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="n">new_pose</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="n">S</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="n">new_pose</span><span class="p">)</span>
                        
                        <span class="n">visited</span><span class="p">[</span><span class="n">new_pose</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="n">new_pose</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="o">=</span> <span class="mf">1.0</span>
                        <span class="n">distance</span><span class="p">[</span><span class="n">new_pose</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="n">new_pose</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="o">=</span> <span class="n">dist</span>
                        <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
                            <span class="n">parent</span><span class="p">[</span><span class="n">new_pose</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="n">new_pose</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="o">=</span> <span class="mi">1</span>
                        <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                            <span class="n">parent</span><span class="p">[</span><span class="n">new_pose</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="n">new_pose</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="o">=</span> <span class="mi">0</span>
                        <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                            <span class="n">parent</span><span class="p">[</span><span class="n">new_pose</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="n">new_pose</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="o">=</span> <span class="mi">3</span>
                        <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                            <span class="n">parent</span><span class="p">[</span><span class="n">new_pose</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="n">new_pose</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="o">=</span> <span class="mi">2</span>
   
    <span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,[]</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[345]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">find_next_goal</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">agent_pose</span><span class="p">,</span><span class="n">imsize</span><span class="p">,</span><span class="n">avoid_goal</span><span class="p">,</span><span class="n">model</span><span class="p">,</span><span class="n">agent_no</span><span class="p">,</span><span class="n">n_goal</span><span class="p">,</span><span class="n">goal_pose</span><span class="p">):</span>
    
    <span class="n">model</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>
    <span class="n">token</span> <span class="o">=</span> <span class="mi">0</span>
    
    <span class="n">Input</span> <span class="o">=</span> <span class="n">agent_env_H</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">clone</span><span class="p">(),</span><span class="n">agent_pose</span><span class="p">,</span><span class="n">imsize</span><span class="p">,</span><span class="n">avoid_goal</span><span class="p">,</span><span class="n">token</span><span class="p">)</span>
    <span class="n">output</span><span class="p">,</span><span class="n">prediction</span><span class="p">,</span><span class="n">v_max</span><span class="p">,</span><span class="n">v_in</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">Input</span><span class="p">,</span><span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">agent_pose</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span><span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">agent_pose</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
    
    <span class="k">return</span> <span class="n">next_goal</span><span class="p">(</span><span class="n">agent_pose</span><span class="o">=</span><span class="n">agent_pose</span><span class="p">,</span><span class="n">imsize</span><span class="o">=</span><span class="n">imsize</span><span class="p">,</span><span class="n">Input</span><span class="o">=</span><span class="n">Input</span><span class="p">,</span><span class="n">v_in</span><span class="o">=</span><span class="n">v_in</span><span class="p">,</span><span class="n">goal_pose</span><span class="o">=</span><span class="n">goal_pose</span><span class="p">,</span><span class="n">n_goal</span><span class="o">=</span><span class="n">n_goal</span><span class="p">,</span><span class="n">avoid_goal</span><span class="o">=</span><span class="n">avoid_goal</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[346]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">cooperative</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">model</span><span class="p">,</span><span class="n">imsize</span><span class="p">):</span>
    <span class="n">age</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="mf">1.0</span><span class="p">)</span>
    <span class="n">agent_pose</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">column_stack</span><span class="p">([</span><span class="n">age</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">age</span><span class="p">[</span><span class="mi">1</span><span class="p">]])</span>
    <span class="n">n_agent</span> <span class="o">=</span> <span class="n">agent_pose</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="n">go</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mf">1.0</span><span class="p">)</span>
    <span class="n">goal_pose</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">column_stack</span><span class="p">([</span><span class="n">go</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">go</span><span class="p">[</span><span class="mi">1</span><span class="p">]])</span>
    <span class="n">n_goal</span> <span class="o">=</span> <span class="n">goal_pose</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="n">change</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">if</span> <span class="n">n_agent</span> <span class="o">&gt;=</span> <span class="n">n_goal</span><span class="p">:</span>
        <span class="n">temp</span> <span class="o">=</span> <span class="n">n_goal</span>
        <span class="n">n_goal</span><span class="o">=</span> <span class="n">n_agent</span>
        <span class="n">n_agent</span> <span class="o">=</span> <span class="n">temp</span>

        <span class="n">temp</span> <span class="o">=</span> <span class="n">agent_pose</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">agent_pose</span> <span class="o">=</span> <span class="n">goal_pose</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">goal_pose</span> <span class="o">=</span> <span class="n">temp</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

        <span class="n">temp</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">clone</span><span class="p">()</span>
        <span class="n">X</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">clone</span><span class="p">()</span>
        <span class="n">X</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">temp</span><span class="o">.</span><span class="n">clone</span><span class="p">()</span>

        <span class="n">change</span> <span class="o">=</span> <span class="mi">1</span>

    <span class="n">goal_agent</span> <span class="o">=</span> <span class="p">[[]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_goal</span><span class="p">)]</span>

    <span class="n">avoid_goal</span> <span class="o">=</span> <span class="p">[[]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_agent</span><span class="p">)]</span>

    <span class="n">trajectory</span> <span class="o">=</span> <span class="p">[[]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_agent</span><span class="p">)]</span>

    <span class="c1">#find next goal for all agent</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_agent</span><span class="p">):</span>
       <span class="c1"># print(agent_pose,avoid_goal,goal_pose)</span>
        <span class="n">g_pos</span><span class="p">,</span><span class="n">dist</span><span class="p">,</span><span class="n">traj</span> <span class="o">=</span> <span class="n">find_next_goal</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">clone</span><span class="p">(),</span><span class="n">agent_pose</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">imsize</span><span class="p">,</span><span class="n">avoid_goal</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">model</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">n_goal</span><span class="p">,</span><span class="n">goal_pose</span><span class="p">)</span>
        <span class="n">goal_agent</span><span class="p">[</span><span class="n">g_pos</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">i</span><span class="p">,</span><span class="n">dist</span><span class="p">])</span>
        <span class="c1">#print(g_pos,dist,traj)</span>
        <span class="n">trajectory</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">traj</span><span class="p">)</span>
    
    <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">while</span> <span class="n">count</span> <span class="o">&lt;</span> <span class="p">(</span><span class="n">n_agent</span> <span class="o">*</span> <span class="mi">10</span><span class="p">):</span>
        <span class="n">count</span> <span class="o">=</span> <span class="n">count</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="n">token</span> <span class="o">=</span> <span class="mi">1</span>
       <span class="c1"># print(goal_agent,avoid_goal)</span>
        <span class="k">for</span> <span class="n">key1</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_goal</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">goal_agent</span><span class="p">[</span><span class="n">key1</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">token</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">if</span> <span class="n">token</span><span class="p">:</span>
            <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_goal</span><span class="p">):</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">goal_agent</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="n">count</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">agent_traj</span> <span class="o">=</span> <span class="p">[[]</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_agent</span><span class="p">)]</span>
            <span class="n">traj_length</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1000</span>
            <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_agent</span><span class="p">):</span>
                <span class="n">agent_traj</span><span class="p">[</span><span class="n">v</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">trajectory</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">trajectory</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">&gt;</span> <span class="n">traj_length</span><span class="p">:</span>
                    <span class="n">traj_length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">trajectory</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
                    
            <span class="k">return</span> <span class="n">count</span><span class="p">,</span><span class="n">n_agent</span><span class="p">,</span><span class="n">traj_length</span><span class="p">,</span><span class="n">agent_traj</span>
        <span class="c1">#find the conflict</span>
        <span class="k">for</span> <span class="n">key1</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_goal</span><span class="p">):</span>
            <span class="c1">#check for conflict</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">goal_agent</span><span class="p">[</span><span class="n">key1</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">same_agent</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="n">min_dist</span> <span class="o">=</span> <span class="mi">100</span>
                <span class="n">min_index</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
                <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">goal_agent</span><span class="p">[</span><span class="n">key1</span><span class="p">]:</span>
                    <span class="n">same_agent</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">j</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                    <span class="k">if</span> <span class="n">min_dist</span> <span class="o">&gt;</span> <span class="n">j</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
                        <span class="n">min_dist</span> <span class="o">=</span> <span class="n">j</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                        <span class="n">min_index</span> <span class="o">=</span> <span class="n">j</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

                <span class="n">next_goal_agent</span> <span class="o">=</span> <span class="p">[[]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_goal</span><span class="p">)]</span>

                <span class="c1">#find goal next goal for conflicted agent</span>
                <span class="n">L</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">same_agent</span><span class="p">)</span>
                <span class="n">problem</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="k">for</span> <span class="n">age</span> <span class="ow">in</span> <span class="n">same_agent</span><span class="p">:</span>
                    <span class="n">avoid_goal</span><span class="p">[</span><span class="n">age</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">goal_pose</span><span class="p">[</span><span class="n">key1</span><span class="p">])</span>
                    <span class="n">g_pos</span><span class="p">,</span><span class="n">dist</span><span class="p">,</span><span class="n">traj</span> <span class="o">=</span> <span class="n">find_next_goal</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">clone</span><span class="p">(),</span><span class="n">agent_pose</span><span class="p">[</span><span class="n">age</span><span class="p">],</span><span class="n">imsize</span><span class="p">,</span><span class="n">avoid_goal</span><span class="p">[</span><span class="n">age</span><span class="p">],</span><span class="n">model</span><span class="p">,</span><span class="n">age</span><span class="p">,</span><span class="n">n_goal</span><span class="p">,</span><span class="n">goal_pose</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">g_pos</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                        <span class="n">trajectory</span><span class="p">[</span><span class="n">age</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">traj</span><span class="p">)</span>
                        <span class="n">next_goal_agent</span><span class="p">[</span><span class="n">g_pos</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">age</span><span class="p">,</span><span class="n">dist</span><span class="p">])</span>
                    <span class="k">else</span> <span class="p">:</span>
                        <span class="n">problem</span> <span class="o">=</span> <span class="mi">1</span>
                        <span class="n">avoid_goal</span><span class="p">[</span><span class="n">age</span><span class="p">]</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
                        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">goal_agent</span><span class="p">[</span><span class="n">key1</span><span class="p">]:</span>
                            <span class="k">if</span> <span class="n">j</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">age</span><span class="p">:</span>
                                <span class="n">next_goal_agent</span><span class="p">[</span><span class="n">key1</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">j</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">j</span><span class="p">[</span><span class="mi">1</span><span class="p">]])</span>
                
               <span class="c1"># print(next_goal_agent)</span>
                <span class="c1">#check for newly created conflict</span>
                <span class="n">new_conflict</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="n">new_conflict_index</span> <span class="o">=</span> <span class="p">[]</span>

                <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_goal</span><span class="p">):</span>
                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">next_goal_agent</span><span class="p">[</span><span class="n">v</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                        <span class="n">new_conflict</span> <span class="o">+=</span><span class="mi">1</span>
                        <span class="n">new_conflict_index</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>


                <span class="n">next_next_goal_agent</span> <span class="o">=</span> <span class="p">[[]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_goal</span><span class="p">)]</span>
                
                <span class="k">if</span> <span class="n">new_conflict</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">problem</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="n">goal_agent</span><span class="p">[</span><span class="n">key1</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
                    <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_goal</span><span class="p">):</span>
                        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">next_goal_agent</span><span class="p">[</span><span class="n">key</span><span class="p">]:</span>
                            <span class="n">goal_agent</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">j</span><span class="p">)</span>
                <span class="c1">#No new conflict</span>
                <span class="k">if</span> <span class="n">new_conflict</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">problem</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">avoid_goal</span><span class="p">[</span><span class="n">min_index</span><span class="p">]</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
                    <span class="n">trajectory</span><span class="p">[</span><span class="n">min_index</span><span class="p">]</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
                    <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_goal</span><span class="p">):</span>
                        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">next_goal_agent</span><span class="p">[</span><span class="n">key</span><span class="p">])</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                            <span class="c1">#find where this agent made goal and make them null set</span>
                            <span class="k">if</span> <span class="n">next_goal_agent</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">min_index</span><span class="p">:</span>
                                <span class="n">next_goal_agent</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
                    
                    <span class="n">next_goal_agent</span><span class="p">[</span><span class="n">key1</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">min_index</span><span class="p">,</span><span class="n">min_dist</span><span class="p">])</span>
                <span class="c1">#    print(next_goal_agent)</span>
                    <span class="n">goal_agent</span><span class="p">[</span><span class="n">key1</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
                    <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_goal</span><span class="p">):</span>
                        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">next_goal_agent</span><span class="p">[</span><span class="n">key</span><span class="p">]:</span>
                            <span class="n">goal_agent</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">j</span><span class="p">)</span>
                <span class="k">else</span> <span class="p">:</span>
                    <span class="k">for</span> <span class="n">key2</span> <span class="ow">in</span> <span class="n">new_conflict_index</span><span class="p">:</span>
                        <span class="c1">#code for same agent or partial agent</span>
                        <span class="n">max_dist</span> <span class="o">=</span> <span class="mi">0</span>
                        <span class="n">max_index</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
                        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">next_goal_agent</span><span class="p">[</span><span class="n">key2</span><span class="p">]:</span>
                            <span class="k">if</span> <span class="n">max_dist</span> <span class="o">&lt;</span> <span class="n">j</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
                                <span class="n">max_dist</span> <span class="o">=</span> <span class="n">j</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                                <span class="n">max_index</span> <span class="o">=</span> <span class="n">j</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

                        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">next_goal_agent</span><span class="p">[</span><span class="n">key2</span><span class="p">]:</span>
                            <span class="c1">#put largest dist to goal</span>
                            <span class="k">if</span> <span class="n">j</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">max_index</span><span class="p">:</span>
                                <span class="n">trajectory</span><span class="p">[</span><span class="n">max_index</span><span class="p">]</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
                                <span class="n">avoid_goal</span><span class="p">[</span><span class="n">max_index</span><span class="p">]</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
                                <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_goal</span><span class="p">):</span>
                                    <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">goal_agent</span><span class="p">[</span><span class="n">c</span><span class="p">]:</span>
                                        <span class="k">if</span> <span class="n">d</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">max_index</span><span class="p">:</span>
                                            <span class="n">next_next_goal_agent</span><span class="p">[</span><span class="n">key1</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">d</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">d</span><span class="p">[</span><span class="mi">1</span><span class="p">]])</span>
                            <span class="k">else</span> <span class="p">:</span>
                                <span class="n">next_next_goal_agent</span><span class="p">[</span><span class="n">key2</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">j</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">j</span><span class="p">[</span><span class="mi">1</span><span class="p">]])</span>

                        <span class="n">goal_agent</span><span class="p">[</span><span class="n">key1</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
                        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_goal</span><span class="p">):</span>
                            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">next_next_goal_agent</span><span class="p">[</span><span class="n">key</span><span class="p">]:</span>
                                <span class="n">goal_agent</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">j</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[348]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">correct</span><span class="p">,</span> <span class="n">traj_step</span><span class="p">,</span> <span class="n">total</span><span class="p">,</span><span class="n">total_env</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span>

<span class="n">X</span><span class="p">,</span><span class="n">S</span><span class="p">,</span><span class="n">label</span> <span class="o">=</span> <span class="n">test_data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

<span class="n">prev_env</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">clone</span><span class="p">()</span>

<span class="n">whole_traj_act</span> <span class="o">=</span> <span class="p">[]</span>

<span class="n">Trajectory</span> <span class="o">=</span> <span class="p">[</span><span class="n">S</span><span class="p">]</span>
<span class="n">Action</span>  <span class="o">=</span> <span class="p">[</span><span class="n">label</span><span class="p">]</span>

<span class="n">go</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mf">1.0</span><span class="p">)</span> 
<span class="n">goal</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">column_stack</span><span class="p">([</span><span class="n">go</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">go</span><span class="p">[</span><span class="mi">1</span><span class="p">]])</span>

<span class="n">end</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">test_data</span><span class="p">)</span>


<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">end</span><span class="p">):</span>
    <span class="n">X</span><span class="p">,</span><span class="n">S</span><span class="p">,</span><span class="n">label</span> <span class="o">=</span> <span class="n">test_data</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    
    <span class="n">new_env</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">clone</span><span class="p">()</span>
    
    
    <span class="k">if</span> <span class="p">(</span><span class="n">new_env</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">prev_env</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">==</span> <span class="mf">0.0</span><span class="p">:</span>

        <span class="k">if</span> <span class="n">label</span> <span class="o">!=</span> <span class="mi">4</span><span class="p">:</span>
            <span class="n">Trajectory</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">S</span><span class="p">)</span>
            <span class="n">Action</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">label</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">Trajectory</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">S</span><span class="p">)</span>
            <span class="n">Action</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">label</span><span class="p">)</span>
            <span class="n">whole_traj_act</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">Trajectory</span><span class="p">,</span><span class="n">Action</span><span class="p">])</span>
            <span class="n">Trajectory</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">Action</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">else</span> <span class="p">:</span>
        <span class="c1">#call the function with prev_new and whole traj act</span>
        <span class="n">total_env</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="c1">#correct_goal,total_goal, traj_length,traj = agent_prediction(model_5x5,prev_env.clone(),whole_traj_act,goal,7,0)</span>
        <span class="n">correct_goal</span><span class="p">,</span><span class="n">total_goal</span><span class="p">,</span> <span class="n">traj_length</span><span class="p">,</span><span class="n">traj</span> <span class="o">=</span> <span class="n">cooperative</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="n">model_5x5</span><span class="p">,</span><span class="n">X</span><span class="o">=</span><span class="n">prev_env</span><span class="o">.</span><span class="n">clone</span><span class="p">(),</span><span class="n">imsize</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
        
        <span class="n">total</span> <span class="o">+=</span> <span class="n">total_goal</span>

        <span class="n">correct</span> <span class="o">+=</span> <span class="n">correct_goal</span>
        <span class="n">traj_step</span> <span class="o">+=</span> <span class="n">traj_length</span>
        
        <span class="n">prev_env</span> <span class="o">=</span> <span class="n">new_env</span><span class="o">.</span><span class="n">clone</span><span class="p">()</span>
        
        
        <span class="n">whole_traj_act</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">go</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">prev_env</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mf">1.0</span><span class="p">)</span> 
        <span class="n">goal</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">column_stack</span><span class="p">([</span><span class="n">go</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">go</span><span class="p">[</span><span class="mi">1</span><span class="p">]])</span>
        
        
<span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;Goal_accuray: {correct /total}&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">correct</span><span class="p">,</span><span class="n">total</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;Average_Step_error_in_each_domain : {traj_step/total_env}&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">traj_step</span><span class="p">,</span><span class="n">total_env</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt"></div>


<div class="output_subarea output_stream output_stderr output_text">
<pre>C:\Users\Welcome\Anaconda3\lib\site-packages\ipykernel_launcher.py:31: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
</pre>
</div>
</div>

<div class="output_area">

<div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Goal_accuray: 0.9937945603379984
7527.0 7574.0
Average_Step_error_in_each_domain : 3.998371335504886
19640.0 4912.0
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[349]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">correct</span><span class="p">,</span> <span class="n">traj_step</span><span class="p">,</span> <span class="n">total</span><span class="p">,</span><span class="n">total_env</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span>

<span class="n">X</span><span class="p">,</span><span class="n">S</span><span class="p">,</span><span class="n">label</span> <span class="o">=</span> <span class="n">test_data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

<span class="n">prev_env</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">clone</span><span class="p">()</span>

<span class="n">whole_traj_act</span> <span class="o">=</span> <span class="p">[]</span>

<span class="n">Trajectory</span> <span class="o">=</span> <span class="p">[</span><span class="n">S</span><span class="p">]</span>
<span class="n">Action</span>  <span class="o">=</span> <span class="p">[</span><span class="n">label</span><span class="p">]</span>

<span class="n">go</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mf">1.0</span><span class="p">)</span> 
<span class="n">goal</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">column_stack</span><span class="p">([</span><span class="n">go</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">go</span><span class="p">[</span><span class="mi">1</span><span class="p">]])</span>

<span class="n">end</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">test_data</span><span class="p">)</span>


<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">80</span><span class="p">):</span>
    <span class="n">X</span><span class="p">,</span><span class="n">S</span><span class="p">,</span><span class="n">label</span> <span class="o">=</span> <span class="n">test_data</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    
    <span class="n">new_env</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">clone</span><span class="p">()</span>
    
   
    <span class="k">if</span> <span class="p">(</span><span class="n">new_env</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">prev_env</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">==</span> <span class="mf">0.0</span><span class="p">:</span>

        <span class="k">if</span> <span class="n">label</span> <span class="o">!=</span> <span class="mi">4</span><span class="p">:</span>
            <span class="n">Trajectory</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">S</span><span class="p">)</span>
            <span class="n">Action</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">label</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">Trajectory</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">S</span><span class="p">)</span>
            <span class="n">Action</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">label</span><span class="p">)</span>
            <span class="n">whole_traj_act</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">Trajectory</span><span class="p">,</span><span class="n">Action</span><span class="p">])</span>
            <span class="n">Trajectory</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">Action</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">else</span> <span class="p">:</span>
        <span class="c1">#call the function with prev_new and whole traj act</span>
        <span class="n">total_env</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="c1">#correct_goal,total_goal, traj_length,traj = agent_prediction(model_5x5,prev_env.clone(),whole_traj_act,goal,7,0)</span>
        <span class="n">correct_goal</span><span class="p">,</span><span class="n">total_goal</span><span class="p">,</span> <span class="n">traj_length</span><span class="p">,</span><span class="n">traj</span> <span class="o">=</span> <span class="n">cooperative</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="n">model_5x5</span><span class="p">,</span><span class="n">X</span><span class="o">=</span><span class="n">prev_env</span><span class="o">.</span><span class="n">clone</span><span class="p">(),</span><span class="n">imsize</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
        
        <span class="n">total</span> <span class="o">+=</span> <span class="n">total_goal</span>

        <span class="c1">#visualization(prev_env[0] - 0.5 * prev_env[1]+ abs(prev_env[2]),whole_traj_act,traj)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">correct_goal</span><span class="p">,</span><span class="n">total_goal</span><span class="p">,</span><span class="n">traj_length</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">prev_env</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="mf">0.5</span><span class="o">*</span> <span class="n">prev_env</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="nb">abs</span><span class="p">(</span><span class="n">prev_env</span><span class="p">[</span><span class="mi">2</span><span class="p">]))</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">traj</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">i</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="n">end</span><span class="o">=</span><span class="s2">&quot;-&gt;&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;End&#39;</span><span class="p">)</span>
        <span class="n">correct</span> <span class="o">+=</span> <span class="n">correct_goal</span>
        <span class="n">traj_step</span> <span class="o">+=</span> <span class="n">traj_length</span>
        
        <span class="n">prev_env</span> <span class="o">=</span> <span class="n">new_env</span><span class="o">.</span><span class="n">clone</span><span class="p">()</span>
        
        
        <span class="n">whole_traj_act</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">go</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">prev_env</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mf">1.0</span><span class="p">)</span> 
        <span class="n">goal</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">column_stack</span><span class="p">([</span><span class="n">go</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">go</span><span class="p">[</span><span class="mi">1</span><span class="p">]])</span>
        
        
<span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;Goal_accuray: {correct /total}&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">correct</span><span class="p">,</span><span class="n">total</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;Average_Step_to_goal_in_each_domain : {traj_step/total_env}&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">traj_step</span><span class="p">,</span><span class="n">total_env</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>5 1 1 4
</pre>
</div>
</div>

<div class="output_area">

<div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

<div class="output_area">

<div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>[tensor([2, 1]), tensor([2, 2]), tensor([2, 3]), tensor([2, 4])]-&gt;End
14 1 1 9
</pre>
</div>
</div>

<div class="output_area">

<div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
bttf7rsxADPXdjbZLyQ9muRbtk+UdEqPPQHoyLQBtz1P0iWSviNJSQ5LOtxvWwC60GYX/XOS3pD0
G9vP217bzCj7L4wPBsZPm4CfIOkiSb9KskTSe5JuOXajJGuSLE2ydLZO6rhNAB9Hm4Dvl7Q/ydbm
+f2aCDyAMTdtwJP8XdJrts9rvnSppJd77QpAJ9qeRf+hpLubM+j7JH23v5YAdKVVwJPslLS0514A
dIx3sgGFEXCgMAIOFEbAgcIIOFAYAQcKI+BAYQQcKIyAA4URcKCwXsYH235D0t8+5l8/U9KbHbZD
bWpXrP3ZJGdNt1EvAZ8J29uSjOR979SmdrXa7KIDhRFwoLBxDPgaalOb2t0Yu2NwAN0ZxxUcQEfG
KuC2V9p+xfZe2x+5c2uPddfbPmj7paFqTqq9yPZTzcSYXbZXD1h7ju1nbb/Q1L5tqNqTepjV3I77
4YHrvmr7Rds7bW8buPZgk4LGZhfd9ixJf5H0NU3cyfU5Sdcl6f0Gj7YvkXRI0u+SXNB3vWNqz5c0
P8kO26dJ2i7pGwP93JY0N8kh27MlPS1pdZJn+q49qYcfa+J2YPOSXDVg3VclLU0y+Ovgtu+U9Mck
a49OCkrydh+1xmkFXyZpb5J9zfSUDZKuGaJwki2S3hqi1hS1X0+yo3n8rqTdkhYMVDtJDjVPZzcf
g/3Gt71Q0pWS1g5Vc9QmTQpaJ01MCuor3NJ4BXyBpNcmPd+vgf6jjwvbiyUtkbT1f2/Zac1ZtndK
Oihp06T73w/hDkk3S/pwwJpHRdLjtrfbXjVg3VaTgroyTgH3FF8bj+OHAdg+VdIDkm5K8s5QdZN8
kORCSQslLbM9yCGK7askHUyyfYh6U1ie5CJJV0j6QXOYNoRWk4K6Mk4B3y9p0aTnCyUdGFEvg2qO
fx+QdHeSB0fRQ7ObuFnSyoFKLpd0dXMsvEHSCtt3DVRbSQ40nw9K2qiJQ8QhDDopaJwC/pykc22f
05x4uFbSQyPuqXfNia51knYnuX3g2mfZPr15fLKkyyTtGaJ2kluTLEyyWBP/1k8muX6I2rbnNic0
1eweXy5pkFdQhp4U1HaySe+SHLF9o6THJM2StD7JriFq275X0lcknWl7v6SfJVk3RG1NrGQ3SHqx
ORaWpJ8meWSA2vMl3dm8gvEpSfclGfTlqhE5W9LGid+tOkHSPUkeHbD+YJOCxuZlMgDdG6dddAAd
I+BAYQQcKIyAA4URcKAwAg4URsCBwgg4UNi/AdTIwpnzJJ1nAAAAAElFTkSuQmCC
"
>
</div>

</div>

<div class="output_area">

<div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>[tensor([1, 2]), tensor([1, 3]), tensor([2, 3]), tensor([2, 4]), tensor([2, 5]), tensor([3, 5]), tensor([4, 5]), tensor([5, 5]), tensor([5, 4])]-&gt;End
20 1 1 5
</pre>
</div>
</div>

<div class="output_area">

<div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

<div class="output_area">

<div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>[tensor([5, 1]), tensor([5, 2]), tensor([4, 2]), tensor([3, 2]), tensor([2, 2])]-&gt;End
25 1 1 5
</pre>
</div>
</div>

<div class="output_area">

<div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

<div class="output_area">

<div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>[tensor([3, 4]), tensor([3, 3]), tensor([3, 2]), tensor([2, 2]), tensor([2, 1])]-&gt;End
28 1 1 3
</pre>
</div>
</div>

<div class="output_area">

<div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

<div class="output_area">

<div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>[tensor([1, 5]), tensor([2, 5]), tensor([3, 5])]-&gt;End
34 1 1 5
</pre>
</div>
</div>

<div class="output_area">

<div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

<div class="output_area">

<div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>[tensor([4, 5]), tensor([3, 5]), tensor([3, 4]), tensor([2, 4]), tensor([1, 4])]-&gt;End
44 1 1 3
</pre>
</div>
</div>

<div class="output_area">

<div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

<div class="output_area">

<div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>[tensor([2, 5]), tensor([2, 4]), tensor([1, 4])]-&gt;End
61 3 3 3
</pre>
</div>
</div>

<div class="output_area">

<div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
AABJRU5ErkJggg==
"
>
</div>

</div>

<div class="output_area">

<div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>[tensor([2, 2]), tensor([2, 1])]-&gt;End
[tensor([2, 4]), tensor([3, 4])]-&gt;End
[tensor([5, 1]), tensor([5, 2]), tensor([4, 2])]-&gt;End
76 2 2 8
</pre>
</div>
</div>

<div class="output_area">

<div class="prompt"></div>


<div class="output_subarea output_stream output_stderr output_text">
<pre>C:\Users\Welcome\Anaconda3\lib\site-packages\ipykernel_launcher.py:31: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
</pre>
</div>
</div>

<div class="output_area">

<div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
O4IAAAAASUVORK5CYII=
"
>
</div>

</div>

<div class="output_area">

<div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>[tensor([2, 1]), tensor([2, 2]), tensor([2, 3]), tensor([2, 4]), tensor([3, 4]), tensor([4, 4]), tensor([5, 4]), tensor([5, 3])]-&gt;End
[tensor([4, 5]), tensor([4, 4]), tensor([5, 4]), tensor([5, 3]), tensor([5, 2]), tensor([5, 1]), tensor([4, 1])]-&gt;End
Goal_accuray: 1.0
12.0 12.0
Average_Step_to_goal_in_each_domain : 5.0
45.0 9.0
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Experiment">Experiment<a class="anchor-link" href="#Experiment">&#182;</a></h4>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[350]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">X</span><span class="p">,</span><span class="n">S</span><span class="p">,</span><span class="n">label</span> <span class="o">=</span> <span class="n">test_data</span><span class="p">[</span><span class="mi">61</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[351]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">age</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span> <span class="o">==</span> <span class="mf">1.0</span><span class="p">)</span>
<span class="n">agent_pose</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">column_stack</span><span class="p">([</span><span class="n">age</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">age</span><span class="p">[</span><span class="mi">1</span><span class="p">]])</span>
<span class="n">n_agent</span> <span class="o">=</span> <span class="n">agent_pose</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="n">go</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mf">1.0</span><span class="p">)</span>
<span class="n">goal_pose</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">column_stack</span><span class="p">([</span><span class="n">go</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">go</span><span class="p">[</span><span class="mi">1</span><span class="p">]])</span>
<span class="n">n_goal</span> <span class="o">=</span> <span class="n">goal_pose</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="n">change</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">if</span> <span class="n">n_agent</span> <span class="o">&gt;=</span> <span class="n">n_goal</span><span class="p">:</span>
    <span class="n">temp</span> <span class="o">=</span> <span class="n">n_goal</span>
    <span class="n">n_goal</span><span class="o">=</span> <span class="n">n_agent</span>
    <span class="n">n_agent</span> <span class="o">=</span> <span class="n">temp</span>
    <span class="n">temp</span> <span class="o">=</span> <span class="n">agent_pose</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">agent_pose</span> <span class="o">=</span> <span class="n">goal_pose</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">goal_pose</span> <span class="o">=</span> <span class="n">temp</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">temp</span> <span class="o">=</span><span class="nb">abs</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="o">.</span><span class="n">clone</span><span class="p">()</span>
    <span class="n">X</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">clone</span><span class="p">()</span>
    <span class="n">X</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">temp</span><span class="o">.</span><span class="n">clone</span><span class="p">()</span>
    <span class="n">change</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">avoid_goal</span> <span class="o">=</span> <span class="p">[[]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_agent</span><span class="p">)]</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[352]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">model_5x5</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>
<span class="n">token</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">age</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">Input</span> <span class="o">=</span> <span class="n">agent_env_H</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">clone</span><span class="p">(),</span><span class="n">agent_pose</span><span class="p">[</span><span class="n">age</span><span class="p">],</span><span class="mi">7</span><span class="p">,[],</span><span class="n">token</span><span class="p">)</span>
<span class="n">output</span><span class="p">,</span><span class="n">prediction</span><span class="p">,</span><span class="n">v_max</span><span class="p">,</span><span class="n">v_in</span> <span class="o">=</span> <span class="n">model_5x5</span><span class="p">(</span><span class="n">Input</span><span class="p">,</span><span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">agent_pose</span><span class="p">[</span><span class="n">age</span><span class="p">][</span><span class="mi">0</span><span class="p">]),</span><span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">agent_pose</span><span class="p">[</span><span class="n">age</span><span class="p">][</span><span class="mi">1</span><span class="p">]))</span>
    
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[353]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">v_in</span><span class="p">,</span><span class="n">goal_pose</span><span class="p">,</span><span class="n">agent_pose</span><span class="p">[</span><span class="n">age</span><span class="p">]</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt output_prompt">Out[353]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>(tensor([[[[0, 3, 3, 3, 3, 1, 2],
           [2, 3, 3, 2, 3, 0, 2],
           [2, 3, 3, 2, 3, 0, 2],
           [2, 3, 3, 3, 3, 0, 2],
           [2, 4, 0, 3, 3, 0, 0],
           [2, 1, 2, 4, 0, 0, 0],
           [1, 1, 1, 1, 1, 1, 0]]]]), array([[4, 1],
        [5, 3]], dtype=int64), array([2, 1], dtype=int64))</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[354]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">Input</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,:,:])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">Input</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,:,:])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">Input</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,:,:])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

<div class="output_area">

<div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
AbKAqIfKQW/lAAAAAElFTkSuQmCC
"
>
</div>

</div>

<div class="output_area">

<div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
TkSuQmCC
"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[283]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">X</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">correct</span> <span class="p">,</span><span class="n">total</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt output_prompt">Out[283]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>(tensor([[0., 0., 0., 0., 0., 0., 0.],
         [0., 0., 0., 1., 1., 1., 0.],
         [0., 1., 1., 0., 1., 1., 0.],
         [0., 0., 1., 1., 0., 1., 0.],
         [0., 0., 0., 1., 1., 1., 0.],
         [0., 0., 1., 1., 1., 1., 0.],
         [0., 0., 0., 0., 0., 0., 0.]], dtype=torch.float64), 115.0, 117.0)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[355]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="mf">0.5</span><span class="o">*</span><span class="n">X</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="nb">abs</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="mi">2</span><span class="p">]))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
5jtoAAAAAElFTkSuQmCC
"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[617]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">visited</span> <span class="o">=</span> <span class="n">Input</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,:,:]</span><span class="o">.</span><span class="n">clone</span><span class="p">()</span>
<span class="n">distance</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">visited</span><span class="p">)</span>
<span class="n">parent</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">visited</span><span class="p">)</span> <span class="o">*</span> <span class="o">-</span><span class="mi">1</span>

<span class="n">v_in</span> <span class="o">=</span> <span class="n">v_in</span><span class="o">.</span><span class="n">squeeze</span><span class="p">()</span>
  
<span class="n">pose</span> <span class="o">=</span> <span class="n">agent_pose</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="n">visited</span><span class="p">[</span><span class="n">pose</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="n">pose</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="n">distance</span><span class="p">[</span><span class="n">pose</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="n">pose</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="n">parent</span><span class="p">[</span><span class="n">pose</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="n">pose</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="o">=</span> <span class="mi">4</span>

<span class="n">av</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">avoid_goal</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="c1">#valid goal location</span>
<span class="n">valid</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.0</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_goal</span><span class="p">)]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_goal</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">av</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">avoid_goal</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">goal_pose</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="ow">and</span> <span class="n">avoid_goal</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">goal_pose</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]:</span>
            <span class="n">valid</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span>
            
<span class="n">S</span> <span class="o">=</span> <span class="n">queue</span><span class="o">.</span><span class="n">Queue</span><span class="p">()</span>
<span class="n">S</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="n">pose</span><span class="p">)</span>

<span class="n">dist</span> <span class="o">=</span> <span class="mi">0</span>
    
<span class="k">while</span> <span class="ow">not</span> <span class="n">S</span><span class="o">.</span><span class="n">empty</span><span class="p">():</span>
     
    <span class="n">node</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>

    <span class="n">node</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
    <span class="n">pose</span> <span class="o">=</span> <span class="n">node</span><span class="o">.</span><span class="n">clone</span><span class="p">()</span>
  <span class="c1">#  print(pose)</span>
 
    <span class="n">token</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">act_store</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">dist</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="n">traj</span> <span class="o">=</span> <span class="p">[</span><span class="n">pose</span><span class="p">]</span>

    <span class="n">loc</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">path_distance</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="c1">#check for where this node</span>
    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
   
        <span class="n">loc</span> <span class="o">=</span> <span class="n">loc</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="n">path_distance</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">pre_pose</span> <span class="o">=</span> <span class="n">pose</span>
        <span class="n">act</span> <span class="o">=</span> <span class="n">v_in</span><span class="p">[</span><span class="n">pose</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="n">pose</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>

        <span class="n">act_store</span><span class="p">[</span><span class="n">loc</span> <span class="o">%</span> <span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">act</span>
        
        <span class="c1">#check for goal </span>
        <span class="n">goal_position</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_goal</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">valid</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">==</span> <span class="mf">1.0</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">pose</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">goal_pose</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="ow">and</span> <span class="n">pose</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">goal_pose</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="mi">1</span><span class="p">]:</span>
                    <span class="n">goal_position</span> <span class="o">=</span> <span class="n">j</span>
        <span class="k">if</span> <span class="n">goal_position</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">goal_position</span><span class="p">)</span>
            <span class="k">break</span>
                
        <span class="c1">#repeat same two action</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">act_store</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">act_store</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">3</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">act_store</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">3</span> <span class="ow">and</span> <span class="n">act_store</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">):</span>
            <span class="n">token</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">break</span>

        <span class="k">if</span> <span class="p">(</span><span class="n">act_store</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">act_store</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">act_store</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">2</span> <span class="ow">and</span> <span class="n">act_store</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">):</span>
            <span class="n">token</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">break</span>   

        <span class="k">if</span> <span class="n">act</span><span class="o">.</span><span class="n">item</span><span class="p">()</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>
            <span class="n">goal_position</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_goal</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">pose</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">goal_pose</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="ow">and</span> <span class="n">pose</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">goal_pose</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="mi">1</span><span class="p">]:</span>
                    <span class="n">goal_position</span> <span class="o">=</span> <span class="n">j</span>
            <span class="k">if</span> <span class="n">goal_position</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                <span class="k">break</span>
            <span class="k">else</span> <span class="p">:</span>
                <span class="n">token</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="k">break</span>

        <span class="n">pose</span><span class="p">,</span><span class="n">obst</span> <span class="o">=</span> <span class="n">action</span><span class="p">(</span><span class="n">pose</span><span class="p">,</span><span class="n">act</span><span class="p">,</span><span class="n">Input</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,:,:]</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(),</span><span class="n">imsize</span><span class="p">)</span>   

        <span class="n">traj</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pose</span><span class="p">)</span>

        <span class="c1">#Hitting obstacle</span>
        <span class="k">if</span> <span class="n">obst</span><span class="p">:</span>
            <span class="n">token</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">break</span>
        <span class="c1">#repeat same position    </span>
        <span class="k">if</span> <span class="n">pose</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">pre_pose</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">and</span> <span class="n">pose</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">pre_pose</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
            <span class="n">token</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">break</span>

    <span class="k">if</span> <span class="n">token</span> <span class="p">:</span>
        <span class="n">pose</span> <span class="o">=</span> <span class="n">traj</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;traj&#39;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">traj</span><span class="p">)</span>
        <span class="n">traj1</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>

            <span class="n">act</span> <span class="o">=</span> <span class="n">parent</span><span class="p">[</span><span class="n">pose</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="n">pose</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
            <span class="k">if</span> <span class="n">act</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>
                <span class="k">break</span>
            <span class="n">pose</span><span class="p">,</span><span class="n">obst</span> <span class="o">=</span> <span class="n">action</span><span class="p">(</span><span class="n">pose</span><span class="p">,</span><span class="n">act</span><span class="p">,</span><span class="n">Input</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,:,:]</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(),</span><span class="n">imsize</span><span class="p">)</span>  
            <span class="n">traj1</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pose</span><span class="p">)</span>
            <span class="n">path_distance</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">traj1</span><span class="o">.</span><span class="n">reverse</span><span class="p">()</span>
        <span class="n">traj1</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">traj</span><span class="p">)</span>
        
        <span class="nb">print</span><span class="p">(</span><span class="n">goal_position</span><span class="p">,</span><span class="n">path_distance</span><span class="p">,</span><span class="n">traj1</span><span class="p">)</span>
        <span class="k">break</span>
    <span class="k">else</span> <span class="p">:</span>
        <span class="n">pose</span> <span class="o">=</span> <span class="n">node</span><span class="o">.</span><span class="n">clone</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
            <span class="n">new_pose</span><span class="p">,</span><span class="n">obst</span> <span class="o">=</span> <span class="n">action</span><span class="p">(</span><span class="n">pose</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">Input</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,:,:]</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(),</span><span class="n">imsize</span><span class="p">)</span> 
            <span class="k">if</span> <span class="ow">not</span> <span class="n">obst</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">visited</span><span class="p">[</span><span class="n">new_pose</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="n">new_pose</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">S</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="n">new_pose</span><span class="p">)</span>
                    <span class="n">visited</span><span class="p">[</span><span class="n">new_pose</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="n">new_pose</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="o">=</span> <span class="mf">1.0</span>
                    <span class="n">distance</span><span class="p">[</span><span class="n">new_pose</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="n">new_pose</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="o">=</span> <span class="n">dist</span>
                    <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
                        <span class="n">parent</span><span class="p">[</span><span class="n">new_pose</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="n">new_pose</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="o">=</span> <span class="mi">1</span>
                    <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                        <span class="n">parent</span><span class="p">[</span><span class="n">new_pose</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="n">new_pose</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="o">=</span> <span class="mi">0</span>
                    <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                        <span class="n">parent</span><span class="p">[</span><span class="n">new_pose</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="n">new_pose</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="o">=</span> <span class="mi">3</span>
                    <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="n">parent</span><span class="p">[</span><span class="n">new_pose</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="n">new_pose</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="o">=</span> <span class="mi">2</span>
    
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>2
traj
[tensor([5, 5])]
2 9 [tensor([1, 1]), tensor([1, 2]), tensor([2, 2]), tensor([3, 2]), tensor([3, 3]), tensor([3, 4]), tensor([4, 4]), tensor([4, 5]), tensor([5, 5])]
</pre>
</div>
</div>

<div class="output_area">

<div class="prompt"></div>


<div class="output_subarea output_stream output_stderr output_text">
<pre>C:\Users\Welcome\Anaconda3\lib\site-packages\ipykernel_launcher.py:31: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[625]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">av</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">avoid_goal</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">avoid_goal</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
    <span class="c1">#if avoid_goal[j][0] == goal_pose[i][0] and avoid_goal[j][1] == goal_pose[i][1]:</span>
        
            
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>3
3
3
4
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[338]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">age</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="mf">1.0</span><span class="p">)</span>
<span class="n">agent_pose</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">column_stack</span><span class="p">([</span><span class="n">age</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">age</span><span class="p">[</span><span class="mi">1</span><span class="p">]])</span>
<span class="n">n_agent</span> <span class="o">=</span> <span class="n">agent_pose</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="n">go</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mf">1.0</span><span class="p">)</span>
<span class="n">goal_pose</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">column_stack</span><span class="p">([</span><span class="n">go</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">go</span><span class="p">[</span><span class="mi">1</span><span class="p">]])</span>
<span class="n">n_goal</span> <span class="o">=</span> <span class="n">goal_pose</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="n">change</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">if</span> <span class="n">n_agent</span> <span class="o">&gt;=</span> <span class="n">n_goal</span><span class="p">:</span>
    <span class="n">temp</span> <span class="o">=</span> <span class="n">n_goal</span>
    <span class="n">n_goal</span><span class="o">=</span> <span class="n">n_agent</span>
    <span class="n">n_agent</span> <span class="o">=</span> <span class="n">temp</span>
    
    <span class="n">temp</span> <span class="o">=</span> <span class="n">agent_pose</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">agent_pose</span> <span class="o">=</span> <span class="n">goal_pose</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">goal_pose</span> <span class="o">=</span> <span class="n">temp</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    
    <span class="n">temp</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">clone</span><span class="p">()</span>
    <span class="n">X</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">clone</span><span class="p">()</span>
    <span class="n">X</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">temp</span><span class="o">.</span><span class="n">clone</span><span class="p">()</span>
    
    <span class="n">change</span> <span class="o">=</span> <span class="mi">1</span>
    
    <span class="nb">print</span><span class="p">(</span><span class="n">change</span><span class="p">)</span>
<span class="n">goal_agent</span> <span class="o">=</span> <span class="p">[[]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_goal</span><span class="p">)]</span>
    
<span class="n">avoid_goal</span> <span class="o">=</span> <span class="p">[[]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_agent</span><span class="p">)]</span>

<span class="n">trajectory</span> <span class="o">=</span> <span class="p">[[]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_agent</span><span class="p">)]</span>
    
<span class="n">imsize</span> <span class="o">=</span> <span class="mi">7</span>
<span class="c1">#find next goal for all agent</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_agent</span><span class="p">):</span>
    <span class="n">g_pos</span><span class="p">,</span><span class="n">dist</span><span class="p">,</span><span class="n">traj</span> <span class="o">=</span> <span class="n">find_next_goal</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">agent_pose</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">imsize</span><span class="p">,</span><span class="n">avoid_goal</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">model</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">n_goal</span><span class="p">,</span><span class="n">goal_pose</span><span class="p">)</span>
    <span class="n">goal_agent</span><span class="p">[</span><span class="n">g_pos</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">i</span><span class="p">,</span><span class="n">dist</span><span class="p">])</span>
    <span class="n">trajectory</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">traj</span><span class="p">)</span>
        
<span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
    <span class="n">token</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">for</span> <span class="n">key1</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_goal</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">goal_agent</span><span class="p">[</span><span class="n">key1</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">token</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">if</span> <span class="n">token</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">goal_agent</span><span class="p">)</span>
        <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_goal</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">goal_agent</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">count</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">count</span><span class="p">,</span><span class="n">n_agent</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_agent</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">trajectory</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
                <span class="nb">print</span><span class="p">([</span><span class="n">j</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">item</span><span class="p">(),</span><span class="n">j</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">item</span><span class="p">()],</span><span class="n">end</span><span class="o">=</span><span class="s1">&#39;-&gt;&#39;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;End&#39;</span><span class="p">)</span>
        <span class="k">break</span>
    <span class="c1">#find the conflict</span>
    <span class="k">for</span> <span class="n">key1</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_goal</span><span class="p">):</span>
        <span class="c1">#check for conflict</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">goal_agent</span><span class="p">[</span><span class="n">key1</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">same_agent</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">min_dist</span> <span class="o">=</span> <span class="mi">100</span>
            <span class="n">min_index</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">goal_agent</span><span class="p">[</span><span class="n">key1</span><span class="p">]:</span>
                <span class="n">same_agent</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">j</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                <span class="k">if</span> <span class="n">min_dist</span> <span class="o">&gt;</span> <span class="n">j</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
                    <span class="n">min_dist</span> <span class="o">=</span> <span class="n">j</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                    <span class="n">min_index</span> <span class="o">=</span> <span class="n">j</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            
            <span class="n">next_goal_agent</span> <span class="o">=</span> <span class="p">[[]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_goal</span><span class="p">)]</span>
            
            <span class="c1">#find goal next goal for conflicted agent</span>
            <span class="n">L</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">same_agent</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">age</span> <span class="ow">in</span> <span class="n">same_agent</span><span class="p">:</span>
                <span class="n">avoid_goal</span><span class="p">[</span><span class="n">age</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">goal_pose</span><span class="p">[</span><span class="n">key1</span><span class="p">])</span>
                <span class="n">g_pos</span><span class="p">,</span><span class="n">dist</span><span class="p">,</span><span class="n">traj</span> <span class="o">=</span> <span class="n">find_next_goal</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">agent_pose</span><span class="p">[</span><span class="n">age</span><span class="p">],</span><span class="n">imsize</span><span class="p">,</span><span class="n">avoid_goal</span><span class="p">[</span><span class="n">age</span><span class="p">],</span><span class="n">model</span><span class="p">,</span><span class="n">age</span><span class="p">,</span><span class="n">n_goal</span><span class="p">,</span><span class="n">goal_pose</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">g_pos</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                    <span class="n">trajectory</span><span class="p">[</span><span class="n">age</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">traj</span><span class="p">)</span>
                    <span class="n">next_goal_agent</span><span class="p">[</span><span class="n">g_pos</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">age</span><span class="p">,</span><span class="n">dist</span><span class="p">])</span>
                <span class="k">else</span> <span class="p">:</span>
                    <span class="n">avoid_goal</span><span class="p">[</span><span class="n">age</span><span class="p">]</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
                    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">goal_agent</span><span class="p">[</span><span class="n">key1</span><span class="p">]:</span>
                        <span class="k">if</span> <span class="n">j</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">age</span><span class="p">:</span>
                            <span class="n">next_goal_agent</span><span class="p">[</span><span class="n">key1</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">j</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">j</span><span class="p">[</span><span class="mi">1</span><span class="p">]])</span>
             
            <span class="c1">#check for newly created conflict</span>
            <span class="n">new_conflict</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">new_conflict_index</span> <span class="o">=</span> <span class="p">[]</span>
            
            <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_goal</span><span class="p">):</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">next_goal_agent</span><span class="p">[</span><span class="n">v</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="n">new_conflict</span> <span class="o">+=</span><span class="mi">1</span>
                    <span class="n">new_conflict_index</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
            
            
            <span class="n">next_next_goal_agent</span> <span class="o">=</span> <span class="p">[[]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_goal</span><span class="p">)]</span>
            <span class="c1">#No new conflict</span>
            <span class="k">if</span> <span class="n">new_conflict</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">avoid_goal</span><span class="p">[</span><span class="n">min_index</span><span class="p">]</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
                <span class="n">trajectory</span><span class="p">[</span><span class="n">min_index</span><span class="p">]</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_goal</span><span class="p">):</span>
                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">next_goal_agent</span><span class="p">[</span><span class="n">key</span><span class="p">])</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                        <span class="c1">#find where this agent made goal and make them null set</span>
                        <span class="k">if</span> <span class="n">next_goal_agent</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">min_index</span><span class="p">:</span>
                            <span class="n">next_goal_agent</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
                        
                <span class="n">next_goal_agent</span><span class="p">[</span><span class="n">key1</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">min_index</span><span class="p">,</span><span class="n">min_dist</span><span class="p">])</span>
                <span class="n">goal_agent</span><span class="p">[</span><span class="n">key1</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_goal</span><span class="p">):</span>
                    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">next_goal_agent</span><span class="p">[</span><span class="n">key</span><span class="p">]:</span>
                        <span class="n">goal_agent</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">j</span><span class="p">)</span>
            <span class="k">else</span> <span class="p">:</span>
                <span class="k">for</span> <span class="n">key2</span> <span class="ow">in</span> <span class="n">new_conflict_index</span><span class="p">:</span>
                    <span class="c1">#code for same agent or partial agent</span>
                    <span class="n">max_dist</span> <span class="o">=</span> <span class="mi">0</span>
                    <span class="n">max_index</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
                    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">next_goal_agent</span><span class="p">[</span><span class="n">key2</span><span class="p">]:</span>
                        <span class="k">if</span> <span class="n">max_dist</span> <span class="o">&lt;</span> <span class="n">j</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
                            <span class="n">max_dist</span> <span class="o">=</span> <span class="n">j</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                            <span class="n">max_index</span> <span class="o">=</span> <span class="n">j</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                    
                    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">next_goal_agent</span><span class="p">[</span><span class="n">key2</span><span class="p">]:</span>
                        <span class="c1">#put largest dist to goal</span>
                        <span class="k">if</span> <span class="n">j</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">max_index</span><span class="p">:</span>
                            <span class="n">trajectory</span><span class="p">[</span><span class="n">max_index</span><span class="p">]</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
                            <span class="n">avoid_goal</span><span class="p">[</span><span class="n">max_index</span><span class="p">]</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
                            <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_goal</span><span class="p">):</span>
                                <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">goal_agent</span><span class="p">[</span><span class="n">c</span><span class="p">]:</span>
                                    <span class="k">if</span> <span class="n">d</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">max_index</span><span class="p">:</span>
                                        <span class="n">next_next_goal_agent</span><span class="p">[</span><span class="n">key1</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">d</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">d</span><span class="p">[</span><span class="mi">1</span><span class="p">]])</span>
                        <span class="k">else</span> <span class="p">:</span>
                            <span class="n">next_next_goal_agent</span><span class="p">[</span><span class="n">key2</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">j</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">j</span><span class="p">[</span><span class="mi">1</span><span class="p">]])</span>
                            
                    <span class="n">goal_agent</span><span class="p">[</span><span class="n">key1</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
                    <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_goal</span><span class="p">):</span>
                        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">next_next_goal_agent</span><span class="p">[</span><span class="n">key</span><span class="p">]:</span>
                            <span class="n">goal_agent</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">j</span><span class="p">)</span>
            
            
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>1
[[[2, 6]], [[1, 2]], [[0, 4]]]
3 3
[1, 2]-&gt;[1, 1]-&gt;[2, 1]-&gt;[3, 1]-&gt;End
[2, 5]-&gt;[2, 4]-&gt;End
[3, 4]-&gt;[2, 4]-&gt;[1, 4]-&gt;[1, 3]-&gt;[1, 2]-&gt;[1, 1]-&gt;End
</pre>
</div>
</div>

<div class="output_area">

<div class="prompt"></div>


<div class="output_subarea output_stream output_stderr output_text">
<pre>C:\Users\Welcome\Anaconda3\lib\site-packages\ipykernel_launcher.py:23: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[337]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_goal</span><span class="p">):</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">goal_agent</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">count</span> <span class="o">+=</span> <span class="mi">1</span>
<span class="nb">print</span><span class="p">(</span><span class="n">n_agent</span><span class="p">,</span><span class="n">count</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>3 3
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[166]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">Input</span> <span class="o">=</span> <span class="n">agent_env</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">clone</span><span class="p">(),</span><span class="n">agent_pose</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">imsize</span><span class="p">,</span><span class="n">avoid_goal</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">token</span><span class="p">)</span>
<span class="n">output</span><span class="p">,</span><span class="n">prediction</span><span class="p">,</span><span class="n">v_max</span><span class="p">,</span><span class="n">v_in</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">Input</span><span class="p">,</span><span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">agent_pose</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]),</span><span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">agent_pose</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]))</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[72]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">n_agent</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>
<span class="n">n_agent</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">n_agent</span><span class="p">)</span>
<span class="n">n_goal</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>
<span class="n">n_goal</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">n_goal</span><span class="p">)</span>

<span class="n">temp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="mf">1.0</span><span class="p">)</span>
<span class="n">agent_pose</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">column_stack</span><span class="p">([</span><span class="n">temp</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">temp</span><span class="p">[</span><span class="mi">1</span><span class="p">]])</span>

<span class="n">temp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mf">1.0</span><span class="p">)</span>
<span class="n">goal_pose</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">column_stack</span><span class="p">([</span><span class="n">temp</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">temp</span><span class="p">[</span><span class="mi">1</span><span class="p">]])</span>

<span class="n">avoid_goal</span> <span class="o">=</span> <span class="p">[[]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_agent</span><span class="p">)]</span>

<span class="n">token</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">allocated_goal</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.0</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_goal</span><span class="p">)]</span>
<span class="n">imsize</span> <span class="o">=</span> <span class="mi">7</span>
<span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
    <span class="n">v_index</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">goal_to_agent</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_goal</span><span class="p">):</span>
        <span class="n">goal_to_agent</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="n">trajectory</span> <span class="o">=</span> <span class="p">[[]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_agent</span><span class="p">)]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_agent</span><span class="p">):</span>
        <span class="n">goal_agent</span><span class="p">,</span><span class="n">traj</span> <span class="o">=</span> <span class="n">find_next_goal</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">agent_pose</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">imsize</span><span class="p">,</span><span class="n">avoid_goal</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">model</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">n_goal</span><span class="p">,</span><span class="n">goal_pose</span><span class="p">)</span>
        <span class="n">trajectory</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">traj</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">goal_agent</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">traj</span><span class="p">)</span>
        <span class="n">goal_to_agent</span><span class="p">[</span><span class="n">goal_agent</span><span class="p">[</span><span class="mi">2</span><span class="p">]]</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">goal_agent</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">goal_agent</span><span class="p">[</span><span class="mi">1</span><span class="p">]])</span>
          
    <span class="n">check_finish</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">goal_to_agent</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">goal_to_agent</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">check_finish</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">goal_to_agent</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
            <span class="k">if</span> <span class="n">j</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">max_dist</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
                <span class="k">if</span> <span class="n">allocated_goal</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="mf">0.0</span><span class="p">:</span>
                    <span class="n">allocated_goal</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.0</span>
                <span class="k">else</span> <span class="p">:</span>
                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">avoid_goal</span><span class="p">[</span><span class="n">j</span><span class="p">[</span><span class="mi">0</span><span class="p">]])</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="n">goal</span> <span class="o">=</span> <span class="n">avoid_goal</span><span class="p">[</span><span class="n">j</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
                        <span class="n">allocated_goal</span><span class="p">[</span><span class="n">goal</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.0</span>
            <span class="k">else</span> <span class="p">:</span>
                <span class="n">avoid_goal</span><span class="p">[</span><span class="n">j</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">goal_pose</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>

    <span class="k">if</span> <span class="n">check_finish</span> <span class="p">:</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_agent</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">trajactory</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">j</span><span class="p">)</span>
        <span class="k">break</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>tensor([[3, 3, 3, 3, 3, 1, 1],
        [2, 3, 0, 0, 0, 0, 2],
        [2, 4, 0, 0, 3, 0, 2],
        [1, 1, 1, 2, 3, 3, 3],
        [2, 3, 1, 2, 2, 4, 0],
        [2, 2, 2, 2, 2, 1, 0],
        [3, 1, 1, 1, 1, 1, 1]])
tensor([5, 1]) tensor(3)
tensor([5, 2]) tensor(2)
tensor([5, 3]) tensor(2)
tensor([5, 4]) tensor(2)
tensor([5, 5]) tensor(2)
tensor([4, 5]) tensor(1)
</pre>
</div>
</div>

<div class="output_area">

<div class="prompt"></div>


<div class="output_subarea output_text output_error">
<pre>
<span class="ansi-red-intense-fg ansi-bold">---------------------------------------------------------------------------</span>
<span class="ansi-red-intense-fg ansi-bold">ValueError</span>                                Traceback (most recent call last)
<span class="ansi-green-intense-fg ansi-bold">&lt;ipython-input-72-4d1ba60011d0&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span><span class="ansi-blue-intense-fg ansi-bold">()</span>
<span class="ansi-green-fg">     23</span>     trajectory <span class="ansi-yellow-intense-fg ansi-bold">=</span> <span class="ansi-yellow-intense-fg ansi-bold">[</span><span class="ansi-yellow-intense-fg ansi-bold">[</span><span class="ansi-yellow-intense-fg ansi-bold">]</span> <span class="ansi-green-intense-fg ansi-bold">for</span> i <span class="ansi-green-intense-fg ansi-bold">in</span> range<span class="ansi-yellow-intense-fg ansi-bold">(</span>n_agent<span class="ansi-yellow-intense-fg ansi-bold">)</span><span class="ansi-yellow-intense-fg ansi-bold">]</span>
<span class="ansi-green-fg">     24</span>     <span class="ansi-green-intense-fg ansi-bold">for</span> i <span class="ansi-green-intense-fg ansi-bold">in</span> range<span class="ansi-yellow-intense-fg ansi-bold">(</span>n_agent<span class="ansi-yellow-intense-fg ansi-bold">)</span><span class="ansi-yellow-intense-fg ansi-bold">:</span>
<span class="ansi-green-intense-fg ansi-bold">---&gt; 25</span><span class="ansi-yellow-intense-fg ansi-bold">         </span>goal_agent<span class="ansi-yellow-intense-fg ansi-bold">,</span>traj <span class="ansi-yellow-intense-fg ansi-bold">=</span> find_next_goal<span class="ansi-yellow-intense-fg ansi-bold">(</span>X<span class="ansi-yellow-intense-fg ansi-bold">,</span>agent_pose<span class="ansi-yellow-intense-fg ansi-bold">[</span>i<span class="ansi-yellow-intense-fg ansi-bold">]</span><span class="ansi-yellow-intense-fg ansi-bold">,</span>imsize<span class="ansi-yellow-intense-fg ansi-bold">,</span>avoid_goal<span class="ansi-yellow-intense-fg ansi-bold">[</span>i<span class="ansi-yellow-intense-fg ansi-bold">]</span><span class="ansi-yellow-intense-fg ansi-bold">,</span>model<span class="ansi-yellow-intense-fg ansi-bold">,</span>i<span class="ansi-yellow-intense-fg ansi-bold">,</span>n_goal<span class="ansi-yellow-intense-fg ansi-bold">,</span>goal_pose<span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-fg">     26</span>         trajectory<span class="ansi-yellow-intense-fg ansi-bold">[</span>i<span class="ansi-yellow-intense-fg ansi-bold">]</span><span class="ansi-yellow-intense-fg ansi-bold">.</span>append<span class="ansi-yellow-intense-fg ansi-bold">(</span>traj<span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-fg">     27</span>         print<span class="ansi-yellow-intense-fg ansi-bold">(</span>goal_agent<span class="ansi-yellow-intense-fg ansi-bold">)</span>

<span class="ansi-red-intense-fg ansi-bold">ValueError</span>: too many values to unpack (expected 2)</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[110]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">goal_agent</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt output_prompt">Out[110]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>{0: [[1, 4]]}</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[281]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">S</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="n">avoid_goal</span> <span class="o">=</span> <span class="p">[]</span>
<span class="c1">#avoid_goal.append([4,5])</span>
<span class="n">Input</span> <span class="o">=</span> <span class="n">agent_env</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">clone</span><span class="p">(),</span><span class="n">S</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="n">avoid_goal</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">Input</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,:,:],</span><span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">Input</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,:,:],</span><span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">Input</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,:,:]</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(),</span><span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">Input</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">,:,:]</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(),</span><span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">Input</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">4</span><span class="p">,:,:]</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(),</span><span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAPgAAAD8CAYAAABaQGkdAAAABHNCSVQICAgIfAhkiAAAAAlwSFlz
AAALEgAACxIB0t1+/AAACiRJREFUeJzt3duLXfUZxvHncRLResCLBAmZ0LEgggg1MgRKQNrUSqyi
veiFgkJLwRstkRZEe1P8B8RelIIkaS0egqgBEesBNFihHiYxVmO0hJDiEMskiGh6UYk+vZglTOO0
s9K91trb1+8Hhsye7MzvN+h31j6u10kEoKYzxr0BAP0hcKAwAgcKI3CgMAIHCiNwoDACBwojcKAw
AgcKW9XHN12zZk1mZmb6+NYAJB05ckTHjx/3StfrJfCZmRnNzc318a0BSJqdnW11PW6iA4UROFAY
gQOFEThQGIEDhRE4UBiBA4UROFAYgQOFEThQWKvAbW+1/Z7tQ7bv6ntTALqxYuC2pyT9VtI1ki6V
dJPtS/veGIDRtTmCb5J0KMnhJJ9K2iXphn63BaALbQJfL+n9JZfnm68BmHBtAl/uPadfGodi+1bb
c7bnjh07NvrOAIysTeDzkjYsuTwt6eipV0pyf5LZJLNr167tan8ARtAm8NclXWz7IttnSrpR0pP9
bgtAF1Y8o0uSk7Zvl/SspClJO5Mc6H1nAEbW6pRNSZ6W9HTPewHQMV7JBhRG4EBhBA4URuBAYQQO
FEbgQGEEDhRG4EBhBA4URuBAYb1MFx0ne8WJqigm+dK7l9HgCA4URuBAYQQOFEbgQGEEDhRG4EBh
BA4URuBAYQQOFEbgQGEEDhTWZrroTtsLtt8eYkMAutPmCP4HSVt73geAHqwYeJKXJH04wF4AdIz7
4EBhnQXO+GBg8nQWOOODgcnDTXSgsDZPkz0i6S+SLrE9b/tn/W8LQBfazAe/aYiNAOgeN9GBwggc
KIzAgcIIHCiMwIHCCBwojMCBwggcKIzAgcIIHCiMwIHCCBwojMCBwggcKIzAgcIIHCiMwIHCCBwo
jMCBwggcKIzAgcIIHCiszXnRN9h+0fZB2wdsbxtiYwBGt+J50SWdlPTLJPtsnydpr+3nk7zT894A
jKjN+OAPkuxrPv9E0kFJ6/veGIDRndZ9cNszkjZKerWPzQDoVuvAbZ8r6XFJdyT5eJm/Z3wwMGFa
BW57tRbjfijJE8tdh/HBwORp8yi6Je2QdDDJvf1vCUBX2hzBN0u6RdIW2/ubjx/2vC8AHWgzPvhl
SR5gLwA6xivZgMIIHCiMwIHCCBwojMCBwggcKIzAgcIIHCiMwIHCCBworM0ZXb5Skoxt7cX35YzH
OH9uabw/O/47juBAYQQOFEbgQGEEDhRG4EBhBA4URuBAYQQOFEbgQGEEDhRG4EBhbQYfnGX7Ndtv
NuOD7xliYwBG1+bNJv+StCXJiWaE0cu2/5TklZ73BmBEbQYfRNKJ5uLq5mO8b10C0Erb4YNTtvdL
WpD0fBLGBwNfAa0CT/JZksslTUvaZPuyU6/D+GBg8pzWo+hJPpK0R9LWZf6O8cHAhGnzKPpa2xc0
n58t6SpJ7/a9MQCja/Mo+jpJD9ie0uIvhEeTPNXvtgB0oc2j6H+VtHGAvQDoGK9kAwojcKAwAgcK
I3CgMAIHCiNwoDACBwojcKAwAgcKI3CgMAIHCis3H/zrOqOb+dxYDkdwoDACBwojcKAwAgcKI3Cg
MAIHCiNwoDACBwojcKAwAgcKax14M5/sDducEx34ijidI/g2SQf72giA7rWdLjot6VpJ2/vdDoAu
tT2C3yfpTkmf97gXAB1rM3zwOkkLSfaucD3GBwMTps0RfLOk620fkbRL0hbbD556JcYHA5NnxcCT
3J1kOsmMpBslvZDk5t53BmBkPA8OFHZap2xKskfSnl52AqBzHMGBwggcKIzAgcIIHCiMwIHCCBwo
jMCBwggcKIzAgcIIHCiMwIHCyo0PHidG+I7H13VkdBscwYHCCBwojMCBwggcKIzAgcIIHCiMwIHC
CBwojMCBwggcKIzAgcJavRa9GVv0iaTPJJ1MMtvnpgB043TebPK9JMd72wmAznETHSisbeCR9Jzt
vbZvXe4KjA8GJk/bwDcnuULSNZJus33lqVdgfDAweVoFnuRo8+eCpN2SNvW5KQDdWDFw2+fYPu+L
zyVdLentvjcGYHRtHkW/UNLu5rQ4qyQ9nOSZXncFoBMrBp7ksKRvD7AXAB3jaTKgMAIHCiNwoDAC
BwojcKAwAgcKI3CgMAIHCiNwoDACBworNz540se5AkPiCA4URuBAYQQOFEbgQGEEDhRG4EBhBA4U
RuBAYQQOFEbgQGEEDhTWKnDbF9h+zPa7tg/a/k7fGwMwurZvNvmNpGeS/Nj2mZK+0eOeAHRkxcBt
ny/pSkk/kaQkn0r6tN9tAehCm5vo35J0TNLvbb9he3szo+w/MD4YmDxtAl8l6QpJv0uyUdI/Jd11
6pUYHwxMnjaBz0uaT/Jqc/kxLQYPYMKtGHiSf0h63/YlzZe+L+mdXncFoBNtH0X/uaSHmkfQD0v6
aX9bAtCVVoEn2S9ptue9AOgYr2QDCiNwoDACBwojcKAwAgcKI3CgMAIHCiNwoDACBwojcKAw9zFu
1/YxSX//P//5GknHO9wOa7N2xbW/mWTF92X3EvgobM8lGcvr3lmbtautzU10oDACBwqbxMDvZ23W
Zu1uTNx9cADdmcQjOICOTFTgtrfafs/2IdtfOnNrj+vutL1g++2h1lyy9gbbLzYTYw7Y3jbg2mfZ
fs32m83a9wy19pI9TDWn435q4HWP2H7L9n7bcwOvPdikoIm5iW57StLfJP1Ai2dyfV3STUl6P8Gj
7SslnZD0xySX9b3eKWuvk7QuyT7b50naK+lHA/3clnROkhO2V0t6WdK2JK/0vfaSPfxCi6cDOz/J
dQOue0TSbJLBnwe3/YCkPyfZ/sWkoCQf9bHWJB3BN0k6lORwMz1ll6Qbhlg4yUuSPhxirWXW/iDJ
vubzTyQdlLR+oLWT5ERzcXXzMdhvfNvTkq6VtH2oNcdtyaSgHdLipKC+4pYmK/D1kt5fcnleA/2P
Pilsz0jaKOnV/33NTtecsr1f0oKk55ec/34I90m6U9LnA675hUh6zvZe27cOuG6rSUFdmaTAvczX
JuP+wwBsnyvpcUl3JPl4qHWTfJbkcknTkjbZHuQuiu3rJC0k2TvEesvYnOQKSddIuq25mzaEVpOC
ujJJgc9L2rDk8rSko2Pay6Ca+7+PS3ooyRPj2ENzM3GPpK0DLblZ0vXNfeFdkrbYfnCgtZXkaPPn
gqTdWryLOIRBJwVNUuCvS7rY9kXNAw83SnpyzHvqXfNA1w5JB5PcO/Daa21f0Hx+tqSrJL07xNpJ
7k4ynWRGi/+tX0hy8xBr2z6neUBTzc3jqyUN8gzK0JOC2k426V2Sk7Zvl/SspClJO5McGGJt249I
+q6kNbbnJf06yY4h1tbikewWSW8194Ul6VdJnh5g7XWSHmiewThD0qNJBn26akwulLR78XerVkl6
OMkzA64/2KSgiXmaDED3JukmOoCOEThQGIEDhRE4UBiBA4UROFAYgQOFEThQ2L8BU9/EhsrDNxIA
AAAASUVORK5CYII=
"
>
</div>

</div>

<div class="output_area">

<div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
afntAAAAAElFTkSuQmCC
"
>
</div>

</div>

<div class="output_area">

<div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
YII=
"
>
</div>

</div>

<div class="output_area">

<div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
A775uHrWsUzqAAAAAElFTkSuQmCC
"
>
</div>

</div>

<div class="output_area">

<div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAPgAAAD8CAYAAABaQGkdAAAABHNCSVQICAgIfAhkiAAAAAlwSFlz
AAALEgAACxIB0t1+/AAACgNJREFUeJzt3V+oZXUZh/Hn26hYpnihxTQjmSDdeKEyDIQh9k+MJL3o
QqEuJJibipEIMSGkq24i6ioQtSYqRTQhJDShwoL8N6b4ZyxEDA9jTGKh442obxdnSZMN56zx7LVm
n/c8Hxjm7HHv+f1En7P22vvs9aaqkNTT+473BiRNx8ClxgxcaszApcYMXGrMwKXGDFxqzMClxgxc
auyEKf7SJP54nDSxqsp69/EILjVm4FJjBi41ZuBSYwYuNWbgUmMGLjVm4FJjBi41ZuBSYwYuNTYq
8CSXJflrkueSXD/1piQtRta7bHKSbcDfgM8BK8AjwNVV9cwaj/HDJtLEFvVhk93Ac1X1fFW9AdwO
XLHRzUma3pjAdwAvHnF7ZfgzSUtuzOfBj/Y04P+egifZA+zZ8I4kLcyYwFeAs464vRM4+O47VdVN
wE3gObi0LMY8RX8EODfJx5KcBFwF/HrabUlahHWP4FX1ZpKvA/cB24Bbq+rpyXcmacPWfZvsPf2l
PkWXJuc12aQtzsClxgxcaszApcYMXGrMwKXGDFxqzMClxgxcaszApcYMXGrMwKXGDFxqzMClxgxc
aszApcYMXGrMwKXGDFxqzMClxgxcaszApcbWDTzJrUkOJXlqjg1JWpwxR/CfApdNvA9JE1g38Kp6
AHhlhr1IWjDPwaXGxkwXHcXxwdLyGTWbLMnZwD1Vdd6ov9TZZNLknE0mbXFj3ia7Dfgz8PEkK0m+
Ov22JC2C44OlTcqn6NIWZ+BSYwYuNWbgUmMGLjVm4FJjBi41ZuBSYwYuNWbgUmMGLjVm4FJjBi41
ZuBSYwYuNWbgUmMGLjVm4FJjBi41ZuBSYwYuNWbgUmNjrot+VpLfJzmQ5Okke+fYmKSNW/e66Em2
A9ur6rEkpwL7gSur6pk1HuN10aWJLeS66FX1UlU9Nnz9GnAA2LHx7Uma2jGdgw9DCC8AHppiM5IW
a/T44CQfBO4Crq2qV4/yzx0fLC2ZseODTwTuAe6rqh+MuL/n4NLExpyDj3mRLcA+4JWqunbMwgYu
TW9RgX8S+CPwJPD28Mc3VNVv1niMgUsTW0jg74WBS9NzfLC0xRm41JiBS40ZuNSYgUuNGbjUmIFL
jRm41JiBS40ZuNSYgUuNGbjUmIFLjRm41JiBS40ZuNSYgUuNGbjUmIFLjRm41JiBS40ZuNTYmPHB
Jyd5OMkTw/jg786xMUkbN3ayySlVdXgYYfQnYG9VPbjGY7wuujSxMddFX3f4YK1+Bzg83Dxx+GXA
0iYw6hw8ybYkjwOHgPuryvHB0iYwKvCqequqzgd2AruTnPfu+yTZk+TRJI8uepOS3ptjnk2W5Ebg
9ar6/hr38Sm8NLGFzCZLcmaS04ev3w98Fnh249uTNLV1X2QDtgP7kmxj9RvCHVV1z7TbkrQIjg+W
NinHB0tbnIFLjRm41JiBS40ZuNSYgUuNGbjUmIFLjRm41JiBS40ZuNTYmA+bbCpT/Gz9WKtXt5KW
h0dwqTEDlxozcKkxA5caM3CpMQOXGjNwqTEDlxozcKkxA5caGx34MJ/sL0m8Jrq0SRzLEXwvcGCq
jUhavLHTRXcCXwBunnY7khZp7BH8h8B1wNsT7kXSgo0ZPng5cKiq9q9zP8cHS0tm3dlkSb4HfAV4
EzgZOA34VVV9eY3HHLcPZft5cG0VY2aTHdPwwSSXAN+qqsvXuZ+BSxNz+KC0xbUbH+wRXFuFR3Bp
izNwqTEDlxozcKkxA5caM3CpMQOXGjNwqTEDlxozcKkxA5caazc+2J8Hl/7LI7jUmIFLjRm41JiB
S40ZuNSYgUuNGbjUmIFLjRm41JiBS40ZuNTYqJ9FT/IC8BrwFvBmVe2aclOSFuNYPmzyqap6ebKd
SFo4n6JLjY0NvIDfJtmfZM/R7uD4YGn5jJpNluQjVXUwyYeA+4FvVNUDa9z/+A0Ik7aIhc0mq6qD
w++HgLuB3RvbmqQ5rBt4klOSnPrO18ClwFNTb0zSxo15Ff3DwN3DpZBOAH5ZVfdOuitJC9FuPri0
VTgfXNriDFxqzMClxgxcaszApcYMXGrMwKXGDFxqzMClxgxcaszApcYMXGrMwKXGDFxqzMClxgxc
aszApcYMXGrMwKXGDFxqzMClxgxcamxU4ElOT3JnkmeTHEjyiak3Jmnjxo4P/hFwb1V9KclJwAcm
3JOkBVl38EGS04AngHNq5JQEBx9I01vU4INzgH8CP0nylyQ3DzPK/ofjg6XlM+YIvgt4ELioqh5K
8iPg1ar6zhqP8QguTWxRR/AVYKWqHhpu3wlcuJGNSZrHuoFX1T+AF5N8fPijzwDPTLorSQsxarpo
kvOBm4GTgOeBa6rqX2vc36fo0sTGPEV3fLC0STk+WNriDFxqzMClxgxcaszApcYMXGrMwKXGDFxq
zMClxgxcamzsFV2O1cvA39/jY88YHn88uLZrb5a1PzrmTpP8LPpGJHm0qna5tmu79sb5FF1qzMCl
xpYx8Jtc27VdezGW7hxc0uIs4xFc0oIsVeBJLkvy1yTPJbl+xnVvTXIoyVNzrXnE2mcl+f0wMebp
JHtnXPvkJA8neWJY+7tzrX3EHrYNl+O+Z+Z1X0jyZJLH577U95yTgpbmKXqSbcDfgM+xeiXXR4Cr
q2ryCzwmuRg4DPysqs6ber13rb0d2F5VjyU5FdgPXDnTv3eAU6rqcJITgT8Be6vqwanXPmIP3wR2
AadV1eUzrvsCsKuqZn8fPMk+4I9VdfM7k4Kq6t9TrLVMR/DdwHNV9XxVvQHcDlwxx8JV9QDwyhxr
HWXtl6rqseHr14ADwI6Z1q6qOjzcPHH4Ndt3/CQ7gS+wekHPLWGYFHQxcAtAVb0xVdywXIHvAF48
4vYKM/2PviySnA1cADy09j0Xuua2JI8Dh4D7j7j+/Rx+CFwHvD3jmu8o4LdJ9ifZM+O6oyYFLcoy
BX60K0Qux/nDDJJ8ELgLuLaqXp1r3ap6q6rOB3YCu5PMcoqS5HLgUFXtn2O9o7ioqi4EPg98bThN
m8MJrA4O+XFVXQC8Dkz2etMyBb4CnHXE7Z3AweO0l1kN5793Ab+oql8djz0MTxP/AFw205IXAV8c
zoVvBz6d5OczrU1VHRx+PwTczeop4hxmnRS0TIE/Apyb5GPDCw9XAb8+znua3PBC1y3Agar6wcxr
n5nk9OHr9wOfBZ6dY+2q+nZV7ayqs1n9b/27qvryHGsnOWV4QZPh6fGlwCzvoMw9KWiqT5Mds6p6
M8nXgfuAbcCtVfX0HGsnuQ24BDgjyQpwY1XdMsfarB7JvgI8OZwLA9xQVb+ZYe3twL7hHYz3AXdU
1axvVx0nHwbuXv3eygnAL6vq3hnX/wbwi+FA9jxwzVQLLc3bZJIWb5meoktaMAOXGjNwqTEDlxoz
cKkxA5caM3CpMQOXGvsPjFjfC7goT3MAAAAASUVORK5CYII=
"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[282]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">output</span><span class="p">,</span><span class="n">prediction</span><span class="p">,</span><span class="n">v_max</span><span class="p">,</span><span class="n">v_index</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">Input</span><span class="p">,</span><span class="n">S</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">S</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">v_max</span><span class="o">.</span><span class="n">squeeze</span><span class="p">()</span><span class="o">.</span><span class="n">detach</span><span class="p">()</span><span class="o">.</span><span class="n">numpy</span><span class="p">())</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAPgAAAD8CAYAAABaQGkdAAAABHNCSVQICAgIfAhkiAAAAAlwSFlz
AAALEgAACxIB0t1+/AAAC+BJREFUeJzt3W+snnV9x/H3t6en9D9lExnjlIEGXYzJhDVNtiZmY87V
SXQP9gASNFtM+kQXiGZGtweLyR4b9mAxaWg3FhFCxCaOMBCjjLEI0tYywaI2pEtPyqwVmJyW/jnt
dw/ODR7Lye6rva8/x2/er+Sk93169fp+m/Zzftd13fd9fSMzkVTTiqEbkNQdAy4VZsClwgy4VJgB
lwoz4FJhBlwqzIBLhRlwqbCVXex01dSaXLPy8i52PdaK688PUhdg/vxwPy/PzE8NVhuAs8P93Ve/
dGqw2nn+3CB1T+UJzuTpGLddJwFfs/Jyfn/m9i52Pb72rhOD1AU4/vr6wWrPHt80WG0Ajq4erPS7
/v7gYLXPzw3z/+2p+UcbbechulSYAZcKM+BSYQZcKsyAS4UZcKkwAy4VZsClwgy4VJgBlwprFPCI
2B4RP4yIQxHxua6bktSOsQGPiCngH4EPAe8BbouI93TdmKTJNVnBtwKHMvPFzDwD3A98tNu2JLWh
ScCvAY4sej47+p6kZa7Jx0WX+szpW8ahRMQOYAfA6pUbJmxLUhuarOCzwOZFz2eAoxdulJk7M3NL
Zm5ZtWJtW/1JmkCTgD8D3BAR10fEKuBW4OvdtiWpDWMP0TNzPiI+BTwKTAG7M/P5zjuTNLFGt2zK
zIeBhzvuRVLLfCebVJgBlwoz4FJhBlwqzIBLhRlwqTADLhVmwKXCDLhUmAGXCutkuujUO86xYfdr
Xex6rC9d+9AgdQH+9cS1g9X+z003DFYbYO+GzeM36siP/na4Gwy986+/M0zht3xge2mu4FJhBlwq
zIBLhRlwqTADLhVmwKXCDLhUmAGXCjPgUmEGXCrMgEuFNZkuujsijkXEc300JKk9TVbwfwa2d9yH
pA6MDXhmPgG83EMvklrmObhUWGsBj4gdEbE3IvaefuVUW7uVNIHWAr54fPBlV6xua7eSJuAhulRY
k5fJ7gO+A7w7ImYj4hPdtyWpDU3mg9/WRyOS2uchulSYAZcKM+BSYQZcKsyAS4UZcKkwAy4VZsCl
wgy4VJgBlwrrZHzwxqnX2f7rw9zhae2K6UHqAnx84/HBah+f3zhYbYAj668YrPbL6zcNVnu5cwWX
CjPgUmEGXCrMgEuFGXCpMAMuFWbApcIMuFSYAZcKM+BSYQZcKqzJfdE3R8S3I+JgRDwfEXf00Zik
yTX5sMk88JnM3B8RG4B9EfFYZv6g494kTajJ+OCXMnP/6PFrwEHgmq4bkzS5izoHj4jrgBuBp7to
RlK7Ggc8ItYDDwJ3ZubPl/j9N8cHz71yts0eJV2iRgGPiGkWwn1vZn5tqW0Wjw9ef8VwN12Q9AtN
rqIHsAs4mJlf7L4lSW1psoJvAz4G3BwRB0Zff9pxX5Ja0GR88JNA9NCLpJb5TjapMAMuFWbApcIM
uFSYAZcKM+BSYQZcKsyAS4UZcKkwAy4V1sn44JcPX859H/+TLnY91qZ79wxSF+DZk9cOVvvJ4+8c
rDbAkZ8NN8I3zg34TuoYqHY228wVXCrMgEuFGXCpMAMuFWbApcIMuFSYAZcKM+BSYQZcKsyAS4UZ
cKmwJoMPVkfEdyPi2dH44C/00ZikyTX5sMlp4ObMnBuNMHoyIv4tM5/quDdJE2oy+CCBudHT6dFX
w8+ySBpS0+GDUxFxADgGPJaZjg+WfgU0CnhmnsvM9wEzwNaIeO+F2yweH3z27Im2+5R0CS7qKnpm
vgo8Dmxf4vfeHB88Pb2upfYkTaLJVfQrI2LT6PEa4APAC103JmlyTa6iXw3cExFTLPxAeCAzH+q2
LUltaHIV/b+AG3voRVLLfCebVJgBlwoz4FJhBlwqzIBLhRlwqTADLhVmwKXCDLhUmAGXCjPgUmGd
zAc/P72CkzNru9j1WHfdedsgdQFOffKVwWr/ZPaKwWoDTK2bH6723HDrVKxaNUzh083mkruCS4UZ
cKkwAy4VZsClwgy4VJgBlwoz4FJhBlwqzIBLhRlwqbDGAR/NJ/teRHhPdOlXxMWs4HcAB7tqRFL7
mk4XnQE+DNzdbTuS2tR0Bb8L+CxwvsNeJLWsyfDBW4BjmblvzHa/GB98eq61BiVduiYr+DbgIxFx
GLgfuDkivnzhRr80Pviy9S23KelSjA14Zn4+M2cy8zrgVuBbmXl7551Jmpivg0uFXdQtmzLzceDx
TjqR1DpXcKkwAy4VZsClwgy4VJgBlwoz4FJhBlwqzIBLhRlwqTADLhVmwKXCOhkfPHX6HOsP/W8X
ux7rZzcNN0b31DffPljtlVflYLUB5gcsPz1caX7yid8dpO78A//eaDtXcKkwAy4VZsClwgy4VJgB
lwoz4FJhBlwqzIBLhRlwqTADLhVmwKXCGr0XfTS26DXgHDCfmVu6bEpSOy7mwyZ/mJnHO+tEUus8
RJcKaxrwBL4REfsiYsdSGyweH3xm/kR7HUq6ZE0P0bdl5tGIeDvwWES8kJlPLN4gM3cCOwEuX/ub
w344WRLQcAXPzKOjX48Be4CtXTYlqR1jAx4R6yJiwxuPgQ8Cz3XdmKTJNTlEvwrYExFvbP+VzHyk
064ktWJswDPzReB3euhFUst8mUwqzIBLhRlwqTADLhVmwKXCDLhUmAGXCjPgUmEGXCrMgEuFdTI+
OF8/xfnnftzFrsf6tenfHqQuwMmZdYPVvuzVqcFqA5y8arghvlOnByvNb+zeP0jdw6dONtrOFVwq
zIBLhRlwqTADLhVmwKXCDLhUmAGXCjPgUmEGXCrMgEuFGXCpsEYBj4hNEfHViHghIg5GxO913Zik
yTX9sMk/AI9k5p9HxCpgbYc9SWrJ2IBHxEbg/cBfAGTmGeBMt21JakOTQ/R3AD8F/ikivhcRd49m
lP2SxeODzzLg5/ckvalJwFcCNwFfyswbgRPA5y7cKDN3ZuaWzNwyzWUttynpUjQJ+Cwwm5lPj55/
lYXAS1rmxgY8M/8HOBIR7x5964+AH3TalaRWNL2K/lfAvaMr6C8Cf9ldS5La0ijgmXkA2NJxL5Ja
5jvZpMIMuFSYAZcKM+BSYQZcKsyAS4UZcKkwAy4VZsClwgy4VFhkZvs7jfgp8N+X+MffBhxvsR1r
W7ti7d/KzCvHbdRJwCcREXszc5D3vVvb2tVqe4guFWbApcKWY8B3Wtva1m7HsjsHl9Se5biCS2rJ
sgp4RGyPiB9GxKGIeMudWzusuzsijkXEc33VXFR7c0R8ezQx5vmIuKPH2qsj4rsR8eyo9hf6qr2o
h6nR7bgf6rnu4Yj4fkQciIi9PdfubVLQsjlEj4gp4EfAH7NwJ9dngNsys/MbPEbE+4E54F8y871d
17ug9tXA1Zm5PyI2APuAP+vp7x3Ausyci4hp4Engjsx8quvai3r4NAu3A9uYmbf0WPcwsCUze38d
PCLuAf4jM+9+Y1JQZr7aRa3ltIJvBQ5l5ouj6Sn3Ax/to3BmPgG83EetJWq/lJn7R49fAw4C1/RU
OzNzbvR0evTV20/8iJgBPgzc3VfNoS2aFLQLFiYFdRVuWF4BvwY4suj5LD39R18uIuI64Ebg6f9/
y1ZrTkXEAeAY8Nii+9/34S7gs8D5Hmu+IYFvRMS+iNjRY91Gk4LaspwCHkt8b3mcP/QgItYDDwJ3
ZubP+6qbmecy833ADLA1Ino5RYmIW4Bjmbmvj3pL2JaZNwEfAj45Ok3rQ6NJQW1ZTgGfBTYvej4D
HB2ol16Nzn8fBO7NzK8N0cPoMPFxYHtPJbcBHxmdC98P3BwRX+6pNpl5dPTrMWAPC6eIfeh1UtBy
CvgzwA0Rcf3owsOtwNcH7qlzowtdu4CDmfnFnmtfGRGbRo/XAB8AXuijdmZ+PjNnMvM6Fv6tv5WZ
t/dROyLWjS5oMjo8/iDQyysofU8KajrZpHOZOR8RnwIeBaaA3Zn5fB+1I+I+4A+At0XELPB3mbmr
j9osrGQfA74/OhcG+JvMfLiH2lcD94xewVgBPJCZvb5cNZCrgD0LP1tZCXwlMx/psX5vk4KWzctk
ktq3nA7RJbXMgEuFGXCpMAMuFWbApcIMuFSYAZcKM+BSYf8H1M4KCqz+fIwAAAAASUVORK5CYII=
"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[283]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">v_max</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">4</span><span class="p">][</span><span class="mi">5</span><span class="p">],</span><span class="n">v_max</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">][]</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt output_prompt">Out[283]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>(tensor(7.9142, grad_fn=&lt;SelectBackward&gt;),
 tensor([[[[ 0.3833, 12.9142, 12.1208, 10.3013,  8.2430, -0.6199, -1.2757],
           [13.0761, 17.7750, 15.5224, 13.6481, 11.4869,  8.1012, -1.5186],
           [15.3894, 18.0573, 18.3266, 14.8396, 12.5562,  9.0786, -1.4732],
           [ 1.6727, 15.8711, 14.5189, 12.3060, 10.7030,  8.8605, -1.3746],
           [ 3.5886,  3.0834, 11.6778,  9.4112, 10.2217,  7.9142, -1.1047],
           [ 1.1255,  4.6310,  6.0566,  7.9898,  9.3105,  7.8101,  5.4288],
           [-1.3031,  1.4287,  3.3560,  4.8034,  6.6028,  6.0763, -0.9869]]]],
        grad_fn=&lt;MaxBackward0&gt;))</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Check-goal-accuracy-on-8x8-env-size">Check goal accuracy on 8x8 env size<a class="anchor-link" href="#Check-goal-accuracy-on-8x8-env-size">&#182;</a></h4>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[15]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">test</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">with</span> <span class="n">np</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;dataset/Test_dat/test_4_data.npz&#39;</span><span class="p">,</span><span class="n">mmap_mode</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">test</span> <span class="o">=</span> <span class="n">f</span><span class="p">[</span><span class="s1">&#39;arr_0&#39;</span><span class="p">]</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[16]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">test_data</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">imsize</span> <span class="o">=</span> <span class="mi">8</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">test</span><span class="p">:</span>
    <span class="n">env</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="o">*</span><span class="p">(</span><span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mf">0.0</span><span class="p">)</span> <span class="o">+</span> <span class="mf">1.0</span>
    <span class="n">goal</span> <span class="o">=</span> <span class="p">(</span><span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mf">0.5</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.0</span>
    <span class="n">agent</span> <span class="o">=</span> <span class="p">(</span><span class="n">i</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mf">1.0</span><span class="p">)</span> <span class="o">*</span> <span class="o">-</span><span class="mi">1</span>
    <span class="n">agent</span><span class="p">[</span><span class="n">i</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">]][</span><span class="n">i</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">1</span><span class="p">]]</span> <span class="o">=</span> <span class="mf">1.0</span>
    
    <span class="n">domain</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">env</span><span class="p">,</span><span class="n">goal</span><span class="p">,</span><span class="n">agent</span><span class="p">])</span>
    
    <span class="n">token</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">if</span> <span class="n">i</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>
        <span class="n">go</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">goal</span> <span class="o">==</span> <span class="mf">1.0</span><span class="p">)</span>
        <span class="n">Goal</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">column_stack</span><span class="p">([</span><span class="n">go</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">go</span><span class="p">[</span><span class="mi">1</span><span class="p">]])</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">Goal</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">j</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">i</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="ow">and</span> <span class="n">j</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">i</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">1</span><span class="p">]:</span>
                <span class="n">token</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">else</span> <span class="p">:</span>
        <span class="n">token</span> <span class="o">=</span> <span class="mi">1</span>
    
    <span class="k">if</span> <span class="n">token</span><span class="p">:</span>
        <span class="n">test_data</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">domain</span><span class="p">),</span><span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">i</span><span class="p">[</span><span class="mi">2</span><span class="p">]),</span><span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">i</span><span class="p">[</span><span class="mi">3</span><span class="p">])])</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[19]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">test_data</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">test_data</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="nb">abs</span><span class="p">(</span><span class="n">test_data</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[36]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">correct</span><span class="p">,</span> <span class="n">traj_step_error</span><span class="p">,</span> <span class="n">total</span><span class="p">,</span><span class="n">total_env</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span>

<span class="n">X</span><span class="p">,</span><span class="n">S</span><span class="p">,</span><span class="n">label</span> <span class="o">=</span> <span class="n">test_data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="n">Y</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span><span class="mi">12</span><span class="p">,</span><span class="mi">12</span><span class="p">])</span>

<span class="n">Y</span><span class="p">[:,</span><span class="mi">2</span><span class="p">:</span><span class="mi">10</span><span class="p">,</span><span class="mi">2</span><span class="p">:</span><span class="mi">10</span><span class="p">]</span> <span class="o">=</span> <span class="n">X</span>
<span class="n">prev_env</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">clone</span><span class="p">()</span>

<span class="n">whole_traj_act</span> <span class="o">=</span> <span class="p">[]</span>

<span class="n">Trajectory</span> <span class="o">=</span> <span class="p">[</span><span class="n">S</span><span class="p">]</span>
<span class="n">Action</span>  <span class="o">=</span> <span class="p">[</span><span class="n">label</span><span class="p">]</span>

<span class="n">go</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">Y</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mf">1.0</span><span class="p">)</span> 
<span class="n">goal</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">column_stack</span><span class="p">([</span><span class="n">go</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">go</span><span class="p">[</span><span class="mi">1</span><span class="p">]])</span>

<span class="n">end</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">test_data</span><span class="p">)</span>

<span class="n">imsize</span> <span class="o">=</span> <span class="mi">12</span>
<span class="n">max_rand_play</span> <span class="o">=</span> <span class="mi">0</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">end</span><span class="p">):</span>
    <span class="n">X</span><span class="p">,</span><span class="n">S</span><span class="p">,</span><span class="n">label</span> <span class="o">=</span> <span class="n">test_data</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    
    <span class="n">new_env</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">clone</span><span class="p">()</span>
    
   
    <span class="k">if</span> <span class="p">(</span><span class="n">new_env</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">prev_env</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">==</span> <span class="mf">0.0</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">label</span> <span class="o">!=</span> <span class="mi">4</span><span class="p">:</span>
            <span class="n">Trajectory</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">S</span><span class="p">)</span>
            <span class="n">Action</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">label</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">Trajectory</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">S</span><span class="p">)</span>
            <span class="n">Action</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">label</span><span class="p">)</span>
            <span class="n">whole_traj_act</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">Trajectory</span><span class="p">,</span><span class="n">Action</span><span class="p">])</span>
            <span class="n">Trajectory</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">Action</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">else</span> <span class="p">:</span>
        <span class="n">total_env</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="c1">#call the function with prev_new and whole traj act</span>
        <span class="n">Y</span><span class="p">[:,</span><span class="mi">2</span><span class="p">:</span><span class="mi">10</span><span class="p">,</span><span class="mi">2</span><span class="p">:</span><span class="mi">10</span><span class="p">]</span> <span class="o">=</span> <span class="n">prev_env</span><span class="o">.</span><span class="n">clone</span><span class="p">()</span>
        <span class="n">correct_goal</span><span class="p">,</span><span class="n">total_goal</span><span class="p">,</span> <span class="n">traj_error</span><span class="p">,</span><span class="n">_</span> <span class="o">=</span> <span class="n">agent_prediction</span><span class="p">(</span><span class="n">model</span><span class="p">,</span><span class="n">Y</span><span class="o">.</span><span class="n">clone</span><span class="p">(),</span><span class="n">whole_traj_act</span><span class="p">,</span><span class="n">goal</span><span class="p">,</span><span class="n">imsize</span><span class="p">,</span><span class="n">max_rand_play</span><span class="p">)</span>
        
        <span class="n">correct</span> <span class="o">+=</span> <span class="n">correct_goal</span>
        <span class="n">total</span> <span class="o">+=</span> <span class="n">total_goal</span>
        <span class="n">traj_step_error</span> <span class="o">+=</span> <span class="n">traj_error</span>
        
        <span class="n">prev_env</span> <span class="o">=</span> <span class="n">new_env</span><span class="o">.</span><span class="n">clone</span><span class="p">()</span>
        
        
        <span class="n">whole_traj_act</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">Y</span><span class="p">[:,</span><span class="mi">2</span><span class="p">:</span><span class="mi">10</span><span class="p">,</span><span class="mi">2</span><span class="p">:</span><span class="mi">10</span><span class="p">]</span>  <span class="o">=</span> <span class="n">prev_env</span>
        <span class="n">go</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">Y</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mf">1.0</span><span class="p">)</span> 
        <span class="n">goal</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">column_stack</span><span class="p">([</span><span class="n">go</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">go</span><span class="p">[</span><span class="mi">1</span><span class="p">]])</span>

<span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;Goal_accuray: {correct / total}&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">correct</span><span class="p">,</span><span class="n">total</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;Average_Step_error_in_domain : {traj_step_error / total_env}&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">traj_step_error</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Goal_accuray: 0.9600577478344562
3990.0 4156.0
Average_Step_error_in_domain : 0.05987646771037184
69.93571428571431
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[37]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">total_env</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt output_prompt">Out[37]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>1168.0</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[39]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">correct</span><span class="p">,</span> <span class="n">traj_step_error</span><span class="p">,</span> <span class="n">total</span><span class="p">,</span><span class="n">total_env</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span>

<span class="n">X</span><span class="p">,</span><span class="n">S</span><span class="p">,</span><span class="n">label</span> <span class="o">=</span> <span class="n">test_data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="n">prev_env</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">clone</span><span class="p">()</span>

<span class="n">whole_traj_act</span> <span class="o">=</span> <span class="p">[]</span>

<span class="n">Trajectory</span> <span class="o">=</span> <span class="p">[</span><span class="n">S</span><span class="p">]</span>
<span class="n">Action</span>  <span class="o">=</span> <span class="p">[</span><span class="n">label</span><span class="p">]</span>

<span class="n">go</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mf">1.0</span><span class="p">)</span> 
<span class="n">goal</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">column_stack</span><span class="p">([</span><span class="n">go</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">go</span><span class="p">[</span><span class="mi">1</span><span class="p">]])</span>

<span class="n">end</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">test_data</span><span class="p">)</span>


<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">400</span><span class="p">):</span>
    <span class="n">X</span><span class="p">,</span><span class="n">S</span><span class="p">,</span><span class="n">label</span> <span class="o">=</span> <span class="n">test_data</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    
    <span class="n">new_env</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">clone</span><span class="p">()</span>
    
   
    <span class="k">if</span> <span class="p">(</span><span class="n">new_env</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">prev_env</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">==</span> <span class="mf">0.0</span><span class="p">:</span>

        <span class="k">if</span> <span class="n">label</span> <span class="o">!=</span> <span class="mi">4</span><span class="p">:</span>
            <span class="n">Trajectory</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">S</span><span class="p">)</span>
            <span class="n">Action</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">label</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">Trajectory</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">S</span><span class="p">)</span>
            <span class="n">Action</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">label</span><span class="p">)</span>
            <span class="n">whole_traj_act</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">Trajectory</span><span class="p">,</span><span class="n">Action</span><span class="p">])</span>
            <span class="n">Trajectory</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">Action</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">else</span> <span class="p">:</span>
        <span class="c1">#call the function with prev_new and whole traj act</span>
        <span class="n">total_env</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">correct_goal</span><span class="p">,</span><span class="n">total_goal</span><span class="p">,</span> <span class="n">traj_error</span><span class="p">,</span><span class="n">traj</span> <span class="o">=</span> <span class="n">agent_prediction</span><span class="p">(</span><span class="n">model</span><span class="p">,</span><span class="n">prev_env</span><span class="o">.</span><span class="n">clone</span><span class="p">(),</span><span class="n">whole_traj_act</span><span class="p">,</span><span class="n">goal</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
    
        <span class="n">total</span> <span class="o">+=</span> <span class="n">total_goal</span>

        <span class="n">visualization</span><span class="p">(</span><span class="n">prev_env</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">prev_env</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span> <span class="nb">abs</span><span class="p">(</span><span class="n">prev_env</span><span class="p">[</span><span class="mi">2</span><span class="p">]),</span><span class="n">whole_traj_act</span><span class="p">,</span><span class="n">traj</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">correct_goal</span><span class="p">,</span><span class="n">total_goal</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">traj</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">i</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="n">end</span><span class="o">=</span><span class="s2">&quot;-&gt;&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;End&#39;</span><span class="p">)</span>
        <span class="n">correct</span> <span class="o">+=</span> <span class="n">correct_goal</span>
        <span class="n">traj_step_error</span> <span class="o">+=</span> <span class="n">traj_error</span>
        
        <span class="n">prev_env</span> <span class="o">=</span> <span class="n">new_env</span><span class="o">.</span><span class="n">clone</span><span class="p">()</span>
        
        
        <span class="n">whole_traj_act</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">go</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">prev_env</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mf">1.0</span><span class="p">)</span> 
        <span class="n">goal</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">column_stack</span><span class="p">([</span><span class="n">go</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">go</span><span class="p">[</span><span class="mi">1</span><span class="p">]])</span>
        
        
<span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;Goal_accuray: {correct /total}&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">correct</span><span class="p">,</span><span class="n">total</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;Average_Step_error_in_each_domain : {traj_step_error / total_env}&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">traj_step_error</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt"></div>


<div class="output_subarea output_text output_error">
<pre>
<span class="ansi-red-intense-fg ansi-bold">---------------------------------------------------------------------------</span>
<span class="ansi-red-intense-fg ansi-bold">RuntimeError</span>                              Traceback (most recent call last)
<span class="ansi-green-intense-fg ansi-bold">&lt;ipython-input-39-e433c8f81830&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span><span class="ansi-blue-intense-fg ansi-bold">()</span>
<span class="ansi-green-fg">     36</span>         <span class="ansi-red-intense-fg ansi-bold">#call the function with prev_new and whole traj act</span>
<span class="ansi-green-fg">     37</span>         total_env <span class="ansi-yellow-intense-fg ansi-bold">+=</span> <span class="ansi-cyan-intense-fg ansi-bold">1</span>
<span class="ansi-green-intense-fg ansi-bold">---&gt; 38</span><span class="ansi-yellow-intense-fg ansi-bold">         </span>correct_goal<span class="ansi-yellow-intense-fg ansi-bold">,</span>total_goal<span class="ansi-yellow-intense-fg ansi-bold">,</span> traj_error<span class="ansi-yellow-intense-fg ansi-bold">,</span>traj <span class="ansi-yellow-intense-fg ansi-bold">=</span> agent_prediction<span class="ansi-yellow-intense-fg ansi-bold">(</span>model<span class="ansi-yellow-intense-fg ansi-bold">,</span>prev_env<span class="ansi-yellow-intense-fg ansi-bold">.</span>clone<span class="ansi-yellow-intense-fg ansi-bold">(</span><span class="ansi-yellow-intense-fg ansi-bold">)</span><span class="ansi-yellow-intense-fg ansi-bold">,</span>whole_traj_act<span class="ansi-yellow-intense-fg ansi-bold">,</span>goal<span class="ansi-yellow-intense-fg ansi-bold">,</span><span class="ansi-cyan-intense-fg ansi-bold">8</span><span class="ansi-yellow-intense-fg ansi-bold">,</span><span class="ansi-cyan-intense-fg ansi-bold">0</span><span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-fg">     39</span> 
<span class="ansi-green-fg">     40</span>         total <span class="ansi-yellow-intense-fg ansi-bold">+=</span> total_goal

<span class="ansi-green-intense-fg ansi-bold">&lt;ipython-input-35-736fb0c68a49&gt;</span> in <span class="ansi-cyan-fg">agent_prediction</span><span class="ansi-blue-intense-fg ansi-bold">(model, X, whole_traj_act, goal, imsize, max_random_play)</span>
<span class="ansi-green-fg">     32</span>             <span class="ansi-green-intense-fg ansi-bold">if</span> current_play_agent<span class="ansi-yellow-intense-fg ansi-bold">[</span>i<span class="ansi-yellow-intense-fg ansi-bold">]</span> <span class="ansi-yellow-intense-fg ansi-bold">==</span> <span class="ansi-cyan-intense-fg ansi-bold">1.0</span><span class="ansi-yellow-intense-fg ansi-bold">:</span>
<span class="ansi-green-fg">     33</span>                 Input <span class="ansi-yellow-intense-fg ansi-bold">=</span> agent_env<span class="ansi-yellow-intense-fg ansi-bold">(</span>X<span class="ansi-yellow-intense-fg ansi-bold">.</span>clone<span class="ansi-yellow-intense-fg ansi-bold">(</span><span class="ansi-yellow-intense-fg ansi-bold">)</span><span class="ansi-yellow-intense-fg ansi-bold">,</span>agent_state<span class="ansi-yellow-intense-fg ansi-bold">[</span>i<span class="ansi-yellow-intense-fg ansi-bold">]</span><span class="ansi-yellow-intense-fg ansi-bold">,</span>imsize<span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-intense-fg ansi-bold">---&gt; 34</span><span class="ansi-yellow-intense-fg ansi-bold">                 </span>output<span class="ansi-yellow-intense-fg ansi-bold">,</span>prediction<span class="ansi-yellow-intense-fg ansi-bold">,</span>_<span class="ansi-yellow-intense-fg ansi-bold">,</span>_ <span class="ansi-yellow-intense-fg ansi-bold">=</span> model<span class="ansi-yellow-intense-fg ansi-bold">(</span>Input<span class="ansi-yellow-intense-fg ansi-bold">,</span>torch<span class="ansi-yellow-intense-fg ansi-bold">.</span>tensor<span class="ansi-yellow-intense-fg ansi-bold">(</span>agent_state<span class="ansi-yellow-intense-fg ansi-bold">[</span>i<span class="ansi-yellow-intense-fg ansi-bold">]</span><span class="ansi-yellow-intense-fg ansi-bold">[</span><span class="ansi-cyan-intense-fg ansi-bold">0</span><span class="ansi-yellow-intense-fg ansi-bold">]</span><span class="ansi-yellow-intense-fg ansi-bold">)</span><span class="ansi-yellow-intense-fg ansi-bold">,</span>torch<span class="ansi-yellow-intense-fg ansi-bold">.</span>tensor<span class="ansi-yellow-intense-fg ansi-bold">(</span>agent_state<span class="ansi-yellow-intense-fg ansi-bold">[</span>i<span class="ansi-yellow-intense-fg ansi-bold">]</span><span class="ansi-yellow-intense-fg ansi-bold">[</span><span class="ansi-cyan-intense-fg ansi-bold">1</span><span class="ansi-yellow-intense-fg ansi-bold">]</span><span class="ansi-yellow-intense-fg ansi-bold">)</span><span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-fg">     35</span>                 _<span class="ansi-yellow-intense-fg ansi-bold">,</span>index <span class="ansi-yellow-intense-fg ansi-bold">=</span> torch<span class="ansi-yellow-intense-fg ansi-bold">.</span>max<span class="ansi-yellow-intense-fg ansi-bold">(</span>output<span class="ansi-yellow-intense-fg ansi-bold">,</span>dim<span class="ansi-yellow-intense-fg ansi-bold">=</span><span class="ansi-cyan-intense-fg ansi-bold">1</span><span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-fg">     36</span>                 <span class="ansi-red-intense-fg ansi-bold">#check agent (index = 4) means stop planning</span>

<span class="ansi-green-intense-fg ansi-bold">~\Anaconda3\lib\site-packages\torch\nn\modules\module.py</span> in <span class="ansi-cyan-fg">__call__</span><span class="ansi-blue-intense-fg ansi-bold">(self, *input, **kwargs)</span>
<span class="ansi-green-fg">    487</span>             result <span class="ansi-yellow-intense-fg ansi-bold">=</span> self<span class="ansi-yellow-intense-fg ansi-bold">.</span>_slow_forward<span class="ansi-yellow-intense-fg ansi-bold">(</span><span class="ansi-yellow-intense-fg ansi-bold">*</span>input<span class="ansi-yellow-intense-fg ansi-bold">,</span> <span class="ansi-yellow-intense-fg ansi-bold">**</span>kwargs<span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-fg">    488</span>         <span class="ansi-green-intense-fg ansi-bold">else</span><span class="ansi-yellow-intense-fg ansi-bold">:</span>
<span class="ansi-green-intense-fg ansi-bold">--&gt; 489</span><span class="ansi-yellow-intense-fg ansi-bold">             </span>result <span class="ansi-yellow-intense-fg ansi-bold">=</span> self<span class="ansi-yellow-intense-fg ansi-bold">.</span>forward<span class="ansi-yellow-intense-fg ansi-bold">(</span><span class="ansi-yellow-intense-fg ansi-bold">*</span>input<span class="ansi-yellow-intense-fg ansi-bold">,</span> <span class="ansi-yellow-intense-fg ansi-bold">**</span>kwargs<span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-fg">    490</span>         <span class="ansi-green-intense-fg ansi-bold">for</span> hook <span class="ansi-green-intense-fg ansi-bold">in</span> self<span class="ansi-yellow-intense-fg ansi-bold">.</span>_forward_hooks<span class="ansi-yellow-intense-fg ansi-bold">.</span>values<span class="ansi-yellow-intense-fg ansi-bold">(</span><span class="ansi-yellow-intense-fg ansi-bold">)</span><span class="ansi-yellow-intense-fg ansi-bold">:</span>
<span class="ansi-green-fg">    491</span>             hook_result <span class="ansi-yellow-intense-fg ansi-bold">=</span> hook<span class="ansi-yellow-intense-fg ansi-bold">(</span>self<span class="ansi-yellow-intense-fg ansi-bold">,</span> input<span class="ansi-yellow-intense-fg ansi-bold">,</span> result<span class="ansi-yellow-intense-fg ansi-bold">)</span>

<span class="ansi-green-intense-fg ansi-bold">&lt;ipython-input-8-14e6e4763495&gt;</span> in <span class="ansi-cyan-fg">forward</span><span class="ansi-blue-intense-fg ansi-bold">(self, X, S1, S2)</span>
<span class="ansi-green-fg">     52</span>         slice_s1 <span class="ansi-yellow-intense-fg ansi-bold">=</span> S1<span class="ansi-yellow-intense-fg ansi-bold">.</span>long<span class="ansi-yellow-intense-fg ansi-bold">(</span><span class="ansi-yellow-intense-fg ansi-bold">)</span><span class="ansi-yellow-intense-fg ansi-bold">.</span>expand<span class="ansi-yellow-intense-fg ansi-bold">(</span>self<span class="ansi-yellow-intense-fg ansi-bold">.</span>imsize<span class="ansi-yellow-intense-fg ansi-bold">,</span> <span class="ansi-cyan-intense-fg ansi-bold">1</span><span class="ansi-yellow-intense-fg ansi-bold">,</span> <span class="ansi-cyan-intense-fg ansi-bold">5</span><span class="ansi-yellow-intense-fg ansi-bold">,</span> q<span class="ansi-yellow-intense-fg ansi-bold">.</span>size<span class="ansi-yellow-intense-fg ansi-bold">(</span><span class="ansi-cyan-intense-fg ansi-bold">0</span><span class="ansi-yellow-intense-fg ansi-bold">)</span><span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-fg">     53</span>         slice_s1 <span class="ansi-yellow-intense-fg ansi-bold">=</span> slice_s1<span class="ansi-yellow-intense-fg ansi-bold">.</span>permute<span class="ansi-yellow-intense-fg ansi-bold">(</span><span class="ansi-cyan-intense-fg ansi-bold">3</span><span class="ansi-yellow-intense-fg ansi-bold">,</span> <span class="ansi-cyan-intense-fg ansi-bold">2</span><span class="ansi-yellow-intense-fg ansi-bold">,</span> <span class="ansi-cyan-intense-fg ansi-bold">1</span><span class="ansi-yellow-intense-fg ansi-bold">,</span> <span class="ansi-cyan-intense-fg ansi-bold">0</span><span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-intense-fg ansi-bold">---&gt; 54</span><span class="ansi-yellow-intense-fg ansi-bold">         </span>q_out <span class="ansi-yellow-intense-fg ansi-bold">=</span> q<span class="ansi-yellow-intense-fg ansi-bold">.</span>gather<span class="ansi-yellow-intense-fg ansi-bold">(</span><span class="ansi-cyan-intense-fg ansi-bold">2</span><span class="ansi-yellow-intense-fg ansi-bold">,</span> slice_s1<span class="ansi-yellow-intense-fg ansi-bold">)</span><span class="ansi-yellow-intense-fg ansi-bold">.</span>squeeze<span class="ansi-yellow-intense-fg ansi-bold">(</span><span class="ansi-cyan-intense-fg ansi-bold">2</span><span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-fg">     55</span> 
<span class="ansi-green-fg">     56</span>         slice_s2 <span class="ansi-yellow-intense-fg ansi-bold">=</span> S2<span class="ansi-yellow-intense-fg ansi-bold">.</span>long<span class="ansi-yellow-intense-fg ansi-bold">(</span><span class="ansi-yellow-intense-fg ansi-bold">)</span><span class="ansi-yellow-intense-fg ansi-bold">.</span>expand<span class="ansi-yellow-intense-fg ansi-bold">(</span><span class="ansi-cyan-intense-fg ansi-bold">1</span><span class="ansi-yellow-intense-fg ansi-bold">,</span> <span class="ansi-cyan-intense-fg ansi-bold">5</span><span class="ansi-yellow-intense-fg ansi-bold">,</span> q<span class="ansi-yellow-intense-fg ansi-bold">.</span>size<span class="ansi-yellow-intense-fg ansi-bold">(</span><span class="ansi-cyan-intense-fg ansi-bold">0</span><span class="ansi-yellow-intense-fg ansi-bold">)</span><span class="ansi-yellow-intense-fg ansi-bold">)</span>

<span class="ansi-red-intense-fg ansi-bold">RuntimeError</span>: Expected tensor [1, 5, 1, 12], src [1, 5, 8, 8] and index [1, 5, 1, 12] to have the same size apart from dimension 2</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="check-model-goal-accuracy-with-16-x-16-env">check model goal accuracy with 16 x 16 env<a class="anchor-link" href="#check-model-goal-accuracy-with-16-x-16-env">&#182;</a></h4>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[40]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">test_16x16</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">with</span> <span class="n">np</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;./dataset/16x16data/test_16x16_data.npz&#39;</span><span class="p">,</span><span class="n">mmap_mode</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">test_16x16</span> <span class="o">=</span> <span class="n">f</span><span class="p">[</span><span class="s1">&#39;arr_0&#39;</span><span class="p">]</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[41]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">test_16x16_data</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">test_16x16</span><span class="p">:</span>
    <span class="n">env</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="o">*</span><span class="p">(</span><span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mf">0.0</span><span class="p">)</span> <span class="o">+</span> <span class="mf">1.0</span>
    <span class="n">goal</span> <span class="o">=</span> <span class="p">(</span><span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mf">0.5</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.0</span>
    <span class="n">agent</span> <span class="o">=</span> <span class="p">(</span><span class="n">i</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mf">1.0</span><span class="p">)</span> <span class="o">*</span> <span class="o">-</span><span class="mi">1</span>
    <span class="n">agent</span><span class="p">[</span><span class="n">i</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">]][</span><span class="n">i</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">1</span><span class="p">]]</span> <span class="o">=</span> <span class="mf">0.0</span>
    <span class="n">env</span> <span class="o">=</span> <span class="n">env</span> <span class="o">+</span> <span class="n">agent</span>
    <span class="n">agent</span><span class="p">[</span><span class="n">i</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">]][</span><span class="n">i</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">1</span><span class="p">]]</span> <span class="o">=</span> <span class="mf">1.0</span>
    
    <span class="n">domain</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">env</span><span class="p">,</span><span class="n">goal</span><span class="p">,</span><span class="n">agent</span><span class="p">])</span>
    <span class="n">test_16x16_data</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">domain</span><span class="p">),</span><span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">i</span><span class="p">[</span><span class="mi">2</span><span class="p">]),</span><span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">i</span><span class="p">[</span><span class="mi">3</span><span class="p">])])</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[42]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">test_dl</span> <span class="o">=</span> <span class="n">DataLoader</span><span class="p">(</span><span class="n">test_16x16_data</span><span class="p">,</span><span class="n">batch_size</span><span class="o">=</span><span class="mi">128</span><span class="p">,</span><span class="n">shuffle</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[46]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">model_16x16</span> <span class="o">=</span> <span class="n">MA_P</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span><span class="mi">20</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[47]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">model_16x16</span><span class="o">.</span><span class="n">load_state_dict</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;./trained/MA_P_2_9_2.pth&#39;</span><span class="p">,</span><span class="n">map_location</span><span class="o">=</span><span class="s1">&#39;cpu&#39;</span><span class="p">))</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[45]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">N_Epoch</span> <span class="o">=</span> <span class="mi">1</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N_Epoch</span><span class="p">):</span>
    <span class="n">running_loss</span> <span class="o">=</span> <span class="mf">0.0</span>
    <span class="n">correct</span> <span class="o">=</span> <span class="mi">0</span>
    
    <span class="n">model</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>
    
    <span class="n">test_iter</span> <span class="o">=</span> <span class="nb">iter</span><span class="p">(</span><span class="n">test_dl</span><span class="p">)</span>
    
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
    
        <span class="n">X</span><span class="p">,</span><span class="n">S</span><span class="p">,</span><span class="n">label</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">test_iter</span><span class="p">)</span>
        
        <span class="n">output</span><span class="p">,</span> <span class="n">prediction</span><span class="p">,</span> <span class="n">_</span> <span class="p">,</span><span class="n">_</span><span class="o">=</span> <span class="n">model_16x16</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">float</span><span class="p">(),</span><span class="n">S</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span><span class="n">S</span><span class="p">[:,</span><span class="mi">1</span><span class="p">])</span>
        
        <span class="n">loss</span> <span class="o">=</span> <span class="n">Criterion</span><span class="p">(</span><span class="n">output</span><span class="p">,</span><span class="n">label</span><span class="p">)</span>
        
        
        <span class="n">running_loss</span> <span class="o">+=</span> <span class="n">loss</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>
        
        <span class="n">_</span><span class="p">,</span><span class="n">index</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">output</span><span class="p">,</span><span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        
        <span class="n">correct</span> <span class="o">+=</span> <span class="n">torch</span><span class="o">.</span><span class="n">eq</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">label</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>
    
    <span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;Epoch:</span><span class="si">{i}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;Average_loss :{running_loss / 10}&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;Accuracy : {correct / len(test_16x16_data)}&quot;</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Epoch:0
Average_loss :0.8253446102142334
Accuracy : 0.7239413680781759
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[52]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">correct</span><span class="p">,</span> <span class="n">traj_step_error</span><span class="p">,</span> <span class="n">total</span><span class="p">,</span><span class="n">total_env</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span>

<span class="n">X</span><span class="p">,</span><span class="n">S</span><span class="p">,</span><span class="n">label</span> <span class="o">=</span> <span class="n">test_16x16_data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="n">Y</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="mi">20</span><span class="p">])</span>
<span class="n">Y</span><span class="p">[:,</span><span class="mi">2</span><span class="p">:</span><span class="mi">18</span><span class="p">,</span><span class="mi">2</span><span class="p">:</span><span class="mi">18</span><span class="p">]</span> <span class="o">=</span> <span class="n">X</span>

<span class="n">prev_env</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">clone</span><span class="p">()</span>

<span class="n">whole_traj_act</span> <span class="o">=</span> <span class="p">[]</span>

<span class="n">Trajectory</span> <span class="o">=</span> <span class="p">[</span><span class="n">S</span><span class="p">]</span>
<span class="n">Action</span>  <span class="o">=</span> <span class="p">[</span><span class="n">label</span><span class="p">]</span>

<span class="n">go</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">Y</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mf">1.0</span><span class="p">)</span> 
<span class="n">goal</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">column_stack</span><span class="p">([</span><span class="n">go</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">go</span><span class="p">[</span><span class="mi">1</span><span class="p">]])</span>

<span class="n">end</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">test_16x16_data</span><span class="p">)</span>

<span class="n">imsize</span> <span class="o">=</span> <span class="mi">20</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">end</span><span class="p">):</span>
    <span class="n">X</span><span class="p">,</span><span class="n">S</span><span class="p">,</span><span class="n">label</span> <span class="o">=</span> <span class="n">test_16x16_data</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    
    <span class="n">new_env</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">clone</span><span class="p">()</span>
    
   
    <span class="k">if</span> <span class="p">(</span><span class="n">new_env</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">prev_env</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">==</span> <span class="mf">0.0</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">label</span> <span class="o">!=</span> <span class="mi">4</span><span class="p">:</span>
            <span class="n">Trajectory</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">S</span><span class="p">)</span>
            <span class="n">Action</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">label</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">Trajectory</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">S</span><span class="p">)</span>
            <span class="n">Action</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">label</span><span class="p">)</span>
            <span class="n">whole_traj_act</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">Trajectory</span><span class="p">,</span><span class="n">Action</span><span class="p">])</span>
            <span class="n">Trajectory</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">Action</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">else</span> <span class="p">:</span>
        <span class="n">total_env</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="c1">#call the function with prev_new and whole traj act</span>
        <span class="n">Y</span><span class="p">[:,</span><span class="mi">2</span><span class="p">:</span><span class="mi">18</span><span class="p">,</span><span class="mi">2</span><span class="p">:</span><span class="mi">18</span><span class="p">]</span> <span class="o">=</span> <span class="n">prev_env</span>
        <span class="n">correct_goal</span><span class="p">,</span><span class="n">total_goal</span><span class="p">,</span> <span class="n">traj_error</span><span class="p">,</span><span class="n">_</span> <span class="o">=</span> <span class="n">agent_prediction</span><span class="p">(</span><span class="n">model_16x16</span><span class="p">,</span><span class="n">Y</span><span class="o">.</span><span class="n">clone</span><span class="p">(),</span><span class="n">whole_traj_act</span><span class="p">,</span><span class="n">goal</span><span class="p">,</span><span class="n">imsize</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
        
        
        <span class="n">correct</span> <span class="o">+=</span> <span class="n">correct_goal</span>
        <span class="n">total</span> <span class="o">+=</span> <span class="n">total_goal</span>
        <span class="n">traj_step_error</span> <span class="o">+=</span> <span class="n">traj_error</span>
        
        <span class="n">prev_env</span> <span class="o">=</span> <span class="n">new_env</span><span class="o">.</span><span class="n">clone</span><span class="p">()</span>
        
        
        <span class="n">whole_traj_act</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">Y</span><span class="p">[:,</span><span class="mi">2</span><span class="p">:</span><span class="mi">18</span><span class="p">,</span><span class="mi">2</span><span class="p">:</span><span class="mi">18</span><span class="p">]</span> <span class="o">=</span> <span class="n">prev_env</span>
        <span class="n">go</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">Y</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mf">1.0</span><span class="p">)</span> 
        <span class="n">goal</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">column_stack</span><span class="p">([</span><span class="n">go</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">go</span><span class="p">[</span><span class="mi">1</span><span class="p">]])</span>

<span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;Goal_accuray: {correct / total}&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">correct</span><span class="p">,</span><span class="n">total</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;Average_Step_error_in_domain : {traj_step_error / total_env}&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">traj_step_error</span><span class="p">,</span><span class="n">total_env</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Goal_accuray: 0.9534883720930233
123.0 129.0
Average_Step_error_in_domain : 0.049999999999999996
2.4 48.0
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[107]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">test_16x16_data</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">test_16x16</span><span class="p">:</span>
    <span class="n">env</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="o">*</span><span class="p">(</span><span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mf">0.0</span><span class="p">)</span> <span class="o">+</span> <span class="mf">1.0</span>
    <span class="n">goal</span> <span class="o">=</span> <span class="p">(</span><span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mf">0.5</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.0</span>
    <span class="n">agent</span> <span class="o">=</span> <span class="p">(</span><span class="n">i</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mf">1.0</span><span class="p">)</span> <span class="o">*</span> <span class="o">-</span><span class="mi">1</span>
    <span class="n">agent</span><span class="p">[</span><span class="n">i</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">]][</span><span class="n">i</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">1</span><span class="p">]]</span> <span class="o">=</span> <span class="mf">1.0</span>
    
    <span class="n">domain</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">env</span><span class="p">,</span><span class="n">goal</span><span class="p">,</span><span class="n">agent</span><span class="p">])</span>
    <span class="n">test_16x16_data</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">domain</span><span class="p">),</span><span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">i</span><span class="p">[</span><span class="mi">2</span><span class="p">]),</span><span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">i</span><span class="p">[</span><span class="mi">3</span><span class="p">])])</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[77]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">correct</span><span class="p">,</span> <span class="n">traj_step_error</span><span class="p">,</span> <span class="n">total</span><span class="p">,</span><span class="n">total_env</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span>

<span class="n">X</span><span class="p">,</span><span class="n">S</span><span class="p">,</span><span class="n">label</span> <span class="o">=</span> <span class="n">test_16x16_data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="n">prev_env</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">clone</span><span class="p">()</span>

<span class="n">whole_traj_act</span> <span class="o">=</span> <span class="p">[]</span>

<span class="n">Trajectory</span> <span class="o">=</span> <span class="p">[</span><span class="n">S</span><span class="p">]</span>
<span class="n">Action</span>  <span class="o">=</span> <span class="p">[</span><span class="n">label</span><span class="p">]</span>

<span class="n">go</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mf">1.0</span><span class="p">)</span> 
<span class="n">goal</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">column_stack</span><span class="p">([</span><span class="n">go</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">go</span><span class="p">[</span><span class="mi">1</span><span class="p">]])</span>

<span class="n">end</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">test_16x16_data</span><span class="p">)</span>

<span class="n">imsize</span> <span class="o">=</span> <span class="mi">16</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">100</span><span class="p">):</span>
    <span class="n">X</span><span class="p">,</span><span class="n">S</span><span class="p">,</span><span class="n">label</span> <span class="o">=</span> <span class="n">test_16x16_data</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    
    <span class="n">new_env</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">clone</span><span class="p">()</span>
    
   
    <span class="k">if</span> <span class="p">(</span><span class="n">new_env</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">prev_env</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">==</span> <span class="mf">0.0</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">label</span> <span class="o">!=</span> <span class="mi">4</span><span class="p">:</span>
            <span class="n">Trajectory</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">S</span><span class="p">)</span>
            <span class="n">Action</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">label</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">Trajectory</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">S</span><span class="p">)</span>
            <span class="n">Action</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">label</span><span class="p">)</span>
            <span class="n">whole_traj_act</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">Trajectory</span><span class="p">,</span><span class="n">Action</span><span class="p">])</span>
            <span class="n">Trajectory</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">Action</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">else</span> <span class="p">:</span>
        <span class="n">total_env</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="c1">#call the function with prev_new and whole traj act</span>
        <span class="n">correct_goal</span><span class="p">,</span><span class="n">total_goal</span><span class="p">,</span> <span class="n">traj_error</span><span class="p">,</span><span class="n">traj</span> <span class="o">=</span> <span class="n">agent_prediction</span><span class="p">(</span><span class="n">model_16x16</span><span class="p">,</span><span class="n">prev_env</span><span class="o">.</span><span class="n">clone</span><span class="p">(),</span><span class="n">whole_traj_act</span><span class="p">,</span><span class="n">goal</span><span class="p">,</span><span class="n">imsize</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
    
        <span class="n">visualization</span><span class="p">(</span><span class="n">prev_env</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">prev_env</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">whole_traj_act</span><span class="p">,</span><span class="n">traj</span><span class="p">)</span>
        <span class="n">correct</span> <span class="o">+=</span> <span class="n">correct_goal</span>
        <span class="n">total</span> <span class="o">+=</span> <span class="n">total_goal</span>
        <span class="n">traj_step_error</span> <span class="o">+=</span> <span class="n">traj_error</span>
        
        <span class="n">prev_env</span> <span class="o">=</span> <span class="n">new_env</span><span class="o">.</span><span class="n">clone</span><span class="p">()</span>
        
        
        <span class="n">whole_traj_act</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">go</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">prev_env</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mf">1.0</span><span class="p">)</span> 
        <span class="n">goal</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">column_stack</span><span class="p">([</span><span class="n">go</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">go</span><span class="p">[</span><span class="mi">1</span><span class="p">]])</span>

<span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;Goal_accuray: {correct / total}&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">correct</span><span class="p">,</span><span class="n">total</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;Average_Step_error_in_domain : {traj_step_error / total_env}&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">traj_step_error</span><span class="p">,</span><span class="n">total_env</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Goal_accuray: 1.0
9.0 9.0
Average_Step_error_in_domain : 3.377777777777778
10.133333333333335 3.0
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="check-goal-accuracy-for-28x28-env-size">check goal accuracy for 28x28 env size<a class="anchor-link" href="#check-goal-accuracy-for-28x28-env-size">&#182;</a></h4>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[153]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">test</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">with</span> <span class="n">np</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;./dataset/Testing_dataset/Env_28x28.npz&#39;</span><span class="p">,</span> <span class="n">mmap_mode</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">test</span> <span class="o">=</span> <span class="n">f</span><span class="p">[</span><span class="s1">&#39;arr_0&#39;</span><span class="p">]</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[154]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">test_data</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">test</span><span class="p">:</span>
    <span class="n">env</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span> <span class="o">*</span><span class="p">(</span><span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="mf">1.0</span>
    <span class="n">goal</span> <span class="o">=</span> <span class="p">(</span><span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mf">0.5</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.0</span>
    <span class="n">Agent</span> <span class="o">=</span> <span class="n">i</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">domain</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">env</span><span class="p">,</span><span class="n">goal</span><span class="p">,</span><span class="n">Agent</span><span class="p">])</span>
    
    <span class="n">test_data</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">domain</span><span class="o">.</span><span class="n">copy</span><span class="p">())])</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[155]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">agent_predict</span><span class="p">(</span><span class="n">model</span><span class="p">,</span><span class="n">dom</span><span class="p">,</span><span class="n">goal</span><span class="p">,</span><span class="n">imsize</span><span class="p">,</span><span class="n">max_random_play</span><span class="p">):</span>
    
    <span class="n">X</span> <span class="o">=</span> <span class="n">dom</span><span class="o">.</span><span class="n">clone</span><span class="p">()</span>
    <span class="n">model</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span> 
    <span class="n">correct_goal</span><span class="p">,</span><span class="n">total_goal</span><span class="p">,</span><span class="n">traj_step_error</span><span class="p">,</span><span class="n">goal_count</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span>
    
    <span class="c1">#store agent initial state</span>
    <span class="n">inter</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="mf">1.0</span><span class="p">)</span>
    <span class="n">agent_state</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">column_stack</span><span class="p">([</span><span class="n">inter</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">inter</span><span class="p">[</span><span class="mi">1</span><span class="p">]])</span>
    <span class="n">n_agent</span> <span class="o">=</span> <span class="n">agent_state</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    
    <span class="n">agent_traj</span> <span class="o">=</span> <span class="p">[[</span><span class="n">agent_state</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_agent</span><span class="p">)]</span>
    
    <span class="c1">#store number agent still playing</span>
    <span class="n">current_play_agent</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.0</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_agent</span><span class="p">)]</span>
    
    <span class="n">current_play_agent</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">current_play_agent</span><span class="p">)</span>
    
    <span class="c1">#keep which is reached</span>
    <span class="n">goal_reached</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="n">goal</span><span class="o">.</span><span class="n">size</span><span class="p">])</span>
    
    <span class="c1">#store each agent random play chances</span>
    <span class="n">random_play</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_agent</span><span class="p">)</span>
    <span class="n">max_random_play</span> <span class="o">=</span> <span class="n">max_random_play</span>
    

    <span class="c1">#run untill all player finish</span>
    <span class="k">while</span> <span class="n">current_play_agent</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">!=</span> <span class="mf">0.0</span><span class="p">:</span> 
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_agent</span><span class="p">):</span>
            
            <span class="k">if</span> <span class="n">current_play_agent</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="mf">1.0</span><span class="p">:</span> 
                <span class="n">Input</span> <span class="o">=</span> <span class="n">agent_env</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">clone</span><span class="p">(),</span><span class="n">agent_state</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">imsize</span><span class="p">)</span>
                <span class="n">output</span><span class="p">,</span><span class="n">prediction</span><span class="p">,</span><span class="n">_</span><span class="p">,</span><span class="n">_</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">Input</span><span class="p">,</span><span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">agent_state</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]),</span><span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">agent_state</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]))</span>
                <span class="n">_</span><span class="p">,</span><span class="n">index</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">output</span><span class="p">,</span><span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
                <span class="c1">#check agent (index = 4) means stop planning</span>
                <span class="k">if</span> <span class="n">index</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>
                    <span class="c1">#token whether agent reach goal or not</span>
                    <span class="n">token</span><span class="p">,</span><span class="n">goal_count</span><span class="p">,</span><span class="n">goal_reached</span> <span class="o">=</span> <span class="n">goal_reach_check</span><span class="p">(</span><span class="n">agent_state</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">goal</span><span class="p">,</span><span class="n">goal_count</span><span class="p">,</span><span class="n">goal_reached</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">token</span><span class="p">:</span>
                        <span class="n">current_play_agent</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">random_play</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">max_random_play</span><span class="p">:</span>
                            <span class="n">current_play_agent</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">X</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="n">agent_state</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]][</span><span class="n">agent_state</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]]</span> <span class="o">=</span> <span class="mf">0.0</span>
                            <span class="n">agent_state</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span><span class="n">rand_play</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">agent_state</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">(),</span><span class="n">imsize</span><span class="p">)</span>
                            <span class="n">random_play</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
                            <span class="n">X</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="n">agent_state</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]][</span><span class="n">agent_state</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]]</span> <span class="o">=</span> <span class="mf">1.0</span>
                            <span class="n">agent_traj</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">agent_state</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span>
    
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">new_state</span><span class="p">,</span><span class="n">obst</span> <span class="o">=</span> <span class="n">action</span><span class="p">(</span><span class="n">agent_state</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">index</span><span class="p">,</span><span class="n">imsize</span><span class="p">)</span>
                    
                    <span class="k">if</span> <span class="n">obst</span><span class="p">:</span>
                        <span class="n">current_play_agent</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span>
                        <span class="k">continue</span>
                        
                    <span class="n">X</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="n">agent_state</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]][</span><span class="n">agent_state</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]]</span> <span class="o">=</span> <span class="mf">0.0</span>
                    
                    <span class="n">agent_state</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_state</span>
                    <span class="c1">#check agent reach any obstacle and push it into stop</span>
                    <span class="n">i_1</span> <span class="o">=</span> <span class="n">new_state</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                    <span class="n">i_2</span> <span class="o">=</span> <span class="n">new_state</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                    <span class="k">if</span> <span class="n">X</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">i_1</span><span class="p">][</span><span class="n">i_2</span><span class="p">]</span><span class="o">.</span><span class="n">item</span><span class="p">()</span> <span class="o">==</span> <span class="mf">0.0</span> <span class="ow">and</span> <span class="n">X</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">i_1</span><span class="p">][</span><span class="n">i_2</span><span class="p">]</span><span class="o">.</span><span class="n">item</span><span class="p">()</span> <span class="o">==</span> <span class="mf">0.0</span><span class="p">:</span>
                        <span class="n">current_play_agent</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span>
                        
                    <span class="n">X</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="n">agent_state</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]][</span><span class="n">agent_state</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]]</span> <span class="o">=</span> <span class="mf">1.0</span>
                    <span class="n">agent_traj</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">agent_state</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span>
                    
                    <span class="c1">#stop agent which moves back and forward two on the goal</span>
                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">agent_traj</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">3</span> <span class="ow">and</span> <span class="p">(</span><span class="n">agent_traj</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">agent_traj</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="o">-</span><span class="mi">3</span><span class="p">])</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">==</span> <span class="mi">2</span> <span class="ow">and</span> <span class="p">(</span><span class="n">agent_traj</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="n">agent_traj</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="o">-</span><span class="mi">4</span><span class="p">])</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                        
                        <span class="n">inter</span> <span class="o">=</span> <span class="n">agent_traj</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                        <span class="n">token</span><span class="p">,</span><span class="n">goal_count</span><span class="p">,</span><span class="n">goal_reached</span> <span class="o">=</span> <span class="n">goal_reach_check</span><span class="p">(</span><span class="n">inter</span><span class="p">,</span><span class="n">goal</span><span class="p">,</span><span class="n">goal_count</span><span class="p">,</span><span class="n">goal_reached</span><span class="p">)</span>
                        <span class="k">if</span> <span class="n">token</span><span class="p">:</span>
                            <span class="n">current_play_agent</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span>
                        <span class="k">else</span><span class="p">:</span>     
                            <span class="n">inter</span> <span class="o">=</span> <span class="n">agent_traj</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>
                            <span class="n">token</span><span class="p">,</span><span class="n">goal_count</span><span class="p">,</span><span class="n">goal_reached</span> <span class="o">=</span> <span class="n">goal_reach_check</span><span class="p">(</span><span class="n">inter</span><span class="p">,</span><span class="n">goal</span><span class="p">,</span><span class="n">goal_count</span><span class="p">,</span><span class="n">goal_reached</span><span class="p">)</span>
                            <span class="k">if</span> <span class="n">token</span><span class="p">:</span>
                                <span class="n">current_play_agent</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span>
                                <span class="n">agent_traj</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
                            <span class="k">else</span><span class="p">:</span>
                                <span class="k">if</span> <span class="n">random_play</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">max_random_play</span><span class="p">:</span>
                                    <span class="n">X</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="n">agent_state</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]][</span><span class="n">agent_state</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]]</span> <span class="o">=</span> <span class="mf">0.0</span>
                                    <span class="n">agent_state</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span><span class="n">rand_play</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">agent_state</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">(),</span><span class="n">imsize</span><span class="p">)</span>
                                    <span class="n">random_play</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
                                    <span class="n">X</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="n">agent_state</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]][</span><span class="n">agent_state</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]]</span> <span class="o">=</span> <span class="mf">1.0</span>
                                    <span class="n">agent_traj</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">agent_state</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span>
                                <span class="k">else</span><span class="p">:</span>
                                    <span class="n">current_play_agent</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span>
                    
    
    <span class="n">correct_goal</span> <span class="o">=</span> <span class="n">goal_count</span>
    
    <span class="k">if</span> <span class="n">n_agent</span> <span class="o">&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">goal</span><span class="p">):</span>
        <span class="n">total_goal</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">goal</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">total_goal</span> <span class="o">=</span>  <span class="n">n_agent</span>
    
    <span class="k">return</span> <span class="n">correct_goal</span><span class="p">,</span><span class="n">total_goal</span><span class="p">,</span><span class="n">agent_traj</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[157]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">model_28x28</span> <span class="o">=</span> <span class="n">MA_P</span><span class="p">(</span><span class="mi">32</span><span class="p">,</span><span class="mi">28</span><span class="p">)</span>
<span class="n">model_28x28</span><span class="o">.</span><span class="n">load_state_dict</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;./trained/MA_P_2_9_2.pth&#39;</span><span class="p">,</span><span class="n">map_location</span><span class="o">=</span><span class="s1">&#39;cpu&#39;</span><span class="p">))</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[158]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">correct_goal</span><span class="p">,</span><span class="n">total_goal</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span>   
<span class="n">imsize</span> <span class="o">=</span> <span class="mi">28</span>
<span class="n">max_rand_play</span><span class="o">=</span> <span class="mi">0</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">50</span><span class="p">):</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">test_data</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">clone</span><span class="p">()</span>
    
    <span class="n">go</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mf">1.0</span><span class="p">)</span>
    <span class="n">goal</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">column_stack</span><span class="p">([</span><span class="n">go</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">go</span><span class="p">[</span><span class="mi">1</span><span class="p">]])</span>
    
    <span class="n">current_goal</span><span class="p">,</span><span class="n">current_total</span><span class="p">,</span><span class="n">traj</span> <span class="o">=</span> <span class="n">agent_predict</span><span class="p">(</span><span class="n">model_28x28</span><span class="p">,</span><span class="n">X</span><span class="o">.</span><span class="n">clone</span><span class="p">(),</span><span class="n">goal</span><span class="p">,</span><span class="n">imsize</span><span class="p">,</span><span class="n">max_rand_play</span><span class="p">)</span>
    
    <span class="n">correct_goal</span> <span class="o">+=</span> <span class="n">current_goal</span>
    <span class="n">total_goal</span> <span class="o">+=</span> <span class="n">current_total</span>
    
<span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;Goal Accuracy: {correct_goal/total_goal}&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">correct_goal</span><span class="p">,</span><span class="n">total_goal</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Goal Accuracy: 0.8571428571428571
192.0 224.0
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Goal-accuracy-for-32x32-env-size">Goal accuracy for 32x32 env size<a class="anchor-link" href="#Goal-accuracy-for-32x32-env-size">&#182;</a></h4>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[310]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">test</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">with</span> <span class="n">np</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;./dataset/Testing_dataset/Env_32x32.npz&#39;</span><span class="p">,</span> <span class="n">mmap_mode</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">test</span> <span class="o">=</span> <span class="n">f</span><span class="p">[</span><span class="s1">&#39;arr_0&#39;</span><span class="p">]</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[311]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">test_data</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">test</span><span class="p">:</span>
    <span class="n">env</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span> <span class="o">*</span><span class="p">(</span><span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="mf">1.0</span>
    <span class="n">goal</span> <span class="o">=</span> <span class="p">(</span><span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mf">0.5</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.0</span>
    <span class="n">Agent</span> <span class="o">=</span> <span class="n">i</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">domain</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">env</span><span class="p">,</span><span class="n">goal</span><span class="p">,</span><span class="n">Agent</span><span class="p">])</span>
    
    <span class="n">test_data</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">domain</span><span class="o">.</span><span class="n">copy</span><span class="p">())])</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[331]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">model_32x32</span> <span class="o">=</span> <span class="n">MA_VIN</span><span class="p">(</span><span class="mi">70</span><span class="p">,</span><span class="mi">32</span><span class="p">)</span>
<span class="n">model_32x32</span><span class="o">.</span><span class="n">load_state_dict</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;./trained/MA_VIN_6.pth&#39;</span><span class="p">,</span><span class="n">map_location</span><span class="o">=</span><span class="s1">&#39;cpu&#39;</span><span class="p">))</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[335]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">correct_goal</span><span class="p">,</span><span class="n">total_goal</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span>   
<span class="n">imsize</span> <span class="o">=</span> <span class="mi">32</span>
<span class="n">max_rand_play</span><span class="o">=</span> <span class="mi">5</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">50</span><span class="p">):</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">test_data</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">clone</span><span class="p">()</span>
    
    <span class="n">go</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mf">1.0</span><span class="p">)</span>
    <span class="n">goal</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">column_stack</span><span class="p">([</span><span class="n">go</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">go</span><span class="p">[</span><span class="mi">1</span><span class="p">]])</span>
    
    <span class="n">current_goal</span><span class="p">,</span><span class="n">current_total</span><span class="p">,</span><span class="n">traj</span> <span class="o">=</span> <span class="n">agent_predict</span><span class="p">(</span><span class="n">model_32x32</span><span class="p">,</span><span class="n">X</span><span class="o">.</span><span class="n">clone</span><span class="p">(),</span><span class="n">goal</span><span class="p">,</span><span class="n">imsize</span><span class="p">,</span><span class="n">max_rand_play</span><span class="p">)</span>
    
    <span class="n">correct_goal</span> <span class="o">+=</span> <span class="n">current_goal</span>
    <span class="n">total_goal</span> <span class="o">+=</span> <span class="n">current_total</span>
    
<span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;Goal Accuracy: {correct_goal/total_goal}&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">correct_goal</span><span class="p">,</span><span class="n">total_goal</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Goal Accuracy: 0.7094972067039106
127.0 179.0
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Goal-accuracy-for-64x64-env-size">Goal accuracy for 64x64 env size<a class="anchor-link" href="#Goal-accuracy-for-64x64-env-size">&#182;</a></h4>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[336]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">test</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">with</span> <span class="n">np</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;./dataset/Testing_dataset/Env_64x64.npz&#39;</span><span class="p">,</span> <span class="n">mmap_mode</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">test</span> <span class="o">=</span> <span class="n">f</span><span class="p">[</span><span class="s1">&#39;arr_0&#39;</span><span class="p">]</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[337]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">test_data</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">test</span><span class="p">:</span>
    <span class="n">env</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span> <span class="o">*</span><span class="p">(</span><span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="mf">1.0</span>
    <span class="n">goal</span> <span class="o">=</span> <span class="p">(</span><span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mf">0.5</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.0</span>
    <span class="n">Agent</span> <span class="o">=</span> <span class="n">i</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">domain</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">env</span><span class="p">,</span><span class="n">goal</span><span class="p">,</span><span class="n">Agent</span><span class="p">])</span>
    
    <span class="n">test_data</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">domain</span><span class="o">.</span><span class="n">copy</span><span class="p">())])</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[368]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">model_64x64</span> <span class="o">=</span> <span class="n">MA_VIN</span><span class="p">(</span><span class="mi">90</span><span class="p">,</span><span class="mi">64</span><span class="p">)</span>
<span class="n">model_64x64</span><span class="o">.</span><span class="n">load_state_dict</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;./trained/MA_VIN_6.pth&#39;</span><span class="p">,</span><span class="n">map_location</span><span class="o">=</span><span class="s1">&#39;cpu&#39;</span><span class="p">))</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[369]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">correct_goal</span><span class="p">,</span><span class="n">total_goal</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span>   
<span class="n">imsize</span> <span class="o">=</span> <span class="mi">64</span>
<span class="n">max_rand_play</span><span class="o">=</span> <span class="mi">5</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">50</span><span class="p">):</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">test_data</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">clone</span><span class="p">()</span>
    
    <span class="n">go</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mf">1.0</span><span class="p">)</span>
    <span class="n">goal</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">column_stack</span><span class="p">([</span><span class="n">go</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">go</span><span class="p">[</span><span class="mi">1</span><span class="p">]])</span>
    
    <span class="n">current_goal</span><span class="p">,</span><span class="n">current_total</span><span class="p">,</span><span class="n">traj</span> <span class="o">=</span> <span class="n">agent_predict</span><span class="p">(</span><span class="n">model_64x64</span><span class="p">,</span><span class="n">X</span><span class="o">.</span><span class="n">clone</span><span class="p">(),</span><span class="n">goal</span><span class="p">,</span><span class="n">imsize</span><span class="p">,</span><span class="n">max_rand_play</span><span class="p">)</span>
    
    <span class="n">correct_goal</span> <span class="o">+=</span> <span class="n">current_goal</span>
    <span class="n">total_goal</span> <span class="o">+=</span> <span class="n">current_total</span>
    
    <span class="nb">print</span><span class="p">(</span><span class="n">correct_goal</span><span class="o">/</span><span class="n">total_goal</span><span class="p">)</span>
    
<span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;Goal Accuracy: {correct_goal/total_goal}&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">correct_goal</span><span class="p">,</span><span class="n">total_goal</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>0.75
0.5714285714285714
0.45454545454545453
0.6
0.55
0.52
0.5
0.5142857142857142
0.5121951219512195
0.5227272727272727
0.5106382978723404
0.5
0.5094339622641509
0.5087719298245614
0.5081967213114754
0.47692307692307695
0.47058823529411764
0.49333333333333335
0.5063291139240507
0.5060240963855421
0.5
0.4891304347826087
0.47368421052631576
0.48
0.4854368932038835
0.4811320754716981
0.5
0.4957983193277311
0.4796747967479675
0.47244094488188976
0.4696969696969697
0.47058823529411764
0.4714285714285714
0.46153846153846156
0.4697986577181208
0.46405228758169936
0.46153846153846156
0.4691358024691358
0.47305389221556887
0.47674418604651164
0.480225988700565
0.47513812154696133
0.4702702702702703
0.4708994708994709
0.4666666666666667
0.4723618090452261
0.4752475247524752
0.47115384615384615
0.4647887323943662
0.4722222222222222
Goal Accuracy: 0.4722222222222222
102.0 216.0
</pre>
</div>
</div>

</div>
</div>

</div>
    </div>
  </div>
</body>

 


</html>
